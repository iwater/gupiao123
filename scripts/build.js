/*
 RequireJS 2.1.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/
var requirejs,require,define;
(function(aa){function I(b){return"[object Function]"===L.call(b)}function J(b){return"[object Array]"===L.call(b)}function y(b,c){if(b){var d;for(d=0;d<b.length&&(!b[d]||!c(b[d],d,b));d+=1);}}function M(b,c){if(b){var d;for(d=b.length-1;-1<d&&(!b[d]||!c(b[d],d,b));d-=1);}}function s(b,c){return ga.call(b,c)}function m(b,c){return s(b,c)&&b[c]}function G(b,c){for(var d in b)if(s(b,d)&&c(b[d],d))break}function R(b,c,d,m){c&&G(c,function(c,j){if(d||!s(b,j))m&&"string"!==typeof c?(b[j]||(b[j]={}),R(b[j],
c,d,m)):b[j]=c});return b}function u(b,c){return function(){return c.apply(b,arguments)}}function ba(b){if(!b)return b;var c=aa;y(b.split("."),function(b){c=c[b]});return c}function B(b,c,d,m){c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b);c.requireType=b;c.requireModules=m;d&&(c.originalError=d);return c}function ha(b){function c(a,f,b){var e,n,c,g,d,S,i,h=f&&f.split("/");e=h;var j=k.map,l=j&&j["*"];if(a&&"."===a.charAt(0))if(f){e=m(k.pkgs,f)?h=[f]:h.slice(0,h.length-1);f=a=e.concat(a.split("/"));
for(e=0;f[e];e+=1)if(n=f[e],"."===n)f.splice(e,1),e-=1;else if(".."===n)if(1===e&&(".."===f[2]||".."===f[0]))break;else 0<e&&(f.splice(e-1,2),e-=2);e=m(k.pkgs,f=a[0]);a=a.join("/");e&&a===f+"/"+e.main&&(a=f)}else 0===a.indexOf("./")&&(a=a.substring(2));if(b&&j&&(h||l)){f=a.split("/");for(e=f.length;0<e;e-=1){c=f.slice(0,e).join("/");if(h)for(n=h.length;0<n;n-=1)if(b=m(j,h.slice(0,n).join("/")))if(b=m(b,c)){g=b;d=e;break}if(g)break;!S&&(l&&m(l,c))&&(S=m(l,c),i=e)}!g&&S&&(g=S,d=i);g&&(f.splice(0,d,
g),a=f.join("/"))}return a}function d(a){A&&y(document.getElementsByTagName("script"),function(f){if(f.getAttribute("data-requiremodule")===a&&f.getAttribute("data-requirecontext")===i.contextName)return f.parentNode.removeChild(f),!0})}function z(a){var f=m(k.paths,a);if(f&&J(f)&&1<f.length)return d(a),f.shift(),i.require.undef(a),i.require([a]),!0}function h(a){var f,b=a?a.indexOf("!"):-1;-1<b&&(f=a.substring(0,b),a=a.substring(b+1,a.length));return[f,a]}function j(a,f,b,e){var n,C,g=null,d=f?f.name:
null,j=a,l=!0,k="";a||(l=!1,a="_@r"+(M+=1));a=h(a);g=a[0];a=a[1];g&&(g=c(g,d,e),C=m(q,g));a&&(g?k=C&&C.normalize?C.normalize(a,function(a){return c(a,d,e)}):c(a,d,e):(k=c(a,d,e),a=h(k),g=a[0],k=a[1],b=!0,n=i.nameToUrl(k)));b=g&&!C&&!b?"_unnormalized"+(Q+=1):"";return{prefix:g,name:k,parentMap:f,unnormalized:!!b,url:n,originalName:j,isDefine:l,id:(g?g+"!"+k:k)+b}}function r(a){var f=a.id,b=m(p,f);b||(b=p[f]=new i.Module(a));return b}function t(a,f,b){var e=a.id,n=m(p,e);if(s(q,e)&&(!n||n.defineEmitComplete))"defined"===
f&&b(q[e]);else r(a).on(f,b)}function v(a,f){var b=a.requireModules,e=!1;if(f)f(a);else if(y(b,function(f){if(f=m(p,f))f.error=a,f.events.error&&(e=!0,f.emit("error",a))}),!e)l.onError(a)}function w(){T.length&&(ia.apply(H,[H.length-1,0].concat(T)),T=[])}function x(a){delete p[a];delete V[a]}function F(a,f,b){var e=a.map.id;a.error?a.emit("error",a.error):(f[e]=!0,y(a.depMaps,function(e,c){var g=e.id,d=m(p,g);d&&(!a.depMatched[c]&&!b[g])&&(m(f,g)?(a.defineDep(c,q[g]),a.check()):F(d,f,b))}),b[e]=!0)}
function D(){var a,f,b,e,n=(b=1E3*k.waitSeconds)&&i.startTime+b<(new Date).getTime(),c=[],g=[],h=!1,j=!0;if(!W){W=!0;G(V,function(b){a=b.map;f=a.id;if(b.enabled&&(a.isDefine||g.push(b),!b.error))if(!b.inited&&n)z(f)?h=e=!0:(c.push(f),d(f));else if(!b.inited&&(b.fetched&&a.isDefine)&&(h=!0,!a.prefix))return j=!1});if(n&&c.length)return b=B("timeout","Load timeout for modules: "+c,null,c),b.contextName=i.contextName,v(b);j&&y(g,function(a){F(a,{},{})});if((!n||e)&&h)if((A||da)&&!X)X=setTimeout(function(){X=
0;D()},50);W=!1}}function E(a){s(q,a[0])||r(j(a[0],null,!0)).init(a[1],a[2])}function K(a){var a=a.currentTarget||a.srcElement,b=i.onScriptLoad;a.detachEvent&&!Y?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1);b=i.onScriptError;(!a.detachEvent||Y)&&a.removeEventListener("error",b,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function L(){var a;for(w();H.length;){a=H.shift();if(null===a[0])return v(B("mismatch","Mismatched anonymous define() module: "+a[a.length-
1]));E(a)}}var W,Z,i,N,X,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},p={},V={},$={},H=[],q={},U={},M=1,Q=1;N={require:function(a){return a.require?a.require:a.require=i.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?a.exports:a.exports=q[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return k.config&&m(k.config,a.map.id)||{}},exports:q[a.map.id]}}};Z=function(a){this.events=
m($,a.id)||{};this.map=a;this.shim=m(k.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};Z.prototype={init:function(a,b,c,e){e=e||{};if(!this.inited){this.factory=b;if(c)this.on("error",c);else this.events.error&&(c=u(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=c;this.inited=!0;this.ignore=e.ignore;e.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=
!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0;i.startTime=(new Date).getTime();var a=this.map;if(this.shim)i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;U[a]||(U[a]=!0,i.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;
var e=this.exports,n=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(I(n)){if(this.events.error)try{e=i.execCb(c,n,b,e)}catch(d){a=d}else e=i.execCb(c,n,b,e);this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?e=b.exports:void 0===e&&this.usingExports&&(e=this.exports));if(a)return a.requireMap=this.map,a.requireModules=[this.map.id],a.requireType="define",v(this.error=
a)}else e=n;this.exports=e;if(this.map.isDefine&&!this.ignore&&(q[c]=e,l.onResourceLoad))l.onResourceLoad(i,this.map,this.depMaps);x(c);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=j(a.prefix);this.depMaps.push(d);t(d,"defined",u(this,function(e){var n,d;d=this.map.name;var g=this.map.parentMap?this.map.parentMap.name:null,h=
i.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(e.normalize&&(d=e.normalize(d,function(a){return c(a,g,!0)})||""),e=j(a.prefix+"!"+d,this.map.parentMap),t(e,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),d=m(p,e.id)){this.depMaps.push(e);if(this.events.error)d.on("error",u(this,function(a){this.emit("error",a)}));d.enable()}}else n=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),n.error=u(this,
function(a){this.inited=!0;this.error=a;a.requireModules=[b];G(p,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&x(a.map.id)});v(a)}),n.fromText=u(this,function(e,c){var d=a.name,g=j(d),C=O;c&&(e=c);C&&(O=!1);r(g);s(k.config,b)&&(k.config[d]=k.config[b]);try{l.exec(e)}catch(ca){return v(B("fromtexteval","fromText eval for "+b+" failed: "+ca,ca,[b]))}C&&(O=!0);this.depMaps.push(g);i.completeLoad(d);h([d],n)}),e.load(a.name,h,n,k)}));i.enable(d,this);this.pluginMaps[d.id]=d},enable:function(){V[this.map.id]=
this;this.enabling=this.enabled=!0;y(this.depMaps,u(this,function(a,b){var c,e;if("string"===typeof a){a=j(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[b]=a;if(c=m(N,a.id)){this.depExports[b]=c(this);return}this.depCount+=1;t(a,"defined",u(this,function(a){this.defineDep(b,a);this.check()}));this.errback&&t(a,"error",this.errback)}c=a.id;e=p[c];!s(N,c)&&(e&&!e.enabled)&&i.enable(a,this)}));G(this.pluginMaps,u(this,function(a){var b=m(p,a.id);b&&!b.enabled&&i.enable(a,
this)}));this.enabling=!1;this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]);c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)});"error"===a&&delete this.events[a]}};i={config:k,contextName:b,registry:p,defined:q,urlFetched:U,defQueue:H,Module:Z,makeModuleMap:j,nextTick:l.nextTick,onError:v,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=k.pkgs,c=k.shim,e={paths:!0,config:!0,map:!0};G(a,function(a,b){e[b]?
"map"===b?(k.map||(k.map={}),R(k[b],a,!0,!0)):R(k[b],a,!0):k[b]=a});a.shim&&(G(a.shim,function(a,b){J(a)&&(a={deps:a});if((a.exports||a.init)&&!a.exportsFn)a.exportsFn=i.makeShimExports(a);c[b]=a}),k.shim=c);a.packages&&(y(a.packages,function(a){a="string"===typeof a?{name:a}:a;b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),k.pkgs=b);G(p,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=j(b))});if(a.deps||a.callback)i.require(a.deps||[],
a.callback)},makeShimExports:function(a){return function(){var b;a.init&&(b=a.init.apply(aa,arguments));return b||a.exports&&ba(a.exports)}},makeRequire:function(a,f){function d(e,c,h){var g,k;f.enableBuildCallback&&(c&&I(c))&&(c.__requireJsBuild=!0);if("string"===typeof e){if(I(c))return v(B("requireargs","Invalid require call"),h);if(a&&s(N,e))return N[e](p[a.id]);if(l.get)return l.get(i,e,a,d);g=j(e,a,!1,!0);g=g.id;return!s(q,g)?v(B("notloaded",'Module name "'+g+'" has not been loaded yet for context: '+
b+(a?"":". Use require([])"))):q[g]}L();i.nextTick(function(){L();k=r(j(null,a));k.skipMap=f.skipMap;k.init(e,c,h,{enabled:!0});D()});return d}f=f||{};R(d,{isBrowser:A,toUrl:function(b){var d,f=b.lastIndexOf("."),g=b.split("/")[0];if(-1!==f&&(!("."===g||".."===g)||1<f))d=b.substring(f,b.length),b=b.substring(0,f);return i.nameToUrl(c(b,a&&a.id,!0),d,!0)},defined:function(b){return s(q,j(b,a,!1,!0).id)},specified:function(b){b=j(b,a,!1,!0).id;return s(q,b)||s(p,b)}});a||(d.undef=function(b){w();var c=
j(b,a,!0),d=m(p,b);delete q[b];delete U[c.url];delete $[b];d&&(d.events.defined&&($[b]=d.events),x(b))});return d},enable:function(a){m(p,a.id)&&r(a).enable()},completeLoad:function(a){var b,c,e=m(k.shim,a)||{},d=e.exports;for(w();H.length;){c=H.shift();if(null===c[0]){c[0]=a;if(b)break;b=!0}else c[0]===a&&(b=!0);E(c)}c=m(p,a);if(!b&&!s(q,a)&&c&&!c.inited){if(k.enforceDefine&&(!d||!ba(d)))return z(a)?void 0:v(B("nodefine","No define call for "+a,null,[a]));E([a,e.deps||[],e.exportsFn])}D()},nameToUrl:function(a,
b,c){var e,d,h,g,j,i;if(l.jsExtRegExp.test(a))g=a+(b||"");else{e=k.paths;d=k.pkgs;g=a.split("/");for(j=g.length;0<j;j-=1)if(i=g.slice(0,j).join("/"),h=m(d,i),i=m(e,i)){J(i)&&(i=i[0]);g.splice(0,j,i);break}else if(h){a=a===h.name?h.location+"/"+h.main:h.location;g.splice(0,j,a);break}g=g.join("/");g+=b||(/\?/.test(g)||c?"":".js");g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+g}return k.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+k.urlArgs):g},load:function(a,b){l.load(i,a,b)},execCb:function(a,
b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))P=null,a=K(a),i.completeLoad(a.id)},onScriptError:function(a){var b=K(a);if(!z(b.id))return v(B("scripterror","Script error",a,[b.id]))}};i.require=i.makeRequire();return i}var l,w,x,D,t,E,P,K,Q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=
Array.prototype.splice,A=!!("undefined"!==typeof window&&navigator&&document),da=!A&&"undefined"!==typeof importScripts,ka=A&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Y="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),F={},r={},T=[],O=!1;if("undefined"===typeof define){if("undefined"!==typeof requirejs){if(I(requirejs))return;r=requirejs;requirejs=void 0}"undefined"!==typeof require&&!I(require)&&(r=require,require=void 0);l=requirejs=function(b,c,d,z){var h,
j="_";!J(b)&&"string"!==typeof b&&(h=b,J(c)?(b=c,c=d,d=z):b=[]);h&&h.context&&(j=h.context);(z=m(F,j))||(z=F[j]=l.s.newContext(j));h&&z.configure(h);return z.require(b,c,d)};l.config=function(b){return l(b)};l.nextTick="undefined"!==typeof setTimeout?function(b){setTimeout(b,4)}:function(b){b()};require||(require=l);l.version="2.1.5";l.jsExtRegExp=/^\/|:|\?|\.js$/;l.isBrowser=A;w=l.s={contexts:F,newContext:ha};l({});y(["toUrl","undef","defined","specified"],function(b){l[b]=function(){var c=F._;return c.require[b].apply(c,
arguments)}});if(A&&(x=w.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0]))x=w.head=D.parentNode;l.onError=function(b){throw b;};l.load=function(b,c,d){var l=b&&b.config||{},h;if(A)return h=l.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),h.type=l.scriptType||"text/javascript",h.charset="utf-8",h.async=!0,h.setAttribute("data-requirecontext",b.contextName),h.setAttribute("data-requiremodule",c),
h.attachEvent&&!(h.attachEvent.toString&&0>h.attachEvent.toString().indexOf("[native code"))&&!Y?(O=!0,h.attachEvent("onreadystatechange",b.onScriptLoad)):(h.addEventListener("load",b.onScriptLoad,!1),h.addEventListener("error",b.onScriptError,!1)),h.src=d,K=h,D?x.insertBefore(h,D):x.appendChild(h),K=null,h;if(da)try{importScripts(d),b.completeLoad(c)}catch(j){b.onError(B("importscripts","importScripts failed for "+c+" at "+d,j,[c]))}};A&&M(document.getElementsByTagName("script"),function(b){x||(x=
b.parentNode);if(t=b.getAttribute("data-main"))return r.baseUrl||(E=t.split("/"),Q=E.pop(),fa=E.length?E.join("/")+"/":"./",r.baseUrl=fa,t=Q),t=t.replace(ea,""),r.deps=r.deps?r.deps.concat(t):[t],!0});define=function(b,c,d){var l,h;"string"!==typeof b&&(d=c,c=b,b=null);J(c)||(d=c,c=[]);!c.length&&I(d)&&d.length&&(d.toString().replace(la,"").replace(ma,function(b,d){c.push(d)}),c=(1===d.length?["require"]:["require","exports","module"]).concat(c));if(O){if(!(l=K))P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),
function(b){if("interactive"===b.readyState)return P=b}),l=P;l&&(b||(b=l.getAttribute("data-requiremodule")),h=F[l.getAttribute("data-requirecontext")])}(h?h.defQueue:T).push([b,c,d])};define.amd={jQuery:!0};l.exec=function(b){return eval(b)};l(r)}})(this);

/* Zepto v1.0 - zepto event detect ajax touch data - zeptojs.com/license */

/**
 * @license
 * Lo-Dash 1.0.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash backbone mobile plus="template,pick,pluck"`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/**
 * @license RequireJS text 2.0.2+ Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * iScroll v4.2 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */

/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/

var Zepto=function(){function O(e){return e==null?String(e):T[N.call(e)]||"object"}function M(e){return O(e)=="function"}function _(e){return e!=null&&e==e.window}function D(e){return e!=null&&e.nodeType==e.DOCUMENT_NODE}function P(e){return O(e)=="object"}function H(e){return P(e)&&!_(e)&&e.__proto__==Object.prototype}function B(e){return e instanceof Array}function j(e){return typeof e.length=="number"}function F(e){return o.call(e,function(e){return e!=null})}function I(e){return e.length>0?n.fn.concat.apply([],e):e}function q(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function R(e){return e in f?f[e]:f[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function U(e,t){return typeof t=="number"&&!c[q(e)]?t+"px":t}function z(e){var t,n;return a[e]||(t=u.createElement(e),u.body.appendChild(t),n=l(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),n=="none"&&(n="block"),a[e]=n),a[e]}function W(e){return"children"in e?s.call(e.children):n.map(e.childNodes,function(e){if(e.nodeType==1)return e})}function X(n,r,i){for(t in r)i&&(H(r[t])||B(r[t]))?(H(r[t])&&!H(n[t])&&(n[t]={}),B(r[t])&&!B(n[t])&&(n[t]=[]),X(n[t],r[t],i)):r[t]!==e&&(n[t]=r[t])}function V(t,r){return r===e?n(t):n(t).filter(r)}function $(e,t,n,r){return M(t)?t.call(e,n,r):t}function J(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function K(t,n){var r=t.className,i=r&&r.baseVal!==e;if(n===e)return i?r.baseVal:r;i?r.baseVal=n:t.className=n}function Q(e){var t;try{return e?e=="true"||(e=="false"?!1:e=="null"?null:isNaN(t=Number(e))?/^[\[\{]/.test(e)?n.parseJSON(e):e:t):e}catch(r){return e}}function G(e,t){t(e);for(var n in e.childNodes)G(e.childNodes[n],t)}var e,t,n,r,i=[],s=i.slice,o=i.filter,u=window.document,a={},f={},l=u.defaultView.getComputedStyle,c={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},h=/^\s*<(\w+|!)[^>]*>/,p=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,d=/^(?:body|html)$/i,v=["val","css","html","text","data","width","height","offset"],m=["after","prepend","before","append"],g=u.createElement("table"),y=u.createElement("tr"),b={tr:u.createElement("tbody"),tbody:g,thead:g,tfoot:g,td:y,th:y,"*":u.createElement("div")},w=/complete|loaded|interactive/,E=/^\.([\w-]+)$/,S=/^#([\w-]*)$/,x=/^[\w-]+$/,T={},N=T.toString,C={},k,L,A=u.createElement("div");return C.matches=function(e,t){if(!e||e.nodeType!==1)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,s=!i;return s&&(i=A).appendChild(e),r=~C.qsa(i,t).indexOf(e),s&&A.removeChild(e),r},k=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},L=function(e){return o.call(e,function(t,n){return e.indexOf(t)==n})},C.fragment=function(t,r,i){t.replace&&(t=t.replace(p,"<$1></$2>")),r===e&&(r=h.test(t)&&RegExp.$1),r in b||(r="*");var o,u,a=b[r];return a.innerHTML=""+t,u=n.each(s.call(a.childNodes),function(){a.removeChild(this)}),H(i)&&(o=n(u),n.each(i,function(e,t){v.indexOf(e)>-1?o[e](t):o.attr(e,t)})),u},C.Z=function(e,t){return e=e||[],e.__proto__=n.fn,e.selector=t||"",e},C.isZ=function(e){return e instanceof C.Z},C.init=function(t,r){if(!t)return C.Z();if(M(t))return n(u).ready(t);if(C.isZ(t))return t;var i;if(B(t))i=F(t);else if(P(t))i=[H(t)?n.extend({},t):t],t=null;else if(h.test(t))i=C.fragment(t.trim(),RegExp.$1,r),t=null;else{if(r!==e)return n(r).find(t);i=C.qsa(u,t)}return C.Z(i,t)},n=function(e,t){return C.init(e,t)},n.extend=function(e){var t,n=s.call(arguments,1);return typeof e=="boolean"&&(t=e,e=n.shift()),n.forEach(function(n){X(e,n,t)}),e},C.qsa=function(e,t){var n;return D(e)&&S.test(t)?(n=e.getElementById(RegExp.$1))?[n]:[]:e.nodeType!==1&&e.nodeType!==9?[]:s.call(E.test(t)?e.getElementsByClassName(RegExp.$1):x.test(t)?e.getElementsByTagName(t):e.querySelectorAll(t))},n.contains=function(e,t){return e!==t&&e.contains(t)},n.type=O,n.isFunction=M,n.isWindow=_,n.isArray=B,n.isPlainObject=H,n.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},n.inArray=function(e,t,n){return i.indexOf.call(t,e,n)},n.camelCase=k,n.trim=function(e){return e.trim()},n.uuid=0,n.support={},n.expr={},n.map=function(e,t){var n,r=[],i,s;if(j(e))for(i=0;i<e.length;i++)n=t(e[i],i),n!=null&&r.push(n);else for(s in e)n=t(e[s],s),n!=null&&r.push(n);return I(r)},n.each=function(e,t){var n,r;if(j(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(r in e)if(t.call(e[r],r,e[r])===!1)return e;return e},n.grep=function(e,t){return o.call(e,t)},window.JSON&&(n.parseJSON=JSON.parse),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){T["[object "+t+"]"]=t.toLowerCase()}),n.fn={forEach:i.forEach,reduce:i.reduce,push:i.push,sort:i.sort,indexOf:i.indexOf,concat:i.concat,map:function(e){return n(n.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return n(s.apply(this,arguments))},ready:function(e){return w.test(u.readyState)?e(n):u.addEventListener("DOMContentLoaded",function(){e(n)},!1),this},get:function(t){return t===e?s.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(e){return i.every.call(this,function(t,n){return e.call(t,n,t)!==!1}),this},filter:function(e){return M(e)?this.not(this.not(e)):n(o.call(this,function(t){return C.matches(t,e)}))},add:function(e,t){return n(L(this.concat(n(e,t))))},is:function(e){return this.length>0&&C.matches(this[0],e)},not:function(t){var r=[];if(M(t)&&t.call!==e)this.each(function(e){t.call(this,e)||r.push(this)});else{var i=typeof t=="string"?this.filter(t):j(t)&&M(t.item)?s.call(t):n(t);this.forEach(function(e){i.indexOf(e)<0&&r.push(e)})}return n(r)},has:function(e){return this.filter(function(){return P(e)?n.contains(this,e):n(this).find(e).size()})},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!P(e)?e:n(e)},last:function(){var e=this[this.length-1];return e&&!P(e)?e:n(e)},find:function(e){var t,r=this;return typeof e=="object"?t=n(e).filter(function(){var e=this;return i.some.call(r,function(t){return n.contains(t,e)})}):this.length==1?t=n(C.qsa(this[0],e)):t=this.map(function(){return C.qsa(this,e)}),t},closest:function(e,t){var r=this[0],i=!1;typeof e=="object"&&(i=n(e));while(r&&!(i?i.indexOf(r)>=0:C.matches(r,e)))r=r!==t&&!D(r)&&r.parentNode;return n(r)},parents:function(e){var t=[],r=this;while(r.length>0)r=n.map(r,function(e){if((e=e.parentNode)&&!D(e)&&t.indexOf(e)<0)return t.push(e),e});return V(t,e)},parent:function(e){return V(L(this.pluck("parentNode")),e)},children:function(e){return V(this.map(function(){return W(this)}),e)},contents:function(){return this.map(function(){return s.call(this.childNodes)})},siblings:function(e){return V(this.map(function(e,t){return o.call(W(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return n.map(this,function(t){return t[e]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),l(this,"").getPropertyValue("display")=="none"&&(this.style.display=z(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=M(e);if(this[0]&&!t)var r=n(e).get(0),i=r.parentNode||this.length>1;return this.each(function(s){n(this).wrapAll(t?e.call(this,s):i?r.cloneNode(!0):r)})},wrapAll:function(e){if(this[0]){n(this[0]).before(e=n(e));var t;while((t=e.children()).length)e=t.first();n(e).append(this)}return this},wrapInner:function(e){var t=M(e);return this.each(function(r){var i=n(this),s=i.contents(),o=t?e.call(this,r):e;s.length?s.wrapAll(o):i.append(o)})},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var r=n(this);(t===e?r.css("display")=="none":t)?r.show():r.hide()})},prev:function(e){return n(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return n(this.pluck("nextElementSibling")).filter(e||"*")},html:function(t){return t===e?this.length>0?this[0].innerHTML:null:this.each(function(e){var r=this.innerHTML;n(this).empty().append($(this,t,e,r))})},text:function(t){return t===e?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=t})},attr:function(n,r){var i;return typeof n=="string"&&r===e?this.length==0||this[0].nodeType!==1?e:n=="value"&&this[0].nodeName=="INPUT"?this.val():!(i=this[0].getAttribute(n))&&n in this[0]?this[0][n]:i:this.each(function(e){if(this.nodeType!==1)return;if(P(n))for(t in n)J(this,t,n[t]);else J(this,n,$(this,r,e,this.getAttribute(n)))})},removeAttr:function(e){return this.each(function(){this.nodeType===1&&J(this,e)})},prop:function(t,n){return n===e?this[0]&&this[0][t]:this.each(function(e){this[t]=$(this,n,e,this[t])})},data:function(t,n){var r=this.attr("data-"+q(t),n);return r!==null?Q(r):e},val:function(t){return t===e?this[0]&&(this[0].multiple?n(this[0]).find("option").filter(function(e){return this.selected}).pluck("value"):this[0].value):this.each(function(e){this.value=$(this,t,e,this.value)})},offset:function(e){if(e)return this.each(function(t){var r=n(this),i=$(this,e,t,r.offset()),s=r.offsetParent().offset(),o={top:i.top-s.top,left:i.left-s.left};r.css("position")=="static"&&(o.position="relative"),r.css(o)});if(this.length==0)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(e,n){if(arguments.length<2&&typeof e=="string")return this[0]&&(this[0].style[k(e)]||l(this[0],"").getPropertyValue(e));var r="";if(O(e)=="string")!n&&n!==0?this.each(function(){this.style.removeProperty(q(e))}):r=q(e)+":"+U(e,n);else for(t in e)!e[t]&&e[t]!==0?this.each(function(){this.style.removeProperty(q(t))}):r+=q(t)+":"+U(t,e[t])+";";return this.each(function(){this.style.cssText+=";"+r})},index:function(e){return e?this.indexOf(n(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return i.some.call(this,function(e){return this.test(K(e))},R(e))},addClass:function(e){return this.each(function(t){r=[];var i=K(this),s=$(this,e,t,i);s.split(/\s+/g).forEach(function(e){n(this).hasClass(e)||r.push(e)},this),r.length&&K(this,i+(i?" ":"")+r.join(" "))})},removeClass:function(t){return this.each(function(n){if(t===e)return K(this,"");r=K(this),$(this,t,n,r).split(/\s+/g).forEach(function(e){r=r.replace(R(e)," ")}),K(this,r.trim())})},toggleClass:function(t,r){return this.each(function(i){var s=n(this),o=$(this,t,i,K(this));o.split(/\s+/g).forEach(function(t){(r===e?!s.hasClass(t):r)?s.addClass(t):s.removeClass(t)})})},scrollTop:function(){if(!this.length)return;return"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY},position:function(){if(!this.length)return;var e=this[0],t=this.offsetParent(),r=this.offset(),i=d.test(t[0].nodeName)?{top:0,left:0}:t.offset();return r.top-=parseFloat(n(e).css("margin-top"))||0,r.left-=parseFloat(n(e).css("margin-left"))||0,i.top+=parseFloat(n(t[0]).css("border-top-width"))||0,i.left+=parseFloat(n(t[0]).css("border-left-width"))||0,{top:r.top-i.top,left:r.left-i.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u.body;while(e&&!d.test(e.nodeName)&&n(e).css("position")=="static")e=e.offsetParent;return e})}},n.fn.detach=n.fn.remove,["width","height"].forEach(function(t){n.fn[t]=function(r){var i,s=this[0],o=t.replace(/./,function(e){return e[0].toUpperCase()});return r===e?_(s)?s["inner"+o]:D(s)?s.documentElement["offset"+o]:(i=this.offset())&&i[t]:this.each(function(e){s=n(this),s.css(t,$(this,r,e,s[t]()))})}}),m.forEach(function(e,t){var r=t%2;n.fn[e]=function(){var e,i=n.map(arguments,function(t){return e=O(t),e=="object"||e=="array"||t==null?t:C.fragment(t)}),s,o=this.length>1;return i.length<1?this:this.each(function(e,u){s=r?u:u.parentNode,u=t==0?u.nextSibling:t==1?u.firstChild:t==2?u:null,i.forEach(function(e){if(o)e=e.cloneNode(!0);else if(!s)return n(e).remove();G(s.insertBefore(e,u),function(e){e.nodeName!=null&&e.nodeName.toUpperCase()==="SCRIPT"&&(!e.type||e.type==="text/javascript")&&!e.src&&window.eval.call(window,e.innerHTML)})})})},n.fn[r?e+"To":"insert"+(t?"Before":"After")]=function(t){return n(t)[e](this),this}}),C.Z.prototype=n.fn,C.uniq=L,C.deserializeValue=Q,n.zepto=C,n}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(e){function o(e){return e._zid||(e._zid=r++)}function u(e,t,r,i){t=a(t);if(t.ns)var s=f(t.ns);return(n[o(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||s.test(e.ns))&&(!r||o(e.fn)===o(r))&&(!i||e.sel==i)})}function a(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function f(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function l(t,n,r){e.type(t)!="string"?e.each(t,r):t.split(/\s/).forEach(function(e){r(e,n)})}function c(e,t){return e.del&&(e.e=="focus"||e.e=="blur")||!!t}function h(e){return s[e]||e}function p(t,r,i,u,f,p){var d=o(t),v=n[d]||(n[d]=[]);l(r,i,function(n,r){var i=a(n);i.fn=r,i.sel=u,i.e in s&&(r=function(t){var n=t.relatedTarget;if(!n||n!==this&&!e.contains(this,n))return i.fn.apply(this,arguments)}),i.del=f&&f(r,n);var o=i.del||r;i.proxy=function(e){var n=o.apply(t,[e].concat(e.data));return n===!1&&(e.preventDefault(),e.stopPropagation()),n},i.i=v.length,v.push(i),t.addEventListener(h(i.e),i.proxy,c(i,p))})}function d(e,t,r,i,s){var a=o(e);l(t||"",r,function(t,r){u(e,t,r,i).forEach(function(t){delete n[a][t.i],e.removeEventListener(h(t.e),t.proxy,c(t,s))})})}function b(t){var n,r={originalEvent:t};for(n in t)!g.test(n)&&t[n]!==undefined&&(r[n]=t[n]);return e.each(y,function(e,n){r[e]=function(){return this[n]=v,t[e].apply(t,arguments)},r[n]=m}),r}function w(e){if(!("defaultPrevented"in e)){e.defaultPrevented=!1;var t=e.preventDefault;e.preventDefault=function(){this.defaultPrevented=!0,t.call(this)}}}var t=e.zepto.qsa,n={},r=1,i={},s={mouseenter:"mouseover",mouseleave:"mouseout"};i.click=i.mousedown=i.mouseup=i.mousemove="MouseEvents",e.event={add:p,remove:d},e.proxy=function(t,n){if(e.isFunction(t)){var r=function(){return t.apply(n,arguments)};return r._zid=o(t),r}if(typeof n=="string")return e.proxy(t[n],t);throw new TypeError("expected function")},e.fn.bind=function(e,t){return this.each(function(){p(this,e,t)})},e.fn.unbind=function(e,t){return this.each(function(){d(this,e,t)})},e.fn.one=function(e,t){return this.each(function(n,r){p(this,e,t,null,function(e,t){return function(){var n=e.apply(r,arguments);return d(r,t,e),n}})})};var v=function(){return!0},m=function(){return!1},g=/^([A-Z]|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(t,n,r){return this.each(function(i,s){p(s,n,r,t,function(n){return function(r){var i,o=e(r.target).closest(t,s).get(0);if(o)return i=e.extend(b(r),{currentTarget:o,liveFired:s}),n.apply(o,[i].concat([].slice.call(arguments,1)))}})})},e.fn.undelegate=function(e,t,n){return this.each(function(){d(this,t,n,e)})},e.fn.live=function(t,n){return e(document.body).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(document.body).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,r){return!n||e.isFunction(n)?this.bind(t,n||r):this.delegate(n,t,r)},e.fn.off=function(t,n,r){return!n||e.isFunction(n)?this.unbind(t,n||r):this.undelegate(n,t,r)},e.fn.trigger=function(t,n){if(typeof t=="string"||e.isPlainObject(t))t=e.Event(t);return w(t),t.data=n,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(t)})},e.fn.triggerHandler=function(t,n){var r,i;return this.each(function(s,o){r=b(typeof t=="string"?e.Event(t):t),r.data=n,r.target=o,e.each(u(o,t.type||t),function(e,t){i=t.proxy(r);if(r.isImmediatePropagationStopped())return!1})}),i},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()}catch(e){}}),this}}),e.Event=function(e,t){typeof e!="string"&&(t=e,e=t.type);var n=document.createEvent(i[e]||"Events"),r=!0;if(t)for(var s in t)s=="bubbles"?r=!!t[s]:n[s]=t[s];return n.initEvent(e,r,!0,null,null,null,null,null,null,null,null,null,null,null,null),n.isDefaultPrevented=function(){return this.defaultPrevented},n}}(Zepto),function(e){function t(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=u&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),l=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/),h=e.match(/(BB10).*Version\/([\d.]+)/),p=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),d=e.match(/PlayBook/),v=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),m=e.match(/Firefox\/([\d.]+)/);if(n.webkit=!!r)n.version=r[1];i&&(t.android=!0,t.version=i[2]),o&&(t.ios=t.iphone=!0,t.version=o[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),u&&(t.webos=!0,t.version=u[2]),a&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),h&&(t.bb10=!0,t.version=h[2]),p&&(t.rimtabletos=!0,t.version=p[2]),d&&(n.playbook=!0),f&&(t.kindle=!0,t.version=f[1]),l&&(n.silk=!0,n.version=l[1]),!l&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),v&&(n.chrome=!0,n.version=v[1]),m&&(n.firefox=!0,n.version=m[1]),t.tablet=!!(s||d||i&&!e.match(/Mobile/)||m&&e.match(/Tablet/)),t.phone=!t.tablet&&!!(i||o||u||c||h||v&&e.match(/Android/)||v&&e.match(/CriOS\/([\d.]+)/)||m&&e.match(/Mobile/))}t.call(e,navigator.userAgent),e.__detect=t}(Zepto),function($){function triggerAndReturn(e,t,n){var r=$.Event(t);return $(e).trigger(r,n),!r.defaultPrevented}function triggerGlobal(e,t,n,r){if(e.global)return triggerAndReturn(t||document,n,r)}function ajaxStart(e){e.global&&$.active++===0&&triggerGlobal(e,null,"ajaxStart")}function ajaxStop(e){e.global&&!--$.active&&triggerGlobal(e,null,"ajaxStop")}function ajaxBeforeSend(e,t){var n=t.context;if(t.beforeSend.call(n,e,t)===!1||triggerGlobal(t,n,"ajaxBeforeSend",[e,t])===!1)return!1;triggerGlobal(t,n,"ajaxSend",[e,t])}function ajaxSuccess(e,t,n){var r=n.context,i="success";n.success.call(r,e,i,t),triggerGlobal(n,r,"ajaxSuccess",[t,n,e]),ajaxComplete(i,t,n)}function ajaxError(e,t,n,r){var i=r.context;r.error.call(i,n,t,e),triggerGlobal(r,i,"ajaxError",[n,r,e]),ajaxComplete(t,n,r)}function ajaxComplete(e,t,n){var r=n.context;n.complete.call(r,t,e),triggerGlobal(n,r,"ajaxComplete",[t,n]),ajaxStop(n)}function empty(){}function mimeToDataType(e){return e&&(e=e.split(";",2)[0]),e&&(e==htmlType?"html":e==jsonType?"json":scriptTypeRE.test(e)?"script":xmlTypeRE.test(e)&&"xml")||"text"}function appendQuery(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function serializeData(e){e.processData&&e.data&&$.type(e.data)!="string"&&(e.data=$.param(e.data,e.traditional)),e.data&&(!e.type||e.type.toUpperCase()=="GET")&&(e.url=appendQuery(e.url,e.data))}function parseArguments(e,t,n,r){var i=!$.isFunction(t);return{url:e,data:i?t:undefined,success:i?$.isFunction(n)?n:undefined:t,dataType:i?r||n:n}}function serialize(e,t,n,r){var i,s=$.isArray(t);$.each(t,function(t,o){i=$.type(o),r&&(t=n?r:r+"["+(s?"":t)+"]"),!r&&s?e.add(o.name,o.value):i=="array"||!n&&i=="object"?serialize(e,o,n,t):e.add(t,o)})}var jsonpID=0,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(e){if("type"in e){var t="jsonp"+ ++jsonpID,n=document.createElement("script"),r=function(){clearTimeout(o),$(n).remove(),delete window[t]},i=function(n){r();if(!n||n=="timeout")window[t]=empty;ajaxError(null,n||"abort",s,e)},s={abort:i},o;return ajaxBeforeSend(s,e)===!1?(i("abort"),!1):(window[t]=function(t){r(),ajaxSuccess(t,s,e)},n.onerror=function(){i("error")},n.src=e.url.replace(/=\?/,"="+t),$("head").append(n),e.timeout>0&&(o=setTimeout(function(){i("timeout")},e.timeout)),s)}return $.ajax(e)},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host),settings.url||(settings.url=window.location.toString()),serializeData(settings),settings.cache===!1&&(settings.url=appendQuery(settings.url,"_="+Date.now()));var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=settings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.contentType!==!1&&settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){xhr.onreadystatechange=empty,clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:$.parseJSON(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,xhr.status?"error":"abort",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(e,t,n,r){return $.ajax(parseArguments.apply(null,arguments))},$.post=function(e,t,n,r){var i=parseArguments.apply(null,arguments);return i.type="POST",$.ajax(i)},$.getJSON=function(e,t,n){var r=parseArguments.apply(null,arguments);return r.dataType="json",$.ajax(r)},$.fn.load=function(e,t,n){if(!this.length)return this;var r=this,i=e.split(/\s/),s,o=parseArguments(e,t,n),u=o.success;return i.length>1&&(o.url=i[0],s=i[1]),o.success=function(e){r.html(s?$("<div>").html(e.replace(rscript,"")).find(s):e),u&&u.apply(r,arguments)},$.ajax(o),this};var escape=encodeURIComponent;$.param=function(e,t){var n=[];return n.add=function(e,t){this.push(escape(e)+"="+escape(t))},serialize(n,e,t),n.join("&").replace(/%20/g,"+")}}(Zepto),function(e){function u(e){return"tagName"in e?e:e.parentNode}function a(e,t,n,r){var i=Math.abs(e-t),s=Math.abs(n-r);return i>=s?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}function f(){o=null,t.last&&(t.el.trigger("longTap"),t={})}function l(){o&&clearTimeout(o),o=null}function c(){n&&clearTimeout(n),r&&clearTimeout(r),i&&clearTimeout(i),o&&clearTimeout(o),n=r=i=o=null,t={}}var t={},n,r,i,s=750,o;e(document).ready(function(){var h,p;e(document.body).bind("touchstart",function(r){h=Date.now(),p=h-(t.last||h),t.el=e(u(r.touches[0].target)),n&&clearTimeout(n),t.x1=r.touches[0].pageX,t.y1=r.touches[0].pageY,p>0&&p<=250&&(t.isDoubleTap=!0),t.last=h,o=setTimeout(f,s)}).bind("touchmove",function(e){l(),t.x2=e.touches[0].pageX,t.y2=e.touches[0].pageY,Math.abs(t.x1-t.x2)>10&&e.preventDefault()}).bind("touchend",function(s){l(),t.x2&&Math.abs(t.x1-t.x2)>30||t.y2&&Math.abs(t.y1-t.y2)>30?i=setTimeout(function(){t.el.trigger("swipe"),t.el.trigger("swipe"+a(t.x1,t.x2,t.y1,t.y2)),t={}},0):"last"in t&&(r=setTimeout(function(){var r=e.Event("tap");r.cancelTouch=c,t.el.trigger(r),t.isDoubleTap?(t.el.trigger("doubleTap"),t={}):n=setTimeout(function(){n=null,t.el.trigger("singleTap"),t={}},250)},0))}).bind("touchcancel",c),e(window).bind("scroll",c)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){e.fn[t]=function(e){return this.bind(t,e)}})}(Zepto),function(e){function s(s,u){var a=s[i],f=a&&t[a];if(u===undefined)return f||o(s);if(f){if(u in f)return f[u];var l=r(u);if(l in f)return f[l]}return n.call(e(s),u)}function o(n,s,o){var a=n[i]||(n[i]=++e.uuid),f=t[a]||(t[a]=u(n));return s!==undefined&&(f[r(s)]=o),f}function u(t){var n={};return e.each(t.attributes,function(t,i){i.name.indexOf("data-")==0&&(n[r(i.name.replace("data-",""))]=e.zepto.deserializeValue(i.value))}),n}var t={},n=e.fn.data,r=e.camelCase,i=e.expando="Zepto"+ +(new Date);e.fn.data=function(t,n){return n===undefined?e.isPlainObject(t)?this.each(function(n,r){e.each(t,function(e,t){o(r,e,t)})}):this.length==0?undefined:s(this[0],t):this.each(function(){o(this,t,n)})},e.fn.removeData=function(n){return typeof n=="string"&&(n=n.split(/\s+/)),this.each(function(){var s=this[i],o=s&&t[s];o&&e.each(n,function(){delete o[r(this)]})})}}(Zepto),define("jquery",["jquery/zepto"],function(e){return e}),define("jquery/zepto",function(e){return function(){var t,n;return t||e.Zepto}}(this)),function(e,t){function G(e){if(e&&typeof e=="object"&&e.__wrapped__)return e;if(!(this instanceof G))return new G(e);this.__wrapped__=e}function Y(e){return e.charCodeAt(0)}function Z(e,t){var n=e.index,r=t.index;e=e.criteria,t=t.criteria;if(e!==t){if(e>t||typeof e=="undefined")return 1;if(e<t||typeof t=="undefined")return-1}return n<r?-1:1}function et(e,t,n){function r(){var i=arguments,s=t;n.length&&(i=i.length?n.concat(ut(i)):n);if(this instanceof r){ot.prototype=e.prototype,s=new ot,ot.prototype=null;var o=e.apply(s,i);return Ct(o)?o:s}return e.apply(s,i)}return r}function tt(e,t,n){if(e==null)return ln;var r=typeof e;if(r!="function"){if(r!="object")return function(t){return t[e]};var i=pt(e);return function(t){var n=i.length,r=!1;while(n--)if(!(r=t[i[n]]===e[i[n]]))break;return r}}return typeof t!="undefined"?n===1?function(n){return e.call(t,n)}:n===2?function(n,r){return e.call(t,n,r)}:n===4?function(n,r,i,s){return e.call(t,n,r,i,s)}:function(n,r,i){return e.call(t,n,r,i)}:e}function rt(e){return"\\"+Q[e]}function it(e){return mt[e]}function st(e){return typeof e.toString!="function"&&typeof (e+"")=="string"}function ot(){}function ut(e,t,n){t||(t=0),typeof n=="undefined"&&(n=e?e.length:0);var r=-1,i=n-t||0,s=Array(i<0?0:i);while(++r<i)s[r]=e[t+r];return s}function at(e){return gt[e]}function ft(e){return k.call(e)==B}function dt(e){var t=!1;if(!e||typeof e!="object"||ft(e))return t;var n=e.constructor;return!Nt(n)||n instanceof n?(lt(e,function(e,n){t=n}),t===!1||N.call(e,t)):t}function vt(e){var t=[];return ct(e,function(e,n){t.push(n)}),t}function yt(e){if(!e)return e;for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)e[i]=r[i]}return e}function bt(e){return Ct(e)?ht(e)?ut(e):yt({},e):e}function wt(e){if(!e)return e;for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];if(r)for(var i in r)e[i]==null&&(e[i]=r[i])}return e}function Et(e){var t=[];return lt(e,function(e,n){Nt(e)&&t.push(n)}),t.sort()}function St(e,t){return e?N.call(e,t):!1}function xt(e){if(!e)return!0;if(ht(e)||Lt(e))return!e.length;for(var t in e)if(N.call(e,t))return!1;return!0}function Tt(e,t,n,r){if(e===t)return e!==0||1/e==1/t;var i=typeof e,s=typeof t;if(e===e&&(!e||i!="function"&&i!="object")&&(!t||s!="function"&&s!="object"))return!1;if(e==null||t==null)return e===t;var o=k.call(e),u=k.call(t);if(o!=u)return!1;switch(o){case F:case I:return+e==+t;case R:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case z:case W:return e==t+""}var f=o==j;if(!f){if(e.__wrapped__||t.__wrapped__)return Tt(e.__wrapped__||e,t.__wrapped__||t,n,r);if(o!=U)return!1;var l=e.constructor,c=t.constructor;if(l!=c&&!(Nt(l)&&l instanceof l&&Nt(c)&&c instanceof c))return!1}n||(n=[]),r||(r=[]);var h=n.length;while(h--)if(n[h]==e)return r[h]==t;var p=!0,d=0;n.push(e),r.push(t);if(f){d=t.length,p=d==e.length;if(p)while(d--)if(!(p=Tt(e[d],t[d],n,r)))break;return p}return lt(t,function(t,i,s){if(N.call(s,i))return d++,!(p=N.call(e,i)&&Tt(e[i],t,n,r))&&a}),p&&lt(e,function(e,t,n){if(N.call(n,t))return!(p=--d>-1)&&a}),p}function Nt(e){return typeof e=="function"}function Ct(e){return e?K[typeof e]:!1}function kt(e){return e instanceof RegExp||k.call(e)==z}function Lt(e){return typeof e=="string"||k.call(e)==W}function At(e){var t=0,n=x.apply(s,arguments),r=n.length,i={};while(++t<r){var o=n[t];o in e&&(i[o]=e[o])}return i}function Ot(e){var t=-1,n=pt(e),r=n.length,i=Array(r);while(++t<r)i[t]=e[n[t]];return i}function Mt(e,t){var n=e?e.length:0,r=!1;return typeof n=="number"?r=Yt(e,t)>-1:nt(e,function(e){return(r=e===t)&&a}),r}function _t(e,t,n){var r={};return t=tt(t,n),Bt(e,function(e,n,i){n=t(e,n,i)+"",N.call(r,n)?r[n]++:r[n]=1}),r}function Dt(e,t,n){var r=!0;t=tt(t,n);if(ht(e)){var i=-1,s=e.length;while(++i<s)if(!(r=!!t(e[i],i,e)))break}else nt(e,function(e,n,i){return!(r=!!t(e,n,i))&&a});return r}function Pt(e,t,n){var r=[];t=tt(t,n);if(ht(e)){var i=-1,s=e.length;while(++i<s){var o=e[i];t(o,i,e)&&r.push(o)}}else nt(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function Ht(e,t,n){var r;return t=tt(t,n),Bt(e,function(e,n,i){if(t(e,n,i))return r=e,a}),r}function Bt(e,t,n){if(t&&typeof n=="undefined"&&ht(e)){var r=-1,i=e.length;while(++r<i)if(t(e[r],r,e)===a)break}else nt(e,t,n)}function jt(e,t,n){var r={};return t=tt(t,n),Bt(e,function(e,n,i){n=t(e,n,i)+"",(N.call(r,n)?r[n]:r[n]=[]).push(e)}),r}function Ft(e,t){var n=ut(arguments,2),r=-1,i=typeof t=="function",s=e?e.length:0,o=Array(typeof s=="number"?s:0);return Bt(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o}function It(e,t,n){var r=-1,i=e?e.length:0,s=Array(typeof i=="number"?i:0);t=tt(t,n);if(ht(e))while(++r<i)s[r]=t(e[r],r,e);else nt(e,function(e,n,i){s[++r]=t(e,n,i)});return s}function qt(e,t,n){var r=-Infinity,i=r;if(!t&&ht(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u>i&&(i=u)}}else t=tt(t,n),nt(e,function(e,n,s){var o=t(e,n,s);o>r&&(r=o,i=e)});return i}function Rt(e,t,n){var r=Infinity,i=r;if(!t&&ht(e)){var s=-1,o=e.length;while(++s<o){var u=e[s];u<i&&(i=u)}}else t=tt(t,n),nt(e,function(e,n,s){var o=t(e,n,s);o<r&&(r=o,i=e)});return i}function zt(e,t,n,r){var i=arguments.length<3;t=tt(t,r,4);if(ht(e)){var s=-1,o=e.length;i&&(n=e[++s]);while(++s<o)n=t(n,e[s],s,e)}else nt(e,function(e,r,s){n=i?(i=!1,e):t(n,e,r,s)});return n}function Wt(e,t,n,r){var i=e,s=e?e.length:0,o=arguments.length<3;if(typeof s!="number"){var u=pt(e);s=u.length}return t=tt(t,r,4),Bt(e,function(e,r,a){r=u?u[--s]:--s,n=o?(o=!1,i[r]):t(n,i[r],r,a)}),n}function Xt(e,t,n){return t=tt(t,n),Pt(e,function(e,n,r){return!t(e,n,r)})}function Vt(e){var t=-1,n=e?e.length:0,r=Array(typeof n=="number"?n:0);return Bt(e,function(e){var n=T(H()*(++t+1));r[t]=r[n],r[n]=e}),r}function $t(e){var t=e?e.length:0;return typeof t=="number"?t:pt(e).length}function Jt(e,t,n){var r;t=tt(t,n);if(ht(e)){var i=-1,s=e.length;while(++i<s)if(r=t(e[i],i,e))break}else nt(e,function(e,n,i){return(r=t(e,n,i))&&a});return!!r}function Kt(e,t,n){var r=-1,i=e?e.length:0,s=Array(typeof i=="number"?i:0);t=tt(t,n),Bt(e,function(e,n,i){s[++r]={criteria:t(e,n,i),index:r,value:e}}),i=s.length,s.sort(Z);while(i--)s[i]=s[i].value;return s}function Qt(e){return e&&typeof e.length=="number"?ut(e):Ot(e)}function Gt(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=null){var s=-1;t=tt(t,n);while(++s<i&&t(e[s],s,e))r++}else{r=t;if(r==null||n)return e[0]}return ut(e,0,P(D(0,r),i))}}function Yt(e,t,n){var r=-1,i=e?e.length:0;if(typeof n=="number")r=(n<0?D(0,i+n):n||0)-1;else if(n)return r=rn(e,t),e[r]===t?r:-1;while(++r<i)if(e[r]===t)return r;return-1}function Zt(e,t,n){if(!e)return[];var r=0,i=e.length;if(typeof t!="number"&&t!=null){var s=i;t=tt(t,n);while(s--&&t(e[s],s,e))r++}else r=t==null||n?1:t||r;return ut(e,0,P(D(0,i-r),i))}function en(e,t,n){if(e){var r=0,i=e.length;if(typeof t!="number"&&t!=null){var s=i;t=tt(t,n);while(s--&&t(e[s],s,e))r++}else{r=t;if(r==null||n)return e[i-1]}return ut(e,D(0,i-r))}}function tn(e,t,n){var r=e?e.length:0;typeof n=="number"&&(r=(n<0?D(0,r+n):P(n,r-1))+1);while(r--)if(e[r]===t)return r;return-1}function nn(e,t,n){if(typeof t!="number"&&t!=null){var r=0,i=-1,s=e?e.length:0;t=tt(t,n);while(++i<s&&t(e[i],i,e))r++}else r=t==null||n?1:D(0,t);return ut(e,r)}function rn(e,t,n,r){var i=0,s=e?e.length:i;n=n?tt(n,r,1):ln,t=n(t);while(i<s){var o=i+s>>>1;n(e[o])<t?i=o+1:s=o}return i}function sn(e){var t=-1,n=e.length,r=[];while(++t<n){var i=e[t];Yt(arguments,i,1)<0&&r.push(i)}return r}function on(e,t){return $||L&&arguments.length>2?L.call.apply(L,arguments):et(e,t,ut(arguments,2))}function un(e){var t=x.apply(s,arguments),n=t.length>1?0:(t=Et(e),-1),r=t.length;while(++n<r){var i=t[n];e[i]=on(e[i],e)}return e}function an(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function fn(e){return e==null?"":(e+"").replace(b,it)}function ln(e){return e}function cn(e){Bt(Et(e),function(t){var n=G[t]=e[t];G.prototype[t]=function(){var e=[this.__wrapped__];C.apply(e,arguments);var t=n.apply(G,e);return this.__chain__&&(t=new G(t),t.__chain__=!0),t}})}function hn(e,t){var n=e?e[t]:null;return Nt(n)?e[t]():n}function pn(e,t,n){e||(e=""),n=wt({},n,G.templateSettings);var r=0,i="__p += '",s=n.variable,o=RegExp((n.escape||y).source+"|"+(n.interpolate||y).source+"|"+(n.evaluate||y).source+"|$","g");e.replace(o,function(t,n,s,o,u){return i+=e.slice(r,u).replace(w,rt),n&&(i+="' +\n_.escape("+n+") +\n'"),o&&(i+="';\n"+o+";\n__p += '"),s&&(i+="' +\n((__t = ("+s+")) == null ? '' : __t) +\n'"),r=u+t.length,t}),i+="';\n",s||(s="obj",i="with ("+s+" || {}) {\n"+i+"\n}\n"),i="function("+s+") {\n"+"var __t, __p = '', __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n"+i+"return __p\n}";try{var u=Function("_","return "+i)(G)}catch(a){throw a.source=i,a}return t?u(t):(u.source=i,u)}function dn(e){var t=++u+"";return e?e+t:t}function vn(e){return e=new G(e),e.__chain__=!0,e}function mn(){return this.__chain__=!0,this}function gn(){return this.__wrapped__+""}function yn(){return this.__wrapped__}var n=typeof exports=="object"&&exports,r=typeof module=="object"&&module&&module.exports==n&&module,i=typeof global=="object"&&global;i.global===i&&(e=i);var s=[],o={},u=0,a=o,f=e._,l=/&(?:amp|lt|gt|quot|#39);/g,c=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,p=/(__e\(.*?\)|\b__t\)) \+\n'';/g,d=/\w*$/,v=RegExp("^"+(o.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),m=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,g=/<%=([\s\S]+?)%>/g,y=/($^)/,b=/[&<>"']/g,w=/['\n\r\t\u2028\u2029\\]/g,E=0,S=Math.ceil,x=s.concat,T=Math.floor,N=o.hasOwnProperty,C=s.push,k=o.toString,L=v.test(L=ut.bind)&&L,A=v.test(A=Array.isArray)&&A,O=e.isFinite,M=e.isNaN,_=v.test(_=Object.keys)&&_,D=Math.max,P=Math.min,H=Math.random,B="[object Arguments]",j="[object Array]",F="[object Boolean]",I="[object Date]",q="[object Function]",R="[object Number]",U="[object Object]",z="[object RegExp]",W="[object String]",X=!!e.attachEvent,V=L&&!/\n|true/.test(L+X),$=L&&!V,J=!0;(function(){function t(){this.x=1}var e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments)J=!n})(1);var K={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},Q={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};G.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:g,variable:""};var nt=function(e,t,n){var r,i=e,s=i;if(!i)return s;t=t&&typeof n=="undefined"?t:tt(t,n);var o=i.length;r=-1;if(typeof o=="number"){while(++r<o)if(t(i[r],r,e)===a)return s}else for(r in i)if(N.call(i,r)&&t(i[r],r,e)===a)return s},lt=function(e,t){var n,r=e,i=r;if(!r)return i;if(!K[typeof r])return i;t||(t=ln);for(n in r)if(t(r[n],n,e)===a)return i;return i},ct=function(e,t){var n,r=e,i=r;if(!r)return i;if(!K[typeof r])return i;t||(t=ln);for(n in r)if(N.call(r,n)&&t(r[n],n,e)===a)return i;return i},ht=A||function(e){return e instanceof Array||k.call(e)==j},pt=_?function(e){return Ct(e)?J&&e.length&&ft(e)?vt(e):_(e):[]}:vt,mt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'"};Nt(/x/)&&(Nt=function(e){return e instanceof Function||k.call(e)==q});var Ut=It;V&&r&&typeof setImmediate=="function"&&(defer=on(setImmediate,e)),G.bind=on,G.bindAll=un,G.countBy=_t,G.defaults=wt,G.filter=Pt,G.forEach=Bt,G.functions=Et,G.groupBy=jt,G.initial=Zt,G.invoke=Ft,G.keys=pt,G.map=It,G.max=qt,G.min=Rt,G.once=an,G.pick=At,G.pluck=Ut,G.reject=Xt,G.rest=nn,G.shuffle=Vt,G.sortBy=Kt,G.toArray=Qt,G.values=Ot,G.without=sn,G.collect=It,G.drop=nn,G.each=Bt,G.extend=yt,G.methods=Et,G.select=Pt,G.tail=nn,G.clone=bt,G.contains=Mt,G.escape=fn,G.every=Dt,G.find=Ht,G.has=St,G.identity=ln,G.indexOf=Yt,G.isArguments=ft,G.isArray=ht,G.isEmpty=xt,G.isEqual=Tt,G.isFunction=Nt,G.isObject=Ct,G.isRegExp=kt,G.isString=Lt,G.lastIndexOf=tn,G.mixin=cn,G.reduce=zt,G.reduceRight=Wt,G.result=hn,G.size=$t,G.some=Jt,G.sortedIndex=rn,G.template=pn,G.uniqueId=dn,G.all=Dt,G.any=Jt,G.detect=Ht,G.foldl=zt,G.foldr=Wt,G.include=Mt,G.inject=zt,G.first=Gt,G.last=en,G.take=Gt,G.head=Gt,G.chain=vn,G.VERSION="1.0.1",cn(G),G.prototype.chain=mn,G.prototype.value=yn,nt(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];G.prototype[e]=function(){var e=this.__wrapped__;return t.apply(e,arguments),this}}),nt(["concat","join","slice"],function(e){var t=s[e];G.prototype[e]=function(){var e=this.__wrapped__,n=t.apply(e,arguments);return this.__chain__&&(n=new G(n),n.__chain__=!0),n}}),n?r?(r.exports=G)._=G:n._=G:e._=G}(this),define("underscore",["underscore/lodash.custom"],function(e){return e}),define("underscore/lodash.custom",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="0.9.10";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=/\s+/,f=function(e,t,n,r){if(!n)return!0;if(typeof n=="object")for(var i in n)e[t].apply(e,[i,n[i]].concat(r));else{if(!a.test(n))return!0;var s=n.split(a);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r))}},l=function(e,t){var n,r=-1,i=e.length;switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,t[0]);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,t[0],t[1]);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,t[0],t[1],t[2]);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},c=o.Events={on:function(e,t,n){if(!f(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!f(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n),this},off:function(e,t,n){var r,i,s,o,a,l,c,h;if(!this._events||!f(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,l=o.length;a<l;a++){e=o[a];if(r=this._events[e]){s=[];if(t||n)for(c=0,h=r.length;c<h;c++)i=r[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&s.push(i);this._events[e]=s}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!f(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&l(n,t),r&&l(r,arguments),this},listenTo:function(e,t,n){var r=this._listeners||(this._listeners={}),i=e._listenerId||(e._listenerId=u.uniqueId("l"));return r[i]=e,e.on(t,typeof t=="object"?this:n,this),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return;if(e)e.off(t,typeof t=="object"?this:n,this),!t&&!n&&delete r[e._listenerId];else{typeof t=="object"&&(n=this);for(var i in r)r[i].off(t,n,this);this._listeners={}}return this}};c.bind=c.on,c.unbind=c.off,u.extend(o,c);var h=o.Model=function(e,t){var n,r=e||{};this.cid=u.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};u.extend(h.prototype,c,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){if(!e.set(e.parse(n,r),r))return!1;t&&t(e,n,r)},this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o,a=this.attributes;return e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t,r&&(!n||!n.wait)&&!this.set(r,n)?!1:(n=u.extend({validate:!0},n),this._validate(r,n)?(r&&n.wait&&(this.attributes=u.extend({},a,r)),n.parse===void 0&&(n.parse=!0),i=n.success,n.success=function(e,t,n){e.attributes=a;var s=e.parse(t,n);n.wait&&(s=u.extend(r||{},s));if(u.isObject(s)&&!e.set(s,n))return!1;i&&i(e,t,n)},s=this.isNew()?"create":n.patch?"patch":"update",s==="patch"&&(n.attrs=r),o=this.sync(s,this,n),r&&n.wait&&(this.attributes=a),o):!1)},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(e,t,i){(i.wait||e.isNew())&&r(),n&&n(e,t,i)};if(this.isNew())return e.success(this,null,e),!1;var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||M();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var p=o.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))};u.extend(p.prototype,c,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,i,o,a,f,l,c,h,p,d;c=[],h=t.at,p=this.comparator&&h==null&&t.sort!=0,d=u.isString(this.comparator)?this.comparator:null;for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(a=e[n],t))){this.trigger("invalid",this,a,t);continue}if(f=this.get(o)){t.merge&&(f.set(a===o?o.attributes:a,t),p&&!l&&f.hasChanged(d)&&(l=!0));continue}c.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o)}c.length&&(p&&(l=!0),this.length+=c.length,h!=null?s.apply(this.models,[h,0].concat(c)):r.apply(this.models,c)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=c.length;n<i;n++)(o=c[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e])},at:function(e){return this.models[e]},where:function(e){return u.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return u.invoke(this.models,"get",e)},update:function(e,t){t=u.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,r,i,s,o=[],a=[],f={};u.isArray(e)||(e=e?[e]:[]);if(t.add&&!t.remove)return this.add(e,t);for(r=0,i=e.length;r<i;r++)n=e[r],s=this.get(n),t.remove&&s&&(f[s.cid]=!0),(t.add&&!s||t.merge&&s)&&o.push(n);if(t.remove)for(r=0,i=this.models.length;r<i;r++)n=this.models[r],f[n.cid]||a.push(n);return a.length&&this.remove(a,t),o.length&&this.add(o,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success;return e.success=function(e,n,r){var i=r.update?"update":"reset";e[i](n,r),t&&t(e,n,r)},this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)}});var d=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(d,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var v=["groupBy","countBy","sortBy"];u.each(v,function(e){p.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var m=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},g=/\((.*?)\)/g,y=/(\(\?)?:\w+/g,b=/\*\w+/g,w=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(m.prototype,c,{initialize:function(){},route:function(e,t,n){return u.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),o.history.route(e,u.bind(function(r){var i=this._extractParameters(e,r);n&&n.apply(this,i),this.trigger.apply(this,["route:"+t].concat(i)),this.trigger("route",t,i),o.history.trigger("route",this,t,i)},this)),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(w,"\\$&").replace(g,"(?:$1)?").replace(y,function(e,t){return t?e:"([^/]+)"}).replace(b,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var E=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},S=/^[#\/]|\s+$/g,x=/^\/+|\/+$/g,T=/msie [\w.]+/,N=/\/$/;E.started=!1,u.extend(E.prototype,c,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(N,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(S,"")},start:function(e){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=T.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(x,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(S,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),E.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!E.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new E;var C=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},k=/^(\S+)\s*(.*)$/,L=["model","collection","el","id","attributes","className","tagName","events"];u.extend(C.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(k),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,L)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}});var A={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.sync=function(e,t,n){var r=A[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||M()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1);var a=n.success;n.success=function(e){a&&a(t,e,n),t.trigger("sync",t,e,n)};var f=n.error;n.error=function(e){f&&f(t,e,n),t.trigger("error",t,e,n)};var l=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,l,n),l},o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var O=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};h.extend=p.extend=m.extend=C.extend=E.extend=O;var M=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["backbone/backbone"],function(e){return e}),define("backbone/backbone",["underscore","jquery"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("tools/Storage",[],function(){var e=function(e){var t=typeof localStorage[e]=="undefined"||localStorage[e]===null;t&&e=="stocks"?localStorage.setItem(e,"000001.SH,399001.SZ"):t&&e=="userdata"?localStorage.setItem(e,"38,"):t&&e!="stocks"&&localStorage.setItem(e,"");var n=function(t){var n=localStorage[e].split(",");return n.some(function(e){return e==t})};return{remove:function(t){localStorage.setItem(e,localStorage[e].split(",").filter(function(e){return e!=t}).join(","))},insert:function(t){var n=[],r={historysearch:20};localStorage[e].length!==0&&(n=localStorage[e].split(","),n.some(function(e){return e==t})&&(this.remove(t),n=localStorage[e].split(","))),n.unshift(t);if(r[e]!==undefined)for(i=n.length;i>r[e];i--)n.pop();localStorage.setItem(e,n.join(","))},cover:function(t,n){var r=localStorage[e].split(",");r.splice(t,1,n),localStorage.setItem(e,r)},has:n}};return e}),define("models/Security",["backbone"],function(e){var t=function(e){var t=e.toString().length;return t>=8?e="<span>"+(e/1e8).round(2)+"</span>亿":t>=4?e="<span>"+(e/1e4).round(2)+"</span>万":e="<span>"+e+"</span>",e},n=e.Model.extend({idAttribute:"code",defaults:{code:"",cn:"-",latest:0,open:0,high:0,low:0,close:0,amount:0,vol:0,swap:0,earning:0,news:{id:0,title:"",time:0}},initialize:function(e){this.set("isIndex",/^(000\d{3}\.SH|399\d{3}\.SZ)$/.test(this.get("code")))},getFormatted:function(){var e=this.isIndex?3:2,n=this.toJSON();return n.close=n.close.round(e),n.latest===0&&n.amount===0?(n.high="-",n.low="-",n.open="-",n.amount="-",n.vol="-",n.swap="-",n.change="-",n.change_p="-",n.latest=n.close,n.isStoping=!0):(n.change=(n.latest-n.close).round(2),n.change_p=((n.latest/n.close-1)*100).round(2),n.high=n.high.round(e),n.low=n.low.round(e),n.open=n.open.round(e),n.latest=n.latest.round(e),n.amount=t(n.amount),n.vol=t(n.vol)+"手",n.swap+="%",n.isStoping=!1),n.earning===0&&(n.earning="亏损"),n}});return n}),define("collections/SecurityCollection",["jquery","underscore","backbone","models/Security"],function(e,t,n,r){var i=n.Collection.extend({model:r});return i}),define("Application",["underscore","backbone","tools/Storage","collections/SecurityCollection"],function(e,t,n,r){var i=$("#workSpace").width()/320,s={myTabNum:0,priceTabNum:0,picList:!1,detailTabNum:0,detailPicTabNum:"today",searchTabNum:0,opTipsPoproll:0,fontSizeUser:i*18,fontSizeMax:i*25,fontSizeMin:i*14,manualRefresh:"",apiServer:window.apiServer||"/api/",history:new n("history"),historySearch:new n("historysearch"),userData:new n("userdata"),isMobile:navigator.userAgent.match(/mobile/i),isTouchDevice:"ontouchstart"in document.documentElement,isEventStart:"ontouchstart"in document.documentElement?"touchstart":"click",isIEMobile:/iemobile/.test(navigator.userAgent.toLowerCase())};return e.extend(s,t.Events),s.on("system:message",function(e){console.log("got system message: "+e)}),s.on("info",function(e){console.log("got info: ",e)}),s.on("error",function(e){console.log("got error: ",e)}),s}),define("tools/formatTime",[],function(){var e=function(e){var t=new Date,n=parseInt(t.getTime()/1e3),r=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),r=new Date(r),i=parseInt(Date.parse(r)/1e3),s=0>i-e;return agotime=(n-e)/86400,agoday=parseInt(agotime),agoH=(agotime-agoday)*24,agohour=parseInt(agoH),agomin=parseInt((agoH-agohour)*60),fmtime="",agoday>=1?fmtime=agoday+"天前":1>agoday&&agohour>=1?s?fmtime=agohour+"小时前":fmtime="1天前":(agomin==0?agomin=1:agomin,fmtime=agomin+"分钟前"),fmtime};return e}),define("text/text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.2+",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text",["text/text"],function(e){return e}),define("text!templates/newsItem.html",[],function(){return'<span><%= title %></span><time datetime="<%= time %>"><%= fmtime %></time>\n'}),define("views/NewsView",["jquery","underscore","backbone","tools/formatTime","text!templates/newsItem.html"],function(e,t,n,r,i){var s=n.View.extend({tagName:"p",template:t.template(i),events:{click:"showContent"},showContent:function(){if(iScrollMove)return;securityRouter.navigate("news/"+this.model.get("id")+"/",!0)},render:function(){return this.model.set("fmtime",r(this.model.get("time"))),this.$el.html(this.template(this.model.toJSON())),this}});return s}),define("text!templates/defaultSecurityItem.html",[],function(){return"<!--首页自选列表-->\n<div class=\"<%= change_p > 0 ? 'red' : (change_p == 0 || isStoping ? 'gray' : 'green' ) %>\">\n  <p class=\"num\"><%= code %></p>\n  <p class=\"name\"><%= cn %></p>\n  <p><%= latest %></p>\n<% if (isStoping) { %>\n  <p>未开盘</p>\n<% } else { %>\n  <p><%= change_p %>%<%= change_p > 0 ? '<span class=\"icon-arrowup\"></span>' : (change_p == 0 ? '<span class=\"arrowflat\"></span>' : '<span class=\"icon-arrowdown\"></span>' ) %></p>\n<% } %>\n</div>"}),define("collections/NewsList",["jquery","underscore","backbone","Application"],function(e,t,n,r){var i={},s=n.Model.extend({}),o=n.Collection.extend({model:s}),u=function(){return new o};return u}),function(e,t){function O(e){return i===""?e:(e=e.charAt(0).toUpperCase()+e.substr(1),i+e)}var n=Math,r=t.createElement("div").style,i=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,i=e.length;for(;n<i;n++){t=e[n]+"ransform";if(t in r)return e[n].substr(0,e[n].length-1)}return!1}(),s=i?"-"+i.toLowerCase()+"-":"",o=O("transform"),u=O("transitionProperty"),a=O("transitionDuration"),f=O("transformOrigin"),l=O("transitionTimingFunction"),c=O("transitionDelay"),h=/android/gi.test(navigator.appVersion),p=/iphone|ipad/gi.test(navigator.appVersion),d=/hp-tablet/gi.test(navigator.appVersion),v=O("perspective")in r,m="ontouchstart"in e&&!d,g=!!i,y=O("transition")in r,b="onorientationchange"in e?"orientationchange":"resize",w=m?"touchstart":"mousedown",E=m?"touchmove":"mousemove",S=m?"touchend":"mouseup",x=m?"touchcancel":"mouseup",T=i=="Moz"?"DOMMouseScroll":"mousewheel",N=function(){if(i===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"oTransitionEnd",ms:"MSTransitionEnd"};return e[i]}(),C=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),k=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),L=v?" translateZ(0)":"",A=function(n,r){var i=this,c;i.wrapper=typeof n=="object"?n:t.getElementById(n),i.wrapper.style.overflow="hidden",i.scroller=i.wrapper.children[0],i.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:h,hideScrollbar:p,fadeScrollbar:p&&v,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(c in r)i.options[c]=r[c];i.x=i.options.x,i.y=i.options.y,i.options.useTransform=g&&i.options.useTransform,i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar,i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar,i.options.zoom=i.options.useTransform&&i.options.zoom,i.options.useTransition=y&&i.options.useTransition,i.options.zoom&&h&&(L=""),i.scroller.style[u]=i.options.useTransform?s+"transform":"top left",i.scroller.style[a]="0",i.scroller.style[f]="0 0",i.options.useTransition&&(i.scroller.style[l]="cubic-bezier(0.33,0.66,0.66,1)"),i.options.useTransform?i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px)"+L:i.scroller.style.cssText+=";position:absolute;top:"+i.y+"px;left:"+i.x+"px",i.options.useTransition&&(i.options.fixedScrollbar=!0),i.refresh(),i._bind(b,e),i._bind(w),m||i.options.wheelAction!="none"&&i._bind(T),i.options.checkDOMChanges&&(i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500))};A.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case w:if(!m&&e.button!==0)return;t._start(e);break;case E:t._move(e);break;case S:case x:t._end(e);break;case b:t._resize();break;case T:t._wheel(e);break;case N:t._transitionEnd(e)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(e){var r=this,i;if(!r[e+"Scrollbar"]){r[e+"ScrollbarWrapper"]&&(g&&(r[e+"ScrollbarIndicator"].style[o]=""),r[e+"ScrollbarWrapper"].parentNode.removeChild(r[e+"ScrollbarWrapper"]),r[e+"ScrollbarWrapper"]=null,r[e+"ScrollbarIndicator"]=null);return}r[e+"ScrollbarWrapper"]||(i=t.createElement("div"),r.options.scrollbarClass?i.className=r.options.scrollbarClass+e.toUpperCase():i.style.cssText="position:absolute;z-index:100;"+(e=="h"?"height:7px;bottom:1px;left:2px;right:"+(r.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(r.hScrollbar?"7":"2")+"px;top:2px;right:1px"),i.style.cssText+=";pointer-events:none;"+s+"transition-property:opacity;"+s+"transition-duration:"+(r.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(r.options.hideScrollbar?"0":"1"),r.wrapper.appendChild(i),r[e+"ScrollbarWrapper"]=i,i=t.createElement("div"),r.options.scrollbarClass||(i.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+s+"background-clip:padding-box;"+s+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+s+"border-radius:3px;border-radius:3px"),i.style.cssText+=";pointer-events:none;"+s+"transition-property:"+s+"transform;"+s+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+s+"transition-duration:0;"+s+"transform: translate(0,0)"+L,r.options.useTransition&&(i.style.cssText+=";"+s+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),r[e+"ScrollbarWrapper"].appendChild(i),r[e+"ScrollbarIndicator"]=i),e=="h"?(r.hScrollbarSize=r.hScrollbarWrapper.clientWidth,r.hScrollbarIndicatorSize=n.max(n.round(r.hScrollbarSize*r.hScrollbarSize/r.scrollerW),8),r.hScrollbarIndicator.style.width=r.hScrollbarIndicatorSize+"px",r.hScrollbarMaxScroll=r.hScrollbarSize-r.hScrollbarIndicatorSize,r.hScrollbarProp=r.hScrollbarMaxScroll/r.maxScrollX):(r.vScrollbarSize=r.vScrollbarWrapper.clientHeight,r.vScrollbarIndicatorSize=n.max(n.round(r.vScrollbarSize*r.vScrollbarSize/r.scrollerH),8),r.vScrollbarIndicator.style.height=r.vScrollbarIndicatorSize+"px",r.vScrollbarMaxScroll=r.vScrollbarSize-r.vScrollbarIndicatorSize,r.vScrollbarProp=r.vScrollbarMaxScroll/r.maxScrollY),r._scrollbarPos(e,!0)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},h?200:0)},_pos:function(e,t){if(this.zoomed)return;e=this.hScroll?e:0,t=this.vScroll?t:0,this.options.useTransform?this.scroller.style[o]="translate("+e+"px,"+t+"px) scale("+this.scale+")"+L:(e=n.round(e),t=n.round(t),this.scroller.style.left=e+"px",this.scroller.style.top=t+"px"),this.x=e,this.y=t,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(e,t){var r=this,i=e=="h"?r.x:r.y,s;if(!r[e+"Scrollbar"])return;i=r[e+"ScrollbarProp"]*i,i<0?(r.options.fixedScrollbar||(s=r[e+"ScrollbarIndicatorSize"]+n.round(i*3),s<8&&(s=8),r[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px"),i=0):i>r[e+"ScrollbarMaxScroll"]&&(r.options.fixedScrollbar?i=r[e+"ScrollbarMaxScroll"]:(s=r[e+"ScrollbarIndicatorSize"]-n.round((i-r[e+"ScrollbarMaxScroll"])*3),s<8&&(s=8),r[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px",i=r[e+"ScrollbarMaxScroll"]+(r[e+"ScrollbarIndicatorSize"]-s))),r[e+"ScrollbarWrapper"].style[c]="0",r[e+"ScrollbarWrapper"].style.opacity=t&&r.options.hideScrollbar?"0":"1",r[e+"ScrollbarIndicator"].style[o]="translate("+(e=="h"?i+"px,0)":"0,"+i+"px)")+L},_start:function(t){var r=this,i=m?t.touches[0]:t,s,u,a,f,l;if(!r.enabled)return;r.options.onBeforeScrollStart&&r.options.onBeforeScrollStart.call(r,t),(r.options.useTransition||r.options.zoom)&&r._transitionTime(0),r.moved=!1,r.animating=!1,r.zoomed=!1,r.distX=0,r.distY=0,r.absDistX=0,r.absDistY=0,r.dirX=0,r.dirY=0,r.options.zoom&&m&&t.touches.length>1&&(f=n.abs(t.touches[0].pageX-t.touches[1].pageX),l=n.abs(t.touches[0].pageY-t.touches[1].pageY),r.touchesDistStart=n.sqrt(f*f+l*l),r.originX=n.abs(t.touches[0].pageX+t.touches[1].pageX-r.wrapperOffsetLeft*2)/2-r.x,r.originY=n.abs(t.touches[0].pageY+t.touches[1].pageY-r.wrapperOffsetTop*2)/2-r.y,r.options.onZoomStart&&r.options.onZoomStart.call(r,t));if(r.options.momentum){r.options.useTransform?(s=getComputedStyle(r.scroller,null)[o].replace(/[^0-9\-.,]/g,"").split(","),u=s[4]*1,a=s[5]*1):(u=getComputedStyle(r.scroller,null).left.replace(/[^0-9-]/g,"")*1,a=getComputedStyle(r.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(u!=r.x||a!=r.y)r.options.useTransition?r._unbind(N):k(r.aniTime),r.steps=[],r._pos(u,a)}r.absStartX=r.x,r.absStartY=r.y,r.startX=r.x,r.startY=r.y,r.pointX=i.pageX,r.pointY=i.pageY,r.startTime=t.timeStamp||Date.now(),r.options.onScrollStart&&r.options.onScrollStart.call(r,t),r._bind(E,e),r._bind(S,e),r._bind(x,e)},_move:function(e){var t=this,r=m?e.touches[0]:e,i=r.pageX-t.pointX,s=r.pageY-t.pointY,u=t.x+i,a=t.y+s,f,l,c,h=e.timeStamp||Date.now();t.options.onBeforeScrollMove&&t.options.onBeforeScrollMove.call(t,e);if(t.options.zoom&&m&&e.touches.length>1){f=n.abs(e.touches[0].pageX-e.touches[1].pageX),l=n.abs(e.touches[0].pageY-e.touches[1].pageY),t.touchesDist=n.sqrt(f*f+l*l),t.zoomed=!0,c=1/t.touchesDistStart*t.touchesDist*this.scale,c<t.options.zoomMin?c=.5*t.options.zoomMin*Math.pow(2,c/t.options.zoomMin):c>t.options.zoomMax&&(c=2*t.options.zoomMax*Math.pow(.5,t.options.zoomMax/c)),t.lastScale=c/this.scale,u=this.originX-this.originX*t.lastScale+this.x,a=this.originY-this.originY*t.lastScale+this.y,this.scroller.style[o]="translate("+u+"px,"+a+"px) scale("+c+")"+L,t.options.onZoom&&t.options.onZoom.call(t,e);return}t.pointX=r.pageX,t.pointY=r.pageY;if(u>0||u<t.maxScrollX)u=t.options.bounce?t.x+i/2:u>=0||t.maxScrollX>=0?0:t.maxScrollX;if(a>t.minScrollY||a<t.maxScrollY)a=t.options.bounce?t.y+s/2:a>=t.minScrollY||t.maxScrollY>=0?t.minScrollY:t.maxScrollY;t.distX+=i,t.distY+=s,t.absDistX=n.abs(t.distX),t.absDistY=n.abs(t.distY);if(t.absDistX<6&&t.absDistY<6)return;t.options.lockDirection&&(t.absDistX>t.absDistY+5?(a=t.y,s=0):t.absDistY>t.absDistX+5&&(u=t.x,i=0)),t.moved=!0,t._pos(u,a),t.dirX=i>0?-1:i<0?1:0,t.dirY=s>0?-1:s<0?1:0,h-t.startTime>300&&(t.startTime=h,t.startX=t.x,t.startY=t.y),t.options.onScrollMove&&t.options.onScrollMove.call(t,e)},_end:function(r){if(m&&r.touches.length!==0)return;var i=this,s=m?r.changedTouches[0]:r,u,f,l={dist:0,time:0},c={dist:0,time:0},h=(r.timeStamp||Date.now())-i.startTime,p=i.x,d=i.y,v,g,y,b,w;i._unbind(E,e),i._unbind(S,e),i._unbind(x,e),i.options.onBeforeScrollEnd&&i.options.onBeforeScrollEnd.call(i,r);if(i.zoomed){w=i.scale*i.lastScale,w=Math.max(i.options.zoomMin,w),w=Math.min(i.options.zoomMax,w),i.lastScale=w/i.scale,i.scale=w,i.x=i.originX-i.originX*i.lastScale+i.x,i.y=i.originY-i.originY*i.lastScale+i.y,i.scroller.style[a]="200ms",i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px) scale("+i.scale+")"+L,i.zoomed=!1,i.refresh(),i.options.onZoomEnd&&i.options.onZoomEnd.call(i,r);return}if(!i.moved){m&&(i.doubleTapTimer&&i.options.zoom?(clearTimeout(i.doubleTapTimer),i.doubleTapTimer=null,i.options.onZoomStart&&i.options.onZoomStart.call(i,r),i.zoom(i.pointX,i.pointY,i.scale==1?i.options.doubleTapZoom:1),i.options.onZoomEnd&&setTimeout(function(){i.options.onZoomEnd.call(i,r)},200)):this.options.handleClick&&(i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null,u=s.target;while(u.nodeType!=1)u=u.parentNode;u.tagName!="SELECT"&&u.tagName!="INPUT"&&u.tagName!="TEXTAREA"&&(f=t.createEvent("MouseEvents"),f.initMouseEvent("click",!0,!0,r.view,1,s.screenX,s.screenY,s.clientX,s.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,0,null),f._fake=!0,u.dispatchEvent(f))},i.options.zoom?250:0))),i._resetPos(400),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r);return}if(h<300&&i.options.momentum){l=p?i._momentum(p-i.startX,h,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):l,c=d?i._momentum(d-i.startY,h,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y-i.minScrollY:0,i.options.bounce?i.wrapperH:0):c,p=i.x+l.dist,d=i.y+c.dist;if(i.x>0&&p>0||i.x<i.maxScrollX&&p<i.maxScrollX)l={dist:0,time:0};if(i.y>i.minScrollY&&d>i.minScrollY||i.y<i.maxScrollY&&d<i.maxScrollY)c={dist:0,time:0}}if(l.dist||c.dist){y=n.max(n.max(l.time,c.time),10),i.options.snap&&(v=p-i.absStartX,g=d-i.absStartY,n.abs(v)<i.options.snapThreshold&&n.abs(g)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(p,d),p=b.x,d=b.y,y=n.max(b.time,y))),i.scrollTo(n.round(p),n.round(d),y),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r);return}if(i.options.snap){v=p-i.absStartX,g=d-i.absStartY,n.abs(v)<i.options.snapThreshold&&n.abs(g)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(i.x,i.y),(b.x!=i.x||b.y!=i.y)&&i.scrollTo(b.x,b.y,b.time)),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r);return}i._resetPos(200),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r)},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=t.minScrollY||t.maxScrollY>0?t.minScrollY:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){t.moved&&(t.moved=!1,t.options.onScrollEnd&&t.options.onScrollEnd.call(t)),t.hScrollbar&&t.options.hideScrollbar&&(i=="webkit"&&(t.hScrollbarWrapper.style[c]="300ms"),t.hScrollbarWrapper.style.opacity="0"),t.vScrollbar&&t.options.hideScrollbar&&(i=="webkit"&&(t.vScrollbarWrapper.style[c]="300ms"),t.vScrollbarWrapper.style.opacity="0");return}t.scrollTo(n,r,e||0)},_wheel:function(e){var t=this,n,r,i,s,o;if("wheelDeltaX"in e)n=e.wheelDeltaX/12,r=e.wheelDeltaY/12;else if("wheelDelta"in e)n=r=e.wheelDelta/12;else{if(!("detail"in e))return;n=r=-e.detail*3}if(t.options.wheelAction=="zoom"){o=t.scale*Math.pow(2,1/3*(r?r/Math.abs(r):0)),o<t.options.zoomMin&&(o=t.options.zoomMin),o>t.options.zoomMax&&(o=t.options.zoomMax),o!=t.scale&&(!t.wheelZoomCount&&t.options.onZoomStart&&t.options.onZoomStart.call(t,e),t.wheelZoomCount++,t.zoom(e.pageX,e.pageY,o,400),setTimeout(function(){t.wheelZoomCount--,!t.wheelZoomCount&&t.options.onZoomEnd&&t.options.onZoomEnd.call(t,e)},400));return}i=t.x+n,s=t.y+r,i>0?i=0:i<t.maxScrollX&&(i=t.maxScrollX),s>t.minScrollY?s=t.minScrollY:s<t.maxScrollY&&(s=t.maxScrollY),t.maxScrollY<0&&t.scrollTo(i,s,0)},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller)return;t._unbind(N),t._startAni()},_startAni:function(){var e=this,t=e.x,r=e.y,i=Date.now(),s,o,u;if(e.animating)return;if(!e.steps.length){e._resetPos(400);return}s=e.steps.shift(),s.x==t&&s.y==r&&(s.time=0),e.animating=!0,e.moved=!0;if(e.options.useTransition){e._transitionTime(s.time),e._pos(s.x,s.y),e.animating=!1,s.time?e._bind(N):e._resetPos(0);return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){e._pos(s.x,s.y),e.animating=!1,e.options.onAnimationEnd&&e.options.onAnimationEnd.call(e),e._startAni();return}a=(a-i)/s.time-1,o=n.sqrt(1-a*a),f=(s.x-t)*o+t,l=(s.y-r)*o+r,e._pos(f,l),e.animating&&(e.aniTime=C(u))},u()},_transitionTime:function(e){e+="ms",this.scroller.style[a]=e,this.hScrollbar&&(this.hScrollbarIndicator.style[a]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[a]=e)},_momentum:function(e,t,r,i,s){var o=6e-4,u=n.abs(e)/t,a=u*u/(2*o),f=0,l=0;return e>0&&a>r?(l=s/(6/(a/u*o)),r+=l,u=u*r/a,a=r):e<0&&a>i&&(l=s/(6/(a/u*o)),i+=l,u=u*i/a,a=i),a*=e<0?-1:1,f=u/o,{dist:a,time:n.round(f)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent)t-=e.offsetLeft,n-=e.offsetTop;return e!=this.wrapper&&(t*=this.scale,n*=this.scale),{left:t,top:n}},_snap:function(e,t){var r=this,i,s,o,u,a,f;o=r.pagesX.length-1;for(i=0,s=r.pagesX.length;i<s;i++)if(e>=r.pagesX[i]){o=i;break}o==r.currPageX&&o>0&&r.dirX<0&&o--,e=r.pagesX[o],a=n.abs(e-r.pagesX[r.currPageX]),a=a?n.abs(r.x-e)/a*500:0,r.currPageX=o,o=r.pagesY.length-1;for(i=0;i<o;i++)if(t>=r.pagesY[i]){o=i;break}return o==r.currPageY&&o>0&&r.dirY<0&&o--,t=r.pagesY[o],f=n.abs(t-r.pagesY[r.currPageY]),f=f?n.abs(r.y-t)/f*500:0,r.currPageY=o,u=n.round(n.max(a,f))||200,{x:e,y:t,time:u}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var t=this;t.scroller.style[o]="",t.hScrollbar=!1,t.vScrollbar=!1,t._scrollbar("h"),t._scrollbar("v"),t._unbind(b,e),t._unbind(w),t._unbind(E,e),t._unbind(S,e),t._unbind(x,e),t.options.hasTouch||t._unbind(T),t.options.useTransition&&t._unbind(N),t.options.checkDOMChanges&&clearInterval(t.checkDOMTime),t.options.onDestroy&&t.options.onDestroy.call(t)},refresh:function(){var e=this,t,r,i,s,o=0,u=0;e.scale<e.options.zoomMin&&(e.scale=e.options.zoomMin),e.wrapperW=e.wrapper.clientWidth||1,e.wrapperH=e.wrapper.clientHeight||1,e.minScrollY=-e.options.topOffset||0,e.scrollerW=n.round(e.scroller.offsetWidth*e.scale),e.scrollerH=n.round((e.scroller.offsetHeight+e.minScrollY)*e.scale),e.maxScrollX=e.wrapperW-e.scrollerW,e.maxScrollY=e.wrapperH-e.scrollerH+e.minScrollY,e.dirX=0,e.dirY=0,e.options.onRefresh&&e.options.onRefresh.call(e),e.hScroll=e.options.hScroll&&e.maxScrollX<0,e.vScroll=e.options.vScroll&&(!e.options.bounceLock&&!e.hScroll||e.scrollerH>e.wrapperH),e.hScrollbar=e.hScroll&&e.options.hScrollbar,e.vScrollbar=e.vScroll&&e.options.vScrollbar&&e.scrollerH>e.wrapperH,t=e._offset(e.wrapper),e.wrapperOffsetLeft=-t.left,e.wrapperOffsetTop=-t.top;if(typeof e.options.snap=="string"){e.pagesX=[],e.pagesY=[],s=e.scroller.querySelectorAll(e.options.snap);for(r=0,i=s.length;r<i;r++)o=e._offset(s[r]),o.left+=e.wrapperOffsetLeft,o.top+=e.wrapperOffsetTop,e.pagesX[r]=o.left<e.maxScrollX?e.maxScrollX:o.left*e.scale,e.pagesY[r]=o.top<e.maxScrollY?e.maxScrollY:o.top*e.scale}else if(e.options.snap){e.pagesX=[];while(o>=e.maxScrollX)e.pagesX[u]=o,o-=e.wrapperW,u++;e.maxScrollX%e.wrapperW&&(e.pagesX[e.pagesX.length]=e.maxScrollX-e.pagesX[e.pagesX.length-1]+e.pagesX[e.pagesX.length-1]),o=0,u=0,e.pagesY=[];while(o>=e.maxScrollY)e.pagesY[u]=o,o-=e.wrapperH,u++;e.maxScrollY%e.wrapperH&&(e.pagesY[e.pagesY.length]=e.maxScrollY-e.pagesY[e.pagesY.length-1]+e.pagesY[e.pagesY.length-1])}e._scrollbar("h"),e._scrollbar("v"),e.zoomed||(e.scroller.style[a]="0",e._resetPos(400))},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop(),s.length||(s=[{x:e,y:t,time:n,relative:r}]);for(o=0,u=s.length;o<u;o++)s[o].relative&&(s[o].x=i.x-s[o].x,s[o].y=i.y-s[o].y),i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0});i._startAni()},scrollToElement:function(e,t){var r=this,i;e=e.nodeType?e:r.scroller.querySelector(e);if(!e)return;i=r._offset(e),i.left+=r.wrapperOffsetLeft,i.top+=r.wrapperOffsetTop,i.left=i.left>0?0:i.left<r.maxScrollX?r.maxScrollX:i.left,i.top=i.top>r.minScrollY?r.minScrollY:i.top<r.maxScrollY?r.maxScrollY:i.top,t=t===undefined?n.max(n.abs(i.left)*2,n.abs(i.top)*2):t,r.scrollTo(i.left,i.top,t)},scrollToPage:function(e,t,n){var r=this,i,s;n=n===undefined?400:n,r.options.onScrollStart&&r.options.onScrollStart.call(r),r.options.snap?(e=e=="next"?r.currPageX+1:e=="prev"?r.currPageX-1:e,t=t=="next"?r.currPageY+1:t=="prev"?r.currPageY-1:t,e=e<0?0:e>r.pagesX.length-1?r.pagesX.length-1:e,t=t<0?0:t>r.pagesY.length-1?r.pagesY.length-1:t,r.currPageX=e,r.currPageY=t,i=r.pagesX[e],s=r.pagesY[t]):(i=-r.wrapperW*e,s=-r.wrapperH*t,i<r.maxScrollX&&(i=r.maxScrollX),s<r.maxScrollY&&(s=r.maxScrollY)),r.scrollTo(i,s,n)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(E,e),this._unbind(S,e),this._unbind(x,e)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(N):k(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,t,n,r){var i=this,s=n/i.scale;if(!i.options.useTransform)return;i.zoomed=!0,r=r===undefined?200:r,e=e-i.wrapperOffsetLeft-i.x,t=t-i.wrapperOffsetTop-i.y,i.x=e-e*s+i.x,i.y=t-t*s+i.y,i.scale=n,i.refresh(),i.x=i.x>0?0:i.x<i.maxScrollX?i.maxScrollX:i.x,i.y=i.y>i.minScrollY?i.minScrollY:i.y<i.maxScrollY?i.maxScrollY:i.y,i.scroller.style[a]=r+"ms",i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px) scale("+n+")"+L,i.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},r=null,typeof exports!="undefined"?exports.iScroll=A:e.iScroll=A}(window,document),define("iscroll",["iscroll/src/iscroll"],function(e){return e}),define("iscroll/src/iscroll",function(e){return function(){var t,n;return t||e.iScroll}}(this)),define("text!templates/default.html",[],function(){return'  <header><div class="title">股票123</div><div id="loadBox" class="buttonBox buttonR1 loadbutton"><span class="icon-refresh" title="刷新"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="刷新" /></div></header>\n  <article class="content">\n	<div class="scrollview">\n	<div class="c_scroller sec_line">\n		<section class="home_price">\n		  <div class="l">\n		  <p class="name">股市气象</p><p class="pic_weather" id="homeWeather"></p>\n		  </div>\n		  <div class="r">\n		  <p class="value" id="homeIndex"></p>\n		  <p class="canvasp"><canvas id="canvasHome" class="canvashome" width="410" height="180"></canvas></p>\n		  </div>\n		</section>\n		<section class="home_news">\n		  <ul id="home_list" class="list_news">\n			<li></li>\n			<li></li>\n		  </ul>\n		</section>\n		<section>\n			<ul id="default_list" class="home_mystock fontEnB">\n			</ul>\n		</section>\n	</div>\n	</div>\n  </article>\n'}),define("tools/autoScale",[],function(){var e={"260px":{},"560px":{}},t=0,n=function(e){var t=e.replace(/[^\x00-\xff]+/g,"");return(e.length-t.length)*2+t.length},r=function(t,r){var i=parseInt(t.next().css("height"),10),s=parseInt(t.parent().css("height"),10),o=o||s-i-4,u=parseInt(t.css("font-size"),10),a=t.css("width"),f=n(t.text()),l=t.get(0);r&&e[a]&&e[a][f]&&(u=e[a][f],l.style.fontSize=u+"px");while(l.scrollHeight>o)l.style.fontSize=--u+"px";r&&e[a]&&(e[a][f]=u)};return r}),define("tools/api",["jquery","underscore"],function(e,t){var n=window.apiServer||"/api/",r=function(t,r,i){var r=r||"",i=i||0,s="Cached."+r,o=function(r,s,o){e.ajax({url:n+t+s,dataType:"json",success:function(e){i>0&&(localStorage[r]=JSON.stringify({updated:Date.now(),data:e})),o(e)}})};return function(e,t){var n=s;t===undefined&&typeof e=="function"?(t=e,e=""):n+="."+e;if(localStorage[n])try{var r=JSON.parse(localStorage[n]);Date.now()-r.updated<i*1e3?t(r.data):o(n,e,t)}catch(u){console.log(u),o(n,e,t)}else o(n,e,t)}},i=function(r,i,s){var o={updated:0,data:{}};if(localStorage[r])try{o=JSON.parse(localStorage[r])}catch(u){}e.ajax({url:n+i+"?cached="+o.updated,dataType:"json",success:function(e){t.extend(o.data,e),localStorage[r]=JSON.stringify({updated:Date.now(),data:o.data}),s(o.data)}})},s={loadSecurities:r("Securities/","securities",21600),loadHotSearch:r("hotSearch","hotSearch",3600),loadSecurity:r("Security/","Security",30),loadSecuritiesWithoutCache:r("Securities/"),loadNewsContent:r("News/"),loadFocusImageNews:r("FocusImageNews/"),loadNews:r("News"),loadHomePage:r("init"),loadMarket:r("Market/News"),loadSecurities2:function(e){var t="Securities2/",n="Securities";i(n,t,e)}};return s}),define("lib/canvasUtils",[],function(){var e=function(){};return e.formatNumber=function(e,t,n){var r="",i="",s=!0;return n===undefined?s=!0:s=n,undefined===t&&(t=0),Math.abs(e)>1e7?(r="亿",i=e/1e8):Math.abs(e)>1e3?(i=e/1e4,r="万"):i=e,t==0?i=Math.round(i):t==1?i=Math.round(i*10)/10:t==2?i=Math.round(i*100)/100:t==3?i=Math.round(i*1e3)/1e3:t==4?i=Math.round(i*1e4)/1e4:i=Math.round(i),i=i.toFixed(t),s&&(i+=r),i},e.numberFixTo=function(e,t){var n=e,r=t;return n>100&&(r=0),t==0?n=Math.round(n):r==1?n=Math.round(n*10)/10:r==2?n=Math.round(n*100)/100:r==3?n=Math.round(n*1e3)/1e3:r==4?n=Math.round(n*1e4)/1e4:n=Math.round(n),n.toFixed(r)},e.brokenLineTo=function(e,t,n,r,i,s,o){e.moveTo(t,n);var u=t,a=n,f=!1,l=s;if(n==i){f=!1,l=s;while(u!=r)f?l=o:l=s,u<r?u=Math.min(u+l,r):u=Math.max(u-l,r),f?e.moveTo(u,a):e.lineTo(u,a),f=!f}if(t==r){f=!1,l=s;while(a!=i)f?l=o:l=s,a<i?a=Math.min(a+l,i):a=Math.max(a-l,i),f?e.moveTo(u,a):e.lineTo(u,a),f=!f}},e.drawRelativeHorizontalLine=function(e,t,n,r,i,s,o){var u,a,f=s.length,l=0;a=r-(s[0]-i)*o,e.moveTo(t,a);for(l=1;l<f;l++)u=l*n+t,a=r-(s[l]-i)*o,e.lineTo(u,a)},e.brgba=function(e,t){var n=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);return"rgba("+n+","+r+","+i+","+t+")"},e.getDateString=function(e){if(!e)return"";var t=new Date(e*1e3),n="second",r="",i=function(e){return e<10?"0"+e:e};return t.getFullYear()<1e3?n="minute":t.getHours()==0&&t.getMinutes()==0&&(n="day"),n=="day"?r=[t.getFullYear(),i(t.getMonth()+1),i(t.getDate())].join("-"):n=="minute"?r=[i(t.getMonth()+1),i(t.getDate())].join("-")+" "+[i(t.getHours()),i(t.getMinutes())].join(":"):r=[t.getFullYear(),i(t.getMonth()+1),i(t.getDate())].join("-")+" "+[i(t.getHours()),i(t.getMinutes()),i(t.getSeconds())].join(":"),r},e}),define("etc/chartSettings/mline_default",{settingsName:"default",imageWidth:640,imageHeight:660,bgLineDisplay:!0,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:2,bgInnerLineIntervalWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:10,topStockDisplay:!1,topStockPos:"left",topStockFontName:"Helvetica",topStockFontSize:16,topStockFontColor:"#000000",topQuotationsDisplay:!1,topQuotationsFontName:"Helvetica",topQuotationsFontSize:16,topQuotationsFontColor:"#000000",topQuotationsFontColorUp:"#000000",topQuotationsFontColorDown:"#000000",leftCoordsDisplay:!0,leftSpaceWidth:80,leftCoordinateFontName:"Helvetica",leftCoordinateFontSize:16,leftCoordinateFontColor:"#000000",leftCoordinateFontColorUp:"#FF0000",leftCoordinateFontColorDown:"#00FF00",mlinePriceRatio:1.1,rightSpaceWidth:14,stockFundsFlowDisplay:!0,rightYFontName:"Helvetica",rightYFontSize:16,rightYFontColor:"#000000",rightYFontColorUp:"#C90116",rightYFontColorDown:"#008D00",fundsFlowLineWidth:1,fundsFlowLineColorUp:"#C90116",fundsFlowLineColorDown:"#008D00",fundsStyle:"fill",fundsFillOpacity:1,middleTimeDisplay:!0,middleSpaceHeight:40,middleTimePos:"right",middleFontName:"Helvetica",middleFontSize:16,middleFontColor:"#000000",volumeAreaDisplay:!0,volumeAreaHeight:98,volumeLineWidth:2,volumeLineColor:"#D6D6D6",bottomCoordsDisplay:!0,bottomFontName:"Helvetica",bottomFontSize:16,bottomFontColor:"#000000",bottomSpaceHeight:20,markHighPrice:!0,markLowPrice:!0,mLineStyle:"line",mLineFillColor:"#DDF6FF",mLineWidth:2,mLineColor:"#2869D8",avgLineDisplay:!0,avgLineWidht:2,avgLineColor:"#000000",coordsToBox:5}),define("lib/mline",["lib/canvasUtils","etc/chartSettings/mline_default"],function(e,t){function n(t,n,r){var i=0,s=0,o=0,u=0,a=0,f=0,l=0,c={};return n.topStockDisplay&&(o=n.topStockFontSize*1.1),n.topQuotationsDisplay&&(o=Math.max(o,n.topQuotationsFontSize*1)),n.volumeAreaDisplay&&(u=n.bottomFontSize*1.1),n.stockFundsFlowDisplay&&r.absMaxFunds>0&&(t.font=n.rightYFontSize+'px "'+n.rightYFontName+'"',n.leftCoordsDisplay&&(a=e.formatNumber(-r.absMaxFunds,1),i=t.measureText(a).width+n.coordsToBox)),n.leftCoordsDisplay&&(l=r.closePrice+r.priceDistance,t.font=n.leftCoordinateFontSize+'px "'+n.leftCoordinateFontName+'"',f=t.measureText(e.numberFixTo(l,2)).width,f=Math.max(f,t.measureText(e.formatNumber(r.maxVolume,1)).width)),c.mlineX1=Math.max(n.leftSpaceWidth,f+n.coordsToBox),c.mlineY1=Math.max(n.topSpaceHeight,o),c.mlineX2=n.imageWidth-Math.max(n.rightSpaceWidth,i),n.volumeAreaDisplay?(c.mlineY2=n.imageHeight-n.bottomSpaceHeight-n.volumeAreaHeight-n.middleSpaceHeight,c.volumeX1=c.mlineX1,c.volumeY1=n.imageHeight-n.bottomSpaceHeight-n.volumeAreaHeight,c.volumeX2=c.mlineX2,c.volumeY2=n.imageHeight-Math.max(n.bottomSpaceHeight,u)):c.mlineY2=n.imageHeight-n.bottomSpaceHeight,c}function r(t,n,r,i){var s=r.mlineX2-r.mlineX1,o=r.mlineY2-r.mlineY1,u=r.mlineX1,a=r.volumeY2||r.mlineY2,f="11:30/13:00",l="15:00";t.linCap="butt",t.beginPath(),t.lineWidth=n.bgOuterLineWidth,t.strokeStyle=n.bgOuterLineColor,t.rect(r.mlineX1,r.mlineY1,s,o),n.bgColor&&(t.save(),t.fillStyle=n.bgColor,t.fillRect(0,0,n.imageWidth,n.imageHeight),t.restore()),n.volumeAreaDisplay&&(t.lineWidth=n.bgOuterLineWidth,t.strokeStyle=n.bgOuterLineColor,t.rect(r.volumeX1,r.volumeY1,r.volumeX2-r.volumeX1,r.volumeY2-r.volumeY1)),t.stroke(),t.lineWidth=n.bgInnerLineWidth,t.strokeStyle=n.bgInnerLineColor,t.moveTo(r.mlineX1,r.mlineY1+o/2),t.lineTo(r.mlineX2,r.mlineY1+o/2),e.brokenLineTo(t,r.mlineX1,r.mlineY1+o/4,r.mlineX2,r.mlineY1+o/4,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth),e.brokenLineTo(t,r.mlineX1,r.mlineY1+o*3/4,r.mlineX2,r.mlineY1+o*3/4,n.bgInnerLineWidth,n.bgInnerLineIntervalWidth),e.brokenLineTo(t,r.mlineX1+s/4,r.mlineY1,r.mlineX1+s/4,r.mlineY2,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth),e.brokenLineTo(t,r.mlineX1+s/2,r.mlineY1,r.mlineX1+s/2,r.mlineY2,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth),e.brokenLineTo(t,r.mlineX1+s*3/4,r.mlineY1,r.mlineX1+s*3/4,r.mlineY2,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth),n.volumeAreaDisplay&&(t.strokeStyle=n.bgInnerLineColor,t.lineWidth=n.bgInnerLineWidth,e.brokenLineTo(t,r.volumeX1+s/4,r.volumeY1,r.mlineX1+s/4,r.volumeY2,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth),e.brokenLineTo(t,r.volumeX1+s/2,r.volumeY1,r.mlineX1+s/2,r.volumeY2,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth),e.brokenLineTo(t,r.volumeX1+s*3/4,r.volumeY1,r.mlineX1+s*3/4,r.volumeY2,n.bgInnerLineIntervalWidth,n.bgInnerLineIntervalWidth)),t.stroke(),n.bottomCoordsDisplay&&(t.textAlign="left",t.font=n.bottomFontSize+'px "'+n.bottomFontName+'"',t.fillStyle=n.bottomFontColor,t.fillText("09:30",u,a+n.bottomFontSize),t.textAlign="center",i.marketType==="HK"&&(f="12:00/13:00",l="16:00"),t.fillText(f,u+s/2,a+n.bottomFontSize),t.textAlign="right",t.fillText(l,u+s,a+n.bottomFontSize))}function i(t,n,r,i){var s=0,o=i.mlineX2-i.mlineX1,u=i.mlineY2-i.mlineY1,a=0,f=0,l=0,c="",h,p=u/2/n.priceDistance,d=o/n.minutesCount,v=[n.openPrice].concat(n.priceList);if(r.mLineStyle!="fill")t.beginPath(),e.drawRelativeHorizontalLine(t,i.mlineX1,d,i.mlineY1+u/2,n.closePrice,v,p),t.strokeStyle=r.mLineColor,t.lineWidth=r.mLineWidth,t.stroke();else{t.beginPath();var m=Math.max(n.closePrice,n.maxPrice),g=Math.min(n.closePrice,n.minPrice),y=(m+g)/2,b=(m-y)*r.mlinePriceRatio,w=!1,E=!1,S=0,x=0,T=0,N=0;b=Math.max(.02,b),p=u/2/b,e.drawRelativeHorizontalLine(t,i.mlineX1,d,i.mlineY1+u/2,y,v,p);for(s=1;s<v.length;s++)r.markHighPrice&&v[s]==n.maxPrice&&!w&&(w=!0,T=s*d+i.mlineX1,N=i.mlineY1+u/2-(v[s]-y)*p),r.markLowPrice&&v[s]==n.minPrice&&!E&&(E=!0,S=s*d+i.mlineX1,x=i.mlineY1+u/2-(v[s]-y)*p);t.lineTo((v.length-1)*d+i.mlineX1,i.mlineY2),t.lineTo(i.mlineX1,i.mlineY2),t.strokeStyle=r.mLineFillColor,t.fillStyle=r.mLineFillColor,t.lineWidth=r.mLineWidth,t.closePath(),t.fill(),t.beginPath(),t.strokeStyle=r.mLineColor,t.lineWidth=r.mLineWidth,e.drawRelativeHorizontalLine(t,i.mlineX1,d,i.mlineY1+u/2,y,v,p),S&&x&&T&&N&&T!=S&&(t.moveTo(S,x+r.markRadius),t.arc(S,x,r.markRadius,0,2*Math.PI,!1),t.moveTo(T,N+r.markRadius),t.arc(T,N,r.markRadius,0,2*Math.PI,!1)),t.stroke()}r.avgLineDisplay&&n.avgPriceList&&n.avgPriceList.length>0&&(t.beginPath(),e.drawRelativeHorizontalLine(t,i.mlineX1+d,d,i.mlineY1+u/2,n.closePrice,n.avgPriceList,p),t.strokeStyle=r.avgLineColor,t.lineWidth=r.avgLineWidht,t.stroke()),r.topStockDisplay&&(t.font=r.topStockFontSize+'px "'+r.topStockFontName+'"',t.patternQuality="best",t.fillStyle=r.topStockFontColor,c=n.stockName+"["+n.stockCode+"]",t.fillText(c,i.mlineX1,i.mlineY1-8)),r.leftCoordsDisplay&&(a=n.closePrice+n.priceDistance,f=n.closePrice-n.priceDistance,t.font=r.leftCoordinateFontSize+'px "'+r.leftCoordinateFontName+'"',t.textAlign="right",t.fillStyle=r.leftCoordinateFontColorUp,l=r.coordsToBox,t.fillText(e.numberFixTo(a,2),i.mlineX1-l,i.mlineY1+l),t.fillText(e.numberFixTo(n.closePrice+n.priceDistance/2,2),i.mlineX1-l,i.mlineY1+u/4+l),t.fillStyle=r.rightYFontColor,t.fillText(e.numberFixTo(n.closePrice,2),i.mlineX1-l,i.mlineY1+u/2+l),t.fillStyle=r.rightYFontColorDown,t.fillText(e.numberFixTo(n.closePrice-n.priceDistance/2,2),i.mlineX1-l,i.mlineY1+u*3/4+l),t.fillText(e.numberFixTo(f,2),i.mlineX1-l,i.mlineY2+l)),r.middleTimeDisplay==1&&(h=r.dateTimeFormatter(n.dataTimeStamp),t.font=r.middleFontSize+'px "'+r.middleFontName+'"',t.fillStyle=r.middleFontColor,t.fillText(h,i.mlineX2,i.mlineY2+r.middleSpaceHeight/2+r.middleFontSize/2))}function s(t,n,r,i){t.beginPath();var s=n.volumeList,o=i.volumeY2-i.volumeY1,u=0,a=0,f=0,l=i.mlineX2-i.mlineX1,c=0,h=0,p="";for(c=0,h=s.length;c<h;c++)u=(c+1)*(l/n.minutesCount)+i.mlineX1,f=o*(s[c]/n.maxVolume),a=i.volumeY2-f,t.moveTo(u,i.volumeY2),t.lineTo(u,a);t.strokeStyle=r.volumeLineColor,t.lineWidth=r.volumeLineWidth,t.stroke(),t.font=r.leftCoordinateFontSize+'px "'+r.leftCoordinateFontName+'"',t.fillStyle=r.leftCoordinateFontColorUp,p=e.formatNumber(n.maxVolume,1),t.fillText(p,i.mlineX1-r.coordsToBox,i.volumeY1+r.leftCoordinateFontSize/2),t.fillStyle=r.leftCoordinateFontColor,t.fillText("0",i.mlineX1-r.coordsToBox,i.volumeY2+r.leftCoordinateFontSize/2)}function o(t,n,r,i){var s=0,o=i.mlineX2-i.mlineX1,u=i.mlineY2-i.mlineY1,a=u/4,f=n.fundsList,l=n.absMaxFunds,c=i.mlineY1+u/2,h=f.length,p=0,d=0;t.lineWidth=r.fundsFlowLineWidth;for(s=0;s<h;s++)t.beginPath(),p=(s+1)*(o/n.minutesCount)+i.mlineX1,d=c-a*(f[s]/l),t.moveTo(p,c),d>c?t.strokeStyle=r.fundsFlowLineColorDown:t.strokeStyle=r.fundsFlowLineColorUp,t.lineTo(p,d),t.stroke();t.textAlign="left",t.font=r.rightYFontSize+'px "'+r.rightYFontName+'"',t.fillStyle=r.rightYFontColor,t.fillText("净流",i.mlineX2+r.coordsToBox,+i.mlineY1+r.rightYFontSize/2),t.fillText(0,i.mlineX2+r.coordsToBox,+c+r.rightYFontSize/2),t.fillStyle=r.rightYFontColorUp,t.fillText(e.formatNumber(l,1),i.mlineX2+r.coordsToBox,+c-a+r.rightYFontSize/2),t.fillStyle=r.rightYFontColorDown,t.fillText(e.formatNumber(-l,1),i.mlineX2+r.coordsToBox,+c+a+r.rightYFontSize/2)}function u(e,t){return Math.abs(e+t)==Math.abs(e)+Math.abs(t)}function a(t,n,r,i){var s=0,o=i.mlineX2-i.mlineX1,a=i.mlineY2-i.mlineY1,f=a/4,l=n.fundsList,c=n.absMaxFunds,h=i.mlineY1+a/2,p=l.length,d=0,v=0,m=!0;t.lineWidth=r.fundsFlowLineWidth,l[p-1]!=undefined&&l[p-1]==0&&p>1&&p--;for(s=0;s<p;s++)d=(s+1)*(o/n.minutesCount)+i.mlineX1,v=h-f*(l[s]/c),s==0?v<=h?t.fillStyle=e.brgba(r.fundsFlowLineColorUp,r.fundsFillOpacity):t.fillStyle=e.brgba(r.fundsFlowLineColorDown,r.fundsFillOpacity):h-f*(l[s-1]/c)<=h?t.fillStyle=e.brgba(r.fundsFlowLineColorUp,r.fundsFillOpacity):t.fillStyle=e.brgba(r.fundsFlowLineColorDown,r.fundsFillOpacity),m&&(v<=h?t.strokeStyle=r.fundsFlowLineColorUp:t.strokeStyle=r.fundsFlowLineColorDown,t.beginPath(),t.moveTo(d,h),m=!1),s==p-1?(t.lineTo(d,v),t.lineTo(d,h),t.fill()):u(l[s],l[s+1])?t.lineTo(d,v):(m=!0,t.lineTo(d,h),t.fill());t.textAlign="left",t.font=r.rightYFontSize+'px "'+r.rightYFontName+'"',t.fillStyle=r.rightYFontColor,t.fillText("净流",i.mlineX2+r.coordsToBox,+i.mlineY1+r.rightYFontSize/2),t.font=r.rightYFontSize+'px "'+r.rightYFontName+'"',t.fillText(0,i.mlineX2+r.coordsToBox,+h+r.rightYFontSize/2),t.fillStyle=r.rightYFontColorUp,t.fillText(e.formatNumber(c,1,!0),i.mlineX2+r.coordsToBox,+h-f+r.rightYFontSize/2),t.fillStyle=r.rightYFontColorDown,t.fillText(e.formatNumber(-c,1,!0),i.mlineX2+r.coordsToBox,+h+f+r.rightYFontSize/2)}function f(e,t){var n={},r;for(r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n}function l(e,t){var n={fundsList:[],absMaxFunds:0,volumeList:[],maxVolume:0,openPrice:0,closePrice:0,priceList:[],maxPrice:0,minPrice:0,avgPriceList:0,marketType:"SH",minutesCount:240,priceDistance:0,stockCode:"",stockName:"",dataTimeStamp:0},r=0,i;for(i in e)n[i]=e[i];n.marketType=="HK"?n.minutesCount=330:n.minutesCount=240,n.maxPrice=0,n.minPrice=n.closePrice;for(r=0;r<n.priceList.length;r++)n.maxPrice=Math.max(n.maxPrice,n.priceList[r]),n.minPrice=Math.min(n.minPrice,n.priceList[r]);n.maxVolume=0;if(t.volumeAreaDisplay&&n.volumeList)for(r=0;r<n.volumeList.length;r++)n.maxVolume=Math.max(n.volumeList[r],n.maxVolume);n.absMaxFunds=0;if(t.stockFundsFlowDisplay&&n.fundsList)for(r=0;r<n.fundsList.length;r++)n.absMaxFunds=Math.max(Math.abs(n.fundsList[r]),n.absMaxFunds);return n.priceDistance=Math.max(Math.abs(n.closePrice-n.minPrice),Math.abs(n.closePrice-n.maxPrice)),n.priceDistance*=t.mlinePriceRatio,n.closePrice==0&&n.openPrice==0&&n.priceDistance==0&&n.priceList.length==0?n.priceDistance=0:n.priceDistance=Math.max(.02,n.priceDistance),n.openPrice==0&&(n.openPrice=n.closePrice),n}function c(u,c,h){var p=f(t,h),d=l(c,p),v=n(u,p,d);p.dateTimeFormatter===undefined&&(p.dateTimeFormatter=function(t){return e.getDateString(t)}),u.save(),u.patternQuality="best",u.clearRect(0,0,p.imageWidth,p.imageHeight),p.bgLineDisplay&&r(u,p,v,d),p.stockFundsFlowDisplay&&d.absMaxFunds>0&&(p.fundsStyle=="fill"?a(u,d,p,v):o(u,d,p,v)),i(u,d,p,v),p.volumeAreaDisplay&&d.maxVolume>0&&s(u,d,p,v),u.restore()}return c}),define("etc/chartSettings/kline_default",{imageWidth:640,imageHeight:660,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:10,topStockDisplay:!0,topStockPos:"left",topStockFontName:"Helvetica",topStockFontSize:"16",topStockFontColor:"#000000",KLineDescDisplay:!0,KlineDescPos:"top",KLineDescDescAlign:"right",KLineDescFontName:"Helvetica",KLineDescFontSize:16,KLineDescMA5FontColor:"#666666",KLineDescMA10FontColor:"#2968DA",KLineDescMA30FontColor:"#E548C6",avgLineWidht:2,spaceWidthBetween2Kline:4,kLineColorUp:"#C90116",kLineColorDown:"#008D00",kLineColor:"#A6A6A6",kLineMinHeight:1,kLineWidth:2,minKLineCount:30,kLinePriceRatio:1.1,leftSpaceWidth:80,leftPriceFontName:"Helvetica",leftPriceFontSize:16,leftPriceFontColor:"#C90116",leftPriceFontColorUp:"#C90116",leftPriceFontColorDown:"#C90116",rightSpaceWidth:14,fundsFlowDisplay:!0,fundsFlowAreaHeight:98,topFundsFlowText:"资金流向 净流: ",topFundsFlowFontName:"Helvetica",topFundsFlowFontSize:20,topFundsFlowFontColor:"#000000",leftFundsFlowFontName:"Helvetica",leftFundsFlowFontSize:16,leftFundsFlowFontColor:"#000000",leftFundsFlowFontColorUp:"#C90116",leftFundsFlowFontColorDown:"#008D00",fundsFlowUpColor:"#C90116",fundsFlowDownColor:"#008D00",fundsFlowRatio:1.05,volumeDisplay:!0,volumeAreaHeight:98,topVolumeTextDisplay:!0,topVolumeText:"成 交 量  总手: ",topVolumeFontName:"Helvetica",topVolumeFontSize:20,topVolumeFontColor:"#000000",leftVolumeFontName:"Helvetica",leftVolumeFontSize:16,leftVolumeFontColor:"#000000",volumeUpColor:"#C90116",volumeDownColor:"#008D00",volumeRatio:1.1,dateTimePos:"bottom",dateTimeFontName:"Helvetica",dateTimeFontSize:16,dateTimeFontColor:"#000000",bottomSpaceHeight:20,spaceHeightBetween2Area:40,coordsToBox:5,scaleRatio:1}),define("lib/kline",["lib/canvasUtils","etc/chartSettings/kline_default"],function(e,t){function n(t,n,r){var i=0,s=0,o=0,u="",a=0,f={klineX1:0,klineY1:0,klineX2:0,klineY2:0,volumeX1:0,volumeY1:0,volumeX2:0,volumeY2:0,fundsFlowX1:0,fundsFlowY1:0,fundsFlowX2:0,fundsFlowY2:0};return o=n.dateTimeFontSize*1.1,o=Math.max(n.bottomSpaceHeight,o),s=n.KLineDescFontSize*1.1,s=Math.max(n.topSpaceHeight,s),n.fundsFlowDisplay&&r.maxAbsFundFlow>0&&(f.fundsFlowY2=n.imageHeight-o,f.fundsFlowY1=f.fundsFlowY2-n.fundsFlowAreaHeight,t.font=n.leftFundsFlowFontSize+'px "'+n.leftFundsFlowFontName+'"',u=e.formatNumber(-r.maxAbsFundFlow,1),i=t.measureText(u).width+n.coordsToBox),n.volumeDisplay&&r.maxVolume>0&&(f.fundsFlowY2>0?f.volumeY2=f.fundsFlowY2-n.fundsFlowAreaHeight-n.spaceHeightBetween2Area:f.volumeY2=n.imageHeight-o,f.volumeY1=f.volumeY2-n.volumeAreaHeight,t.font=n.leftVolumeFontSize+'px "'+n.leftVolumeFontName+'"',u=e.formatNumber(r.maxVolume,1),a=t.measureText(u).width+n.coordsToBox,i=Math.max(i,a)),f.volumeY2>0?f.klineY2=f.volumeY2-n.volumeAreaHeight-n.spaceHeightBetween2Area:f.fundsFlowY2>0?f.klineY2=f.fundsFlowY2-n.fundsFlowAreaHeight-n.spaceHeightBetween2Area:f.klineY2=n.imageHeight-o,t.font=n.leftPriceFontSize+'px "'+n.leftPriceFontName+'"',a=t.measureText(e.numberFixTo(r.maxPrice,2)).width+n.coordsToBox,i=Math.max(i,a),f.klineY1=s,i=Math.max(i,n.leftSpaceWidth),f.klineX1=f.volumeX1=f.fundsFlowX1=i,f.klineX2=f.volumeX2=f.fundsFlowX2=n.imageWidth-n.rightSpaceWidth,f}function r(e,t,n,r,i,s,o){e.moveTo(t,n);var u=t,a=n,f=!1,l=s;if(n==i){f=!1,l=s;while(u!=r)f?l=o:l=s,u<r?u=Math.min(u+l,r):u=Math.max(u-l,r),f?e.moveTo(u,a):e.lineTo(u,a),f=!f}if(t==r){f=!1,l=s;while(a!=i)f?l=o:l=s,a<i?a=Math.min(a+l,i):a=Math.max(a-l,i),f?e.moveTo(u,a):e.lineTo(u,a),f=!f}}function i(e,t,n,r,i,s,o,u){e.font=s+'px "'+i+'"',e.patternQuality="best",e.fillStyle=o,e.textAlign=u,e.fillText(t,n,r)}function s(e,t,n){var r,s,o,u,a,f,l;if(!n.KLineDescDisplay)return;e.font=n.KLineDescFontSize+'px "'+n.topStockFontName+'"',n.KLineDescDescAlign=="right"?(u=t.klineX2,o=u-e.measureText("MA30").width,s=o-e.measureText(" MA10 ").width,l=f=a=n.KLineDescDescAlign):n.KLineDescDescAlign=="left"?(s=t.klineX1,o=s+e.measureText("MA5").width,u=o+e.measureText(" MA10 ").width,l=f=a=n.KLineDescDescAlign):(s=t.klineX1,o=(t.klineX2+t.klineX1)/2,u=t.klineX2,l="right",f="center",a="left"),r=n.KlineDescPos=="top"?t.klineY1-n.KLineDescFontSize/4:Math.max(t.klineY2,t.volumeY2,t.fundsFlowY2)+n.KLineDescFontSize,i(e,"MA30",u,r,n.topStockFontName,n.KLineDescFontSize,n.KLineDescMA30FontColor,l),i(e," MA10 ",o,r,n.topStockFontName,n.KLineDescFontSize,n.KLineDescMA10FontColor,f),i(e,"MA5",s,r,n.topStockFontName,n.KLineDescFontSize,n.KLineDescMA5FontColor,a)}function o(t,n,r,o){var u,a,f,l;r.topStockDisplay&&n.stockName&&n.stockCode&&(f=r.topStockPos=="left"?o.klineX1:o.klineX2,u=n.stockName+"["+n.stockCode+"]",i(t,u,f,o.klineY1-r.topStockFontSize/4,r.topStockFontName,r.topStockFontSize,r.topStockFontColor,r.topStockPos)),s(t,o,r),o.volumeX1&&o.volumeY1&&(r.topVolumeTextDisplay&&i(t,r.topVolumeText+e.formatNumber(n.lastVolume,2),o.volumeX1,o.volumeY1-r.leftFundsFlowFontSize/2,r.topVolumeFontName,r.topVolumeFontSize,r.topVolumeFontColor,"left"),i(t,"0",o.volumeX1-r.coordsToBox,o.volumeY2,r.leftVolumeFontName,r.leftVolumeFontSize,r.leftVolumeFontColor,"right"),i(t,e.formatNumber(n.maxVolume,1),o.volumeX1-r.coordsToBox,o.volumeY1,r.leftVolumeFontName,r.leftVolumeFontSize,r.leftVolumeFontColor,"right")),o.fundsFlowX1&&o.fundsFlowY1&&(i(t,r.topFundsFlowText+e.formatNumber(n.lastFundFlow,2),o.fundsFlowX1,o.fundsFlowY1-r.topFundsFlowFontSize/2,r.leftFundsFlowFontName,r.topFundsFlowFontSize,r.leftFundsFlowFontColor,"left"),i(t,"0",o.fundsFlowX1-r.coordsToBox,(o.fundsFlowY1+o.fundsFlowY2)/2,r.leftFundsFlowFontName,r.leftFundsFlowFontSize,r.leftFundsFlowFontColor,"right"),i(t,e.formatNumber(n.maxAbsFundFlow,1),o.fundsFlowX1-r.coordsToBox,o.fundsFlowY1,r.leftFundsFlowFontName,r.leftFundsFlowFontSize,r.leftFundsFlowFontColorUp,"right"),i(t,e.formatNumber(-n.maxAbsFundFlow,1),o.fundsFlowX1-r.coordsToBox,o.fundsFlowY2,r.leftFundsFlowFontName,r.leftFundsFlowFontSize,r.leftFundsFlowFontColorDown,"right")),r.dateTimePos=="bottom"?a=Math.max(o.klineY2,o.volumeY2,o.fundsFlowY2):a=o.klineY2,i(t,r.dateTimeFormatter(n.firstTimeStamp),o.fundsFlowX1,a+r.dateTimeFontSize,r.dateTimeFontName,r.dateTimeFontSize,r.dateTimeFontColor,"left"),i(t,r.dateTimeFormatter(n.lastTimeStamp),o.fundsFlowX2,a+r.dateTimeFontSize,r.dateTimeFontName,r.dateTimeFontSize,r.dateTimeFontColor,"right"),a=o.klineY1,f=o.fundsFlowX1-r.coordsToBox,l=e.numberFixTo(n.maxPrice,2),i(t,l,f,a,r.leftPriceFontName,r.leftPriceFontSize,r.leftPriceFontColor,"right"),a=o.klineY2,l=e.numberFixTo(n.minPrice,2),i(t,l,f,a,r.leftPriceFontName,r.leftPriceFontSize,r.leftPriceFontColor,"right"),a=(o.klineY2+o.klineY1)/2,l=e.numberFixTo((n.maxPrice+n.minPrice)/2,2),i(t,l,f,a,r.leftPriceFontName,r.leftPriceFontSize,r.leftPriceFontColor,"right"),a=o.klineY1+(o.klineY2-o.klineY1)/4,l=e.numberFixTo(n.maxPrice-(n.maxPrice-n.minPrice)/4,2),i(t,l,f,a,r.leftPriceFontName,r.leftPriceFontSize,r.leftPriceFontColor,"right"),a=o.klineY1+(o.klineY2-o.klineY1)*3/4,l=e.numberFixTo(n.maxPrice-(n.maxPrice-n.minPrice)*3/4,2),i(t,l,f,a,r.leftPriceFontName,r.leftPriceFontSize,r.leftPriceFontColor,"right")}function u(e,t,n,i){var s=i.klineY2-i.klineY1,u=i.klineX2-i.klineX1,a=i.volumeY2-i.volumeY1,f=i.volumeX2-i.volumeX1,l=i.fundsFlowY2-i.fundsFlowY1,c=i.fundsFlowX2-i.fundsFlowX1;n.bgColor&&(e.save(),e.fillStyle=n.bgColor,e.fillRect(0,0,n.imageWidth,n.imageHeight),e.restore()),e.linCap="butt",e.beginPath(),e.lineWidth=n.bgOuterLineWidth,e.strokeStyle=n.bgOuterLineColor,e.rect(i.klineX1,i.klineY1,i.klineX2-i.klineX1,i.klineY2-i.klineY1),e.lineWidth=n.bgInnerLineWidth,e.strokeStyle=n.bgInnerLineColor,r(e,i.klineX1,i.klineY1+s/4,i.klineX2,i.klineY1+s/4,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.klineX1,i.klineY1+s/2,i.klineX2,i.klineY1+s/2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.klineX1,i.klineY1+s*3/4,i.klineX2,i.klineY1+s*3/4,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.klineX1+u/4,i.klineY1,i.klineX1+u/4,i.klineY2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.klineX1+u/2,i.klineY1,i.klineX1+u/2,i.klineY2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.klineX1+u*3/4,i.klineY1,i.klineX1+u*3/4,i.klineY2,n.bgInnerLineWidth,n.bgInnerLineWidth),i.volumeX1&&i.volumeY1&&(e.lineWidth=n.bgOuterLineWidth,e.strokeStyle=n.bgOuterLineColor,e.rect(i.volumeX1,i.volumeY1,i.volumeX2-i.volumeX1,i.volumeY2-i.volumeY1),e.lineWidth=n.bgInnerLineWidth,e.strokeStyle=n.bgInnerLineColor,r(e,i.volumeX1+f/4,i.volumeY1,i.volumeX1+f/4,i.volumeY2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.volumeX1+f/2,i.volumeY1,i.volumeX1+f/2,i.volumeY2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.volumeX1+f*3/4,i.volumeY1,i.volumeX1+f*3/4,i.volumeY2,n.bgInnerLineWidth,n.bgInnerLineWidth)),i.fundsFlowX1&&i.fundsFlowY1&&(e.lineWidth=n.bgOuterLineWidth,e.strokeStyle=n.bgOuterLineColor,e.rect(i.fundsFlowX1,i.fundsFlowY1,i.fundsFlowX2-i.fundsFlowX1,i.fundsFlowY2-i.fundsFlowY1),e.lineWidth=n.bgInnerLineWidth,e.strokeStyle=n.bgInnerLineColor,e.moveTo(i.fundsFlowX1,(i.fundsFlowY1+i.fundsFlowY2)/2),e.lineTo(i.fundsFlowX2,(i.fundsFlowY1+i.fundsFlowY2)/2),e.stroke(),r(e,i.fundsFlowX1+c/4,i.fundsFlowY1,i.fundsFlowX1+c/4,i.fundsFlowY2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.fundsFlowX1+c/2,i.fundsFlowY1,i.fundsFlowX1+c/2,i.fundsFlowY2,n.bgInnerLineWidth,n.bgInnerLineWidth),r(e,i.fundsFlowX1+c*3/4,i.fundsFlowY1,i.fundsFlowX1+c*3/4,i.fundsFlowY2,n.bgInnerLineWidth,n.bgInnerLineWidth)),e.stroke(),o(e,t,n,i)}function a(e,t,n,r,i,s){e.fillStyle=s,e.fillRect(t,n,r,i)}function f(e,t,n,r,i,s,o,u,f,l,c,h,p){var d,v,m,g,y,b,w=t;e.beginPath(),d=o-(n.o-s)*(i/r),v=(n.o-n.c)*(i/r),n.c==n.o?(m=c,v=p,g=u+t/2):n.c>n.o?(w=-w,u+=t,g=u-t/2,m=f):(m=l,g=u+t/2),Math.abs(v)<h&&(v=v/Math.abs(v)*p),a(e,u,d,w,v,m),e.strokeStyle=m,e.lineWidth=h,y=o-(n.h-s)*(i/r),e.moveTo(g,y),b=o-(n.l-s)*(i/r),e.lineTo(g,b),e.stroke()}function l(e,t,n,r){var i=r.klineX2-r.klineX1,s=r.klineY2-r.klineY1,o=n.maxPrice-n.minPrice,u=n.kLineUnits?n.kLineUnits.length:0,a=(i-t.spaceWidthBetween2Kline)/Math.max(t.minKLineCount,u),l=a-t.spaceWidthBetween2Kline,c=0,h;for(c=0;c<u;c++)h=r.klineX1+t.spaceWidthBetween2Kline+c*a,f(e,l,n.kLineUnits[c],o,s,n.minPrice,r.klineY2,h,t.kLineColorUp,t.kLineColorDown,t.kLineColor,t.kLineWidth,t.kLineMinHeight)}function c(e,t,n,r){var i=r.volumeX2-r.volumeX1,s=r.volumeY2-r.volumeY1,o=n.volumeList.length,u=(i-t.spaceWidthBetween2Kline)/Math.max(t.minKLineCount,o),f=u-t.spaceWidthBetween2Kline,l=0,c=0,h=t.volumeUpColor,p=0,d=0;for(d=0;d<o;d++)l=r.volumeX1+t.spaceWidthBetween2Kline+d*u,n.kLineUnits[d].o>n.kLineUnits[d].c?h=t.volumeDownColor:h=t.volumeUpColor,p=Math.abs(n.volumeList[d]/n.maxVolume)*s,c=r.volumeY2-p,a(e,l,c,f,p,h)}function h(e,t,n,r){var i=r.fundsFlowX2-r.fundsFlowX1,s=r.fundsFlowY2-r.fundsFlowY1,o=n.fundsFlowList.length,u=(i-t.spaceWidthBetween2Kline)/Math.max(t.minKLineCount,o),f=u-t.spaceWidthBetween2Kline,l=0,c=0,h=t.fundsFlowDownColor,p=0,d=0;for(d=0;d<o;d++)l=r.fundsFlowX1+t.spaceWidthBetween2Kline+d*u,n.fundsFlowList[d]<0?h=t.fundsFlowDownColor:h=t.fundsFlowUpColor,p=n.fundsFlowList[d]/n.maxAbsFundFlow*s/2,c=(r.fundsFlowY2+r.fundsFlowY1)/2-p,p!=0&&a(e,l,c,f,p,h)}function p(e,t,n,r){var i=r.klineX2-r.klineX1,s=r.klineY2-r.klineY1,o=n.maxPrice-n.minPrice,u=n.kLineUnits?n.kLineUnits.length:0,a=(i-t.spaceWidthBetween2Kline)/Math.max(t.minKLineCount,u),f=a-t.spaceWidthBetween2Kline,l=0,c=0,h=0,p=0,d=0,v=0,m=0;e.beginPath(),e.strokeStyle=t.KLineDescMA5FontColor,e.lineWidth=t.avgLineWidht,m=u-n.kLineMa5List.length;for(v=0;v<n.kLineMa5List.length;v++)l=r.klineX1+t.spaceWidthBetween2Kline+(m+v)*a+f/2,c=r.klineY2-(n.kLineMa5List[v]-n.minPrice)/o*s,v==0?e.moveTo(l,c):e.lineTo(l,c);e.stroke(),e.beginPath(),e.strokeStyle=t.KLineDescMA10FontColor,e.lineWidth=t.avgLineWidht,m=u-n.kLineMa10List.length;for(v=0;v<n.kLineMa10List.length;v++)l=r.klineX1+t.spaceWidthBetween2Kline+(m+v)*a+f/2,c=r.klineY2-(n.kLineMa10List[v]-n.minPrice)/o*s,v==0?e.moveTo(l,c):e.lineTo(l,c);e.stroke(),e.beginPath(),e.strokeStyle=t.KLineDescMA30FontColor,e.lineWidth=t.avgLineWidht,m=u-n.kLineMa30List.length;for(v=0;v<n.kLineMa30List.length;v++)l=r.klineX1+t.spaceWidthBetween2Kline+(m+v)*a+f/2,c=r.klineY2-(n.kLineMa30List[v]-n.minPrice)/o*s,v==0?e.moveTo(l,c):e.lineTo(l,c);e.stroke()}function d(e,t){var n={},r;for(r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n}function v(e){var t=e[0],n=1,r=e.length;for(n=1;n<r;n++)t=Math.max(e[n],t);return t}function m(e){var t=e[0],n=1,r=e.length;for(n=1;n<r;n++)t=Math.min(e[n],t);return t}function g(e,t){var n={firstTime:"",lastTime:"",fundsFlowList:[],kLineMa5List:[],kLineMa10List:[],kLineMa30List:[],lastFundFlow:0,maxAbsFundFlow:0,maxVolume:0,lastVolume:0,maxPrice:0,minPrice:0,volumeList:[],volumeMa5List:[],volumeMa10List:[],volumeMa30List:[]},r=0,i=0,s;for(s in e)n[s]=e[s];i=n.kLineUnits?n.kLineUnits.length:0;for(r=0;r<i;r++)r==0?(n.maxPrice=n.kLineUnits[r].h,n.minPrice=n.kLineUnits[r].l):(n.maxPrice=Math.max(n.maxPrice,n.kLineUnits[r].h),n.minPrice=Math.min(n.minPrice,n.kLineUnits[r].l));e.kLineMa5List&&e.kLineMa5List.length>0&&(n.maxPrice=Math.max(n.maxPrice,v(n.kLineMa5List)),n.minPrice=Math.min(n.minPrice,m(n.kLineMa5List))),e.kLineMa10List&&e.kLineMa10List.length>0&&(n.maxPrice=Math.max(n.maxPrice,v(n.kLineMa10List)),n.minPrice=Math.min(n.minPrice,m(n.kLineMa10List))),e.kLineMa30List&&e.kLineMa30List.length>0&&(n.maxPrice=Math.max(n.maxPrice,v(n.kLineMa30List)),n.minPrice=Math.min(n.minPrice,m(n.kLineMa30List))),n.maxPrice=n.maxPrice+(n.maxPrice-n.minPrice)*(t.kLinePriceRatio-1),n.minPrice=Math.max(n.minPrice-(n.maxPrice-n.minPrice)*(t.kLinePriceRatio-1),0);if(t.volumeDisplay&&n.volumeList){for(r=0;r<n.volumeList.length;r++)n.maxVolume=Math.max(n.volumeList[r],n.maxVolume);n.lastVolume=n.volumeList[n.volumeList.length-1]}n.maxVolume=n.maxVolume*t.volumeRatio;if(t.fundsFlowDisplay&&n.fundsFlowList){for(r=0;r<n.fundsFlowList.length;r++)n.maxAbsFundFlow=Math.max(Math.abs(n.fundsFlowList[r]),n.maxAbsFundFlow);n.lastFundFlow=n.fundsFlowList[n.fundsFlowList.length-1]}return n.maxAbsFundFlow*=t.fundsFlowRatio,n}function y(r,i,s){var o=d(t,s),a=g(i,o),f=n(r,o,a);o.dateTimeFormatter===undefined&&(o.dateTimeFormatter=function(t){return e.getDateString(t)}),r.save(),r.clearRect(0,0,o.imageWidth,o.imageHeight),o.scaleRatio!=undefined&&o.scaleRatio!=1&&r.scale(o.scaleRatio,o.scaleRatio),u(r,a,o,f),l(r,o,a,f),o.volumeDisplay&&a.maxVolume>0&&a.volumeList&&c(r,o,a,f),o.fundsFlowDisplay&&a.maxAbsFundFlow>0&&a.fundsFlowList&&h(r,o,a,f),p(r,o,a,f),r.restore()}return y}),define("lib/dataFilter",[],function(){function e(e,t){var n=parseInt(e.substring(0,4),10),r=parseInt(e.substring(4,6),10),i=parseInt(e.substring(6,8),10),s=parseInt(t.substring(0,2),10),o=parseInt(t.substring(2,4),10),u=parseInt(t.substring(4,6),10),a=new Date,f=0;return a.setFullYear(n),a.setMonth(r-1),a.setDate(i),a.setHours(s),a.setMinutes(o),a.setSeconds(u),a.setMilliseconds(0),f=Math.floor(a.getTime()/1e3),f}var t=function(){};return t.calculateMlineData=function(t,n){var r={},i=!1;n==1&&(i=!0),r.volumeList=[],r.priceList=[],r.avgPriceList=[],r.fundsList=[],r.openPrice=0,r.closePrice=0,r.stockName="",r.stockCode="",r.marketType="SH",r.dataTimeStamp=null;var s=t.mUnit.dataValue,o=0,u=s.length,a="",f=[];if(!t.stockInfo.dataValue)return r;t.stockInfo.dataValue&&t.stockInfo.dataValue[3]!="HK"&&u==241&&(o=u-1,f=s[o],s[o][0]!=s[o-1][0]&&(s[o-1][0]=f[0],s[o-1][1]=f[1],s[o-1][2]=f[2],s[o-1][3]=f[3]),f=s.pop(),u--);for(o=0;o<u;o++)r.priceList.push(s[o][1]),t.openPrice>0&&t.stockInfo.dataValue&&t.stockInfo.dataValue[6]!="Y"&&r.avgPriceList.push(s[o][3]/s[o][2]),s[o][4]!=undefined&&r.fundsList.push(s[o][4]),s[o][2]!=undefined&&(o==0?r.volumeList.push(s[o][2]):r.volumeList.push(s[o][2]-s[o-1][2])),o==u-1&&(a=s[o][0]);if(i)for(o=0;o<r.volumeList.length;o++)r.volumeList[o]=r.volumeList[o]/100;return r.openPrice=t.openPrice,r.closePrice=t.closePrice,r.stockName=t.stockInfo.dataValue[2],r.stockCode=t.stockInfo.dataValue[0],r.marketType=t.stockInfo.dataValue[3],r.dataTimeStamp=e(t.date,a),r},t.calculateKlineData=function(t){var n={};n.kLineUnits=[],n.kLineMa5List=[],n.kLineMa10List=[],n.kLineMa30List=[],n.volumeList=[],n.volumeMa5List=[],n.volumeMa10List=[],n.volumeMa30List=[],n.fundsFlowList=[],n.isIndex="N",n.marketType="SH",n.stockName="",n.stockCode="",n.firstTimeStamp=null,n.lastTimeStamp=null,firstTime="",lastTime="";try{var r=0,i=t.kLine.dataValue,s=i?i.length:0;for(r=0;r<s;r++)0==r&&(firstTime=i[r][0]),n.kLineUnits.push({h:i[r][1],o:i[r][2],l:i[r][3],c:i[r][4]}),i[r][7][0]>0&&n.kLineMa5List.push(i[r][7][0]),i[r][7][1]>0&&n.kLineMa10List.push(i[r][7][1]),i[r][7][2]>0&&n.kLineMa30List.push(i[r][7][2]),i[r][5]!=undefined&&n.volumeList.push(i[r][5]),i[r][9]!=undefined&&n.fundsFlowList.push(i[r][9]),s-1==r&&(lastTime=i[r][0]);parseInt(firstTime.substring(0,2))<18?(n.firstTimeStamp=e("0000"+firstTime.substring(0,4),firstTime.substring(4,8)+"00"),n.lastTimeStamp=e("0000"+lastTime.substring(0,4),lastTime.substring(4,8)+"00")):(n.firstTimeStamp=e(firstTime,"000000"),n.lastTimeStamp=e(lastTime,"000000")),t.stockInfo.dataValue&&(t.stockInfo.dataValue[2]&&(n.stockName=t.stockInfo.dataValue[2]),t.stockInfo.dataValue[0]&&(n.stockCode=t.stockInfo.dataValue[0]),t.stockInfo.dataValue[3]&&(n.marketType=t.stockInfo.dataValue[3]),t.stockInfo.dataValue[6]&&(n.isIndex=t.stockInfo.dataValue[6]))}catch(o){}finally{return n}},t}),define("etc/chartSettings/mline_webAppNormal",{imageWidth:600,imageHeight:270,bgLineDisplay:!0,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:1,bgInnerLineIntervalWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:8,topStockDisplay:!1,topQuotationsDisplay:!1,leftCoordsDisplay:!0,leftSpaceWidth:40,leftCoordinateFontName:"Helvetica",leftCoordinateFontSize:16,leftCoordinateFontColor:"#000000",leftCoordinateFontColorUp:"#C90116",leftCoordinateFontColorDown:"#008D00",mlinePriceRatio:1.1,rightSpaceWidth:5,stockFundsFlowDisplay:!1,rightYFontName:"Helvetica",rightYFontSize:16,rightYFontColor:"#000000",rightYFontColorUp:"#C90116",rightYFontColorDown:"#008D00",fundsFlowLineWidth:1,fundsFlowLineColorUp:"#C90116",fundsFlowLineColorDown:"#008D00",fundsStyle:"fill",middleTimeDisplay:!1,middleSpaceHeight:0,volumeAreaDisplay:!1,bottomCoordsDisplay:!0,bottomFontName:"Helvetica",bottomFontSize:16,bottomFontColor:"#000000",bottomSpaceHeight:20,markHighPrice:!1,markLowPrice:!1,mLineStyle:"line",mLineWidth:2,mLineColor:"#44ADE6",avgLineDisplay:!1}),define("etc/chartSettings/mline_webAppBig",{settingsName:"default",imageWidth:600,imageHeight:470,bgLineDisplay:!0,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:2,bgInnerLineIntervalWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:10,topStockDisplay:!1,topStockPos:"left",topStockFontName:"Helvetica,Microsoft YaHei",topStockFontSize:16,topStockFontColor:"#000000",topQuotationsDisplay:!1,topQuotationsFontName:"Helvetica,Microsoft YaHei",topQuotationsFontSize:16,topQuotationsFontColor:"#000000",topQuotationsFontColorUp:"#000000",topQuotationsFontColorDown:"#000000",leftCoordsDisplay:!0,leftSpaceWidth:10,leftCoordinateFontName:"Helvetica,Microsoft YaHei",leftCoordinateFontSize:16,leftCoordinateFontColor:"#000000",leftCoordinateFontColorUp:"#C90116",leftCoordinateFontColorDown:"#008D00",mlinePriceRatio:1.1,rightSpaceWidth:5,stockFundsFlowDisplay:!0,rightYFontName:"Helvetica,Microsoft YaHei",rightYFontSize:16,rightYFontColor:"#000000",rightYFontColorUp:"#C90116",rightYFontColorDown:"#008D00",fundsFlowLineWidth:1,fundsFlowLineColorUp:"#EA5454",fundsFlowLineColorDown:"#5FAB53",fundsStyle:"fill",fundsFillOpacity:.9,middleTimeDisplay:!0,middleSpaceHeight:40,middleTimePos:"right",middleFontName:"Helvetica,Microsoft YaHei",middleFontSize:16,middleFontColor:"#000000",volumeAreaDisplay:!0,volumeAreaHeight:98,volumeLineWidth:2,volumeLineColor:"#D6D6D6",bottomCoordsDisplay:!0,bottomFontName:"Helvetica,Microsoft YaHei",bottomFontSize:16,bottomFontColor:"#000000",bottomSpaceHeight:20,markHighPrice:!0,markLowPrice:!0,mLineStyle:"line",mLineFillColor:"#DDF6FF",mLineWidth:2,mLineColor:"#2869D8",avgLineDisplay:!0,avgLineWidht:2,avgLineColor:"#FEC10A",coordsToBox:5,scaleRatio:1}),define("etc/chartSettings/mline_webAppIndex",{imageWidth:410,imageHeight:180,bgLineDisplay:!0,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:1,bgInnerLineIntervalWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:8,topStockDisplay:!1,topQuotationsDisplay:!1,leftCoordsDisplay:!0,leftSpaceWidth:20,leftCoordinateFontName:"Helvetica",leftCoordinateFontSize:16,leftCoordinateFontColor:"#000000",leftCoordinateFontColorUp:"#C90116",leftCoordinateFontColorDown:"#008D00",mlinePriceRatio:1.1,rightSpaceWidth:5,stockFundsFlowDisplay:!1,rightYFontName:"Helvetica",rightYFontSize:16,rightYFontColor:"#000000",rightYFontColorUp:"#C90116",rightYFontColorDown:"#008D00",fundsFlowLineWidth:1,fundsFlowLineColorUp:"#C90116",fundsFlowLineColorDown:"#008D00",fundsStyle:"fill",middleTimeDisplay:!1,middleSpaceHeight:0,volumeAreaDisplay:!1,bottomCoordsDisplay:!0,bottomFontName:"Helvetica",bottomFontSize:16,bottomFontColor:"#000000",bottomSpaceHeight:20,markHighPrice:!1,markLowPrice:!1,mLineStyle:"line",mLineWidth:2,mLineColor:"#44ADE6",avgLineDisplay:!1}),define("etc/chartSettings/kline_webAppNormal",{imageWidth:600,imageHeight:270,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:10,topStockDisplay:!1,topStockPos:"left",topStockFontName:"Helvetica",topStockFontSize:"14",topStockFontColor:"#000000",KLineDescDisplay:!0,KlineDescPos:"top",KLineDescDescAlign:"right",KLineDescFontName:"Helvetica",KLineDescFontSize:16,KLineDescMA5FontColor:"#666666",KLineDescMA10FontColor:"#2968DA",KLineDescMA30FontColor:"#E548C6",avgLineWidht:2,spaceWidthBetween2Kline:4,kLineColorUp:"#C90116",kLineColorDown:"#008D00",kLineColor:"#A6A6A6",kLineWidth:2,kLinePriceRatio:1.1,leftSpaceWidth:10,leftPriceFontName:"Helvetica",leftPriceFontSize:16,leftPriceFontColor:"#C90116",rightSpaceWidth:5,fundsFlowDisplay:!1,fundsFlowAreaHeight:98,topFundsFlowText:"资金流向 净流: ",topFundsFlowFontName:"Helvetica",topFundsFlowFontSize:20,topFundsFlowFontColor:"#000000",leftFundsFlowFontName:"Helvetica",leftFundsFlowFontSize:16,leftFundsFlowFontColor:"#000000",leftFundsFlowFontColorUp:"#FF0000",leftFundsFlowFontColorDown:"#00FF00",fundsFlowUpColor:"#C90116",fundsFlowDownColor:"#008D00",fundsFlowRatio:1.05,volumeDisplay:!1,volumeAreaHeight:98,topVolumeText:"成 交 量  总手: ",topVolumeFontName:"Helvetica",topVolumeFontSize:20,topVolumeFontColor:"#000000",leftVolumeFontName:"Helvetica",leftVolumeFontSize:16,leftVolumeFontColor:"#000000",volumeUpColor:"#C90116",volumeDownColor:"#008D00",volumeRatio:1.1,dateTimePos:"bottom",dateTimeFontName:"Helvetica",dateTimeFontSize:16,dateTimeFontColor:"#000000",bottomSpaceHeight:20,spaceHeightBetween2Area:40}),define("etc/chartSettings/kline_webAppBig",{imageWidth:600,imageHeight:470,bgOuterLineStyle:"full",bgOuterLineWidth:2,bgOuterLineColor:"#D6D6D6",bgInnerLineStyle:"dashed",bgInnerLineWidth:2,bgInnerLineColor:"#D6D6D6",topSpaceHeight:20,topStockDisplay:!1,topStockPos:"left",topStockFontName:"Helvetica",topStockFontSize:"14",topStockFontColor:"#000000",KLineDescDisplay:!0,KlineDescPos:"top",KLineDescDescAlign:"right",KLineDescFontName:"Helvetica",KLineDescFontSize:16,KLineDescMA5FontColor:"#666666",KLineDescMA10FontColor:"#2968DA",KLineDescMA30FontColor:"#E548C6",avgLineWidht:2,spaceWidthBetween2Kline:4,kLineColorUp:"#C90116",kLineColorDown:"#008D00",kLineColor:"#A6A6A6",kLineWidth:2,kLinePriceRatio:1.1,leftSpaceWidth:10,leftPriceFontName:"Helvetica",leftPriceFontSize:16,leftPriceFontColor:"#C90116",rightSpaceWidth:5,fundsFlowDisplay:!0,fundsFlowAreaHeight:74,topFundsFlowText:"资金流向 净流: ",topFundsFlowFontName:"Helvetica",topFundsFlowFontSize:20,topFundsFlowFontColor:"#000000",leftFundsFlowFontName:"Helvetica",leftFundsFlowFontSize:16,leftFundsFlowFontColor:"#000000",leftFundsFlowFontColorUp:"#C90116",leftFundsFlowFontColorDown:"#008D00",fundsFlowUpColor:"#C90116",fundsFlowDownColor:"#008D00",fundsFlowRatio:1.05,volumeDisplay:!0,volumeAreaHeight:74,topVolumeText:"成 交 量  总手: ",topVolumeFontName:"Helvetica",topVolumeFontSize:20,topVolumeFontColor:"#000000",leftVolumeFontName:"Helvetica",leftVolumeFontSize:16,leftVolumeFontColor:"#000000",volumeUpColor:"#C90116",volumeDownColor:"#008D00",volumeRatio:1.1,dateTimePos:"bottom",dateTimeFontName:"Helvetica",dateTimeFontSize:16,dateTimeFontColor:"#000000",bottomSpaceHeight:20,spaceHeightBetween2Area:40,coordsToBox:5}),define("etc/chartSettings/mline_webAppMini",{imageWidth:216,imageHeight:100,bgLineDisplay:!1,topSpaceHeight:5,topStockDisplay:!1,topQuotationsDisplay:!1,leftSpaceWidth:10,leftCoordsDisplay:!1,mlinePriceRatio:1.1,rightSpaceWidth:5,stockFundsFlowDisplay:!1,volumeAreaDisplay:!1,bottomCoordsDisplay:!1,bottomSpaceHeight:0,markHighPrice:!0,markLowPrice:!0,markRadius:4,mLineStyle:"fill",mLineFillColor:"#DDF6FF",mLineWidth:1,mLineColor:"#3ecafd",avgLineDisplay:!1}),define("lib/chart",["lib/mline","lib/kline","lib/dataFilter","etc/chartSettings/mline_webAppNormal","etc/chartSettings/mline_webAppBig","etc/chartSettings/mline_webAppIndex","etc/chartSettings/kline_webAppNormal","etc/chartSettings/kline_webAppBig","etc/chartSettings/mline_webAppMini"],function(e,t,n,r,i,s,o,u,a){var f=function(f,l,c,h){var p={webAppSmall:r,webAppBig:i,webAppMainPage:s,webAppTrend:a},d={webAppSmall:o,webAppBig:u},v=f.getContext("2d");if(h!==!1)if(l==="webAppTrend"||l==="webAppMainPage"){var m={priceList:c.slice(2),openPrice:c[1],closePrice:c[0],marketType:"SH"};e(v,m,p[l])}else e(v,n.calculateMlineData(c,!0),p[l]||r);else t(v,n.calculateKlineData(c),d[l]||o)};return f}),define("views/HomeView",["jquery","underscore","backbone","Application","views/NewsView","text!templates/defaultSecurityItem.html","collections/SecurityCollection","collections/NewsList","iscroll","text!templates/default.html","tools/autoScale","tools/api","lib/chart"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=new o,d=u(),v,m=n.View.extend({tagName:"img",render:function(){var e=[[.02,"Sunny.png","大涨"],[.015,"Sunny_With_Haze.png","大涨"],[.01,"Sunny_Few_Clouds.png","涨"],[.005,"Cloudy_Partly.png","涨"],[0,"Cloudy_Mostly.png","涨"],[-0.005,"Overcast.png","跌"],[-0.01,"Thunderstorm_Showers.png","跌"],[-0.015,"Sleet.png","大跌"],[-0.02,"Snow_Heavy.png","大跌"],[-0.025,"Freezing_Rain.png","大跌"],[-1,"Ice.png","暴跌"]],t=this.$el,n=0,r=this.model.get("latest")/this.model.get("close")-1;while(r<e[n][0])n++;return t.attr("src","res/images/weather/180/"+e[n][1]),t.attr("alt",e[n][2]),t.attr("title",e[n][2]),this}}),g=n.View.extend({tagName:"span",template:t.template("<%= name %>:<span class=\"<%= change_p > 0 ? 'red' : (change_p == 0 ? 'gray' : 'green') %> fontEnB\"><%= latest.round(0) %> <%= change_p.round(2) %>%</span><%= change_p > 0 ? '<span class=\"icon-arrowup\"></span>' : (change_p == 0 ? '<span class=\"arrowflat\"></span>' : '<span class=\"icon-arrowdown\"></span>') %>"),render:function(){var e=this.model.get("latest")-this.model.get("close");return this.model.set("change_p",e/this.model.get("close")*100),this.model.get("code")==="000001.SH"?this.model.set("name","上证"):this.model.set("name","深证"),this.$el.html(this.template(this.model.toJSON())),this}}),y=n.View.extend({tagName:"li",template:t.template(s),events:{click:"showSecurity"},initialize:function(){this.model.on("change:latest change:close",this.render,this)},showSecurity:function(){if(iScrollMove)return;securityRouter.navigate("security/"+this.model.get("code"),!0)},render:function(){return this.$el.html(this.template(this.model.getFormatted())),this}}),b=n.View.extend({tagName:"div",className:"wui-Page",template:t.template(f),events:function(){var e={"click .addstock":"showSearch","click #canvasHome":"showPrice"};return e[r.isEventStart+" .loadbutton"]="Refresh",e},initialized:!1,initialize:function(){this.loadResource()},loadResource:function(){var e=this;e.initialized=!1,c.loadHomePage("",function(n){v=n,e.state.news=t.pluck(v.focusNews.focus,"id"),e.initialized=!0,e.trigger("initialized")})},showSearch:function(){if(iScrollMove)return;securityRouter.navigate("search",!0)},showPrice:function(){if(iScrollMove)return;securityRouter.navigate("security/000001.SH",!0)},render:function(){return this.$el.html(this.template()),this},Refresh:function(){var e=this;r.manualRefresh="首页刷新完成",e.on("initialized",function(){e.off("initialized"),e.renderIndex(),e.renderNews(),e.canvasPrice(),e.reloadSecurities(e)}),e.loadResource()},canvasPrice:function(){h(this.$$("#canvasHome"),"webAppMainPage",v.SHMarket)},renderIndex:function(){this.$("#homeIndex").empty(),p.reset(v.index),t.each(p.models,function(t,n){if(n===0){var r=new m({model:t});e("#homeWeather").append(r.render().el)}var i=new g({model:t});this.$("#homeIndex").append(i.render().el)},this)},renderNews:function(){var n=this,r=[],s=0;this.rows=0,this.$("#home_list li").empty(),d.reset(v.focusNews.focus),t.each(d.models,function(e){if(s<=2){var t=new i({model:e});this.rows===0?this.$("#home_list li").eq(this.rows++).append(t.render().el):(this.$("#home_list li").eq(this.rows).addClass("f28"),this.$("#home_list li").eq(this.rows).append(t.render().el)),s+=1,r.push(t.model.toJSON().id)}},this),setTimeout(function(){e("#home_list span").each(function(){l(e(this))})},0)},renderSecurities:function(){this.$("#default_list").empty(),t.each(r.mySecurities.models,function(e){var t=new y({model:e});this.$("#default_list").append(t.render().el)},this);var e='<li class="addstock"><div class="add"><span class="plus"></span></div></li>';this.$("#default_list").append(e)},reloadSecurities:function(e){r.mySecurities.reload(function(){e.renderSecurities(),e.myScroll.refresh()})},postRender:function(){var e=this;if(e.initialized!==!0){e.on("initialized",function(){e.postRender()});return}e.off("initialized"),this.renderIndex(),this.renderNews(),this.canvasPrice(),this.renderSecurities(),this.myScroll=new a(this.$$(".scrollview"),{scrollbarClass:"norScroll"})}});return b}),define("tools/tipsPop",[],function(){var e=function(e,t){var n=t*1e3,r=$("#pop_tips").attr("class"),i=function(){$("#pop_tips").html(e),$("#pop_tips").removeClass("pop_quick"),$("#pop_tips").addClass("pop_slow"),$("#pop_tips").addClass("popshow"),opTipsPoproll=setTimeout(function(){$("#pop_tips").removeClass("popshow")},n)};/popshow/.test(r)?(clearTimeout(opTipsPoproll),$("#pop_tips").removeClass("pop_slow"),$("#pop_tips").addClass("pop_quick"),$("#pop_tips").removeClass("popshow"),setTimeout(i,100)):i()};return e}),define("text!templates/SecuritiesItem.html",[],function(){return'	<td class="rown name"><span><%= code %></span><span class="f32"><%= cn %></span></td>\n	<td><%= latest == 0 ? close.round(2) : latest.round(2) %></td>\n	<td><span class="rank"><%= change_p.round(2) %></span><span class="percent">%</span><%= change_p > 0 ? \'<span class="icon-arrowup"></span>\' : (change_p == 0 ? \'<span class="arrowflat"></span>\' : \'<span class="icon-arrowdown"></span>\' ) %>\n  </td>\n	<td class="table_add"><%= selected ? \'\' : \'<p class="add_click"><span class="plus"></span></p>\' %></td>\n<!--股票无图列表-->'}),define("text!templates/mySecuritiesItem.html",[],function(){return'<td class="rown name"><span><%= code %></span><span class="f32"><%= cn %></span></td>\n<td><%= latest == 0 ? close.round(2) : latest.round(2) %></td>\n<td><span class="rank"><%= change_p.round(2) %></span><span class="percent">%</span><%= change_p > 0 ? \'<span class="icon-arrowup"></span>\' : (change_p == 0 ? \'<span class="arrowflat"></span>\' : \'<span class="icon-arrowdown"></span>\' ) %></td>\n<!--自选无图列表-->'}),define("views/SecurityView",["jquery","underscore","backbone","Application","tools/tipsPop","text!templates/SecuritiesItem.html","text!templates/mySecuritiesItem.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({tagName:"tr",template:t.template(s),templateWithoutButton:t.template(o),events:{"click td:not(.table_add)":"showSecurity","click .add_click":"addToMySecurities"},showButton:!0,initialize:function(e){e=e||{},e.showButton!==undefined&&(this.showButton=e.showButton),this.model.on("change:latest",this.render,this)},showSecurity:function(){if(iScrollMove)return;securityRouter.navigate("security/"+this.model.get("code"),!0)},addToMySecurities:function(){if(iScrollMove)return;r.mySecurities.unshift(this.model),this.render()},render:function(){var e=this.model.get("latest")===0?0:this.model.get("latest")-this.model.get("close");this.model.set("change_p",e/this.model.get("close")*100);var t=this.model.toJSON();return t.selected=r.mySecurities.selected(this.model.get("code")),this.el.className=e>0?"red":e==0?"gray":"green",this.showButton?this.$el.html(this.template(t)):this.$el.html(this.templateWithoutButton(t)),this}});return u}),define("text!templates/newsContent.html",[],function(){return'<!--正文-->\n  <header class="detailfunc">\n    <p class="buttonBox buttonL1 icon-back" title="返回"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="返回" /></p>\n    <p class="gotop"><span >&nbsp;</span><span id="loadBox" class="icon-refresh loading"></span></p>\n    <p><span class="icon-font-big" title="增大"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="增大" /></p>\n    <p class="seg"><span class="icon-font-small" title="减小"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="减小" /></p>\n    <p class="page funcmask"><span class="icon-prev-page" title="上篇"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="上篇" /></p>\n    <p class="page funcmask"><span class="icon-next-page" title="下篇"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="下篇" /></p>\n  </header>\n  <article class="content scrollview maintext">\n    <div class="c_scroller">\n    </div>\n  </article>'}),define("text!templates/newsContentMain.html",[],function(){return'      <div class="detailtitle">\n        <h1><%= title %></h1>\n        <p><span><%= source %></span> <time datetime="<%= time %>"><%= fmtime %></time></p>\n      </div>\n      <div class="detailcont">\n        <div id="oContent"><%= content %></div>\n        <div class="detailabout hide" id="detail_about">\n          <div class="subtab subtitle">相关个股</div>\n          <table class="table_stock">\n            <tbody id="list_table">\n            </tbody>\n          </table>\n        </div>\n      </div>'}),define("views/NewsContentView",["jquery","underscore","backbone","Application","views/SecurityView","tools/formatTime","collections/NewsList","collections/SecurityCollection","iscroll","text!templates/newsContent.html","text!templates/newsContentMain.html","tools/api"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=o(),p=o(),d=o(),v=new u,m=n.View.extend({tagName:"div",className:"wui-Page article",template:t.template(f),templateMain:t.template(l),events:function(){var e={"click .detailtitle":"fullScreen","click #oContent":"fullScreen"};return e[r.isEventStart+" .icon-back"]="showBack",e[r.isEventStart+" .icon-font-big"]="bigger",e[r.isEventStart+" .icon-font-small"]="smaller",e[r.isEventStart+" p:not(.funcmask) .icon-prev-page"]="previous",e[r.isEventStart+" p:not(.funcmask) .icon-next-page"]="next",e[r.isEventStart+" .gotop"]="goTop",e},showBack:function(){window.history.back()},changeFontSize:function(e){e!==r.fontSizeUser&&(this.$("#oContent").css("font-size",e+"px"),r.fontSizeUser=e,this.myScroll.refresh(),this.reFontSize())},bigger:function(){this.changeFontSize(Math.min(r.fontSizeUser+2,r.fontSizeMax))},smaller:function(){this.changeFontSize(Math.max(r.fontSizeUser-2,r.fontSizeMin))},previous:function(){this.$el.addClass("prevPage"),securityRouter.navigate("news/"+this.newsList[this.newsNumber-1]+"/",{trigger:!0,replace:!0})},next:function(){this.$el.addClass("nextPage"),securityRouter.navigate("news/"+this.newsList[this.newsNumber+1]+"/",{trigger:!0,replace:!0})},goTop:function(){this.myScroll.scrollTo(0,0)},fullScreen:function(){if(iScrollMove)return;var e=this;document.getElementById("workSpace").classList.toggle("fullScreen"),setTimeout(function(){e.myScroll.refresh()},300)},reFontSize:function(){var t=r.fontSizeUser;t>=r.fontSizeMax?(e(".icon-font-big").parents("p").addClass("funcmask"),e(".icon-font-small").parents("p").removeClass("funcmask")):t<=r.fontSizeMin?(e(".icon-font-small").parents("p").addClass("funcmask"),e(".icon-font-big").parents("p").removeClass("funcmask")):(e(".icon-font-big").parents("p").removeClass("funcmask"),e(".icon-font-small").parents("p").removeClass("funcmask"))},loadSec:function(n){var s=this;n.length!==0&&(e("#list_table").empty(),v.url=r.apiServer+"Securities/"+n,v.fetch({success:function(){t.each(v.models,function(t){var n=new i({model:t});e("#list_table").append(n.render().el)},s),e("#list_table tr").length>0&&e("#detail_about").removeClass("hide"),s.myScroll&&s.myScroll.refresh()}}))},pagePos:function(t){var n=t.indexOf(+this.options.newsid);n>0&&e(".icon-prev-page").parents("p").removeClass("funcmask"),n!==-1&&n<t.length-1&&e(".icon-next-page").parents("p").removeClass("funcmask"),this.newsList=t,this.newsNumber=n},render:function(){var t=this;this.$el.html(this.template(h)),c.loadNewsContent(this.options.newsid,function(e){e.fmtime=s(e.time),t.$(".c_scroller").html(t.templateMain(e)),t.$("#oContent").css("font-size",r.fontSizeUser+"px"),t.loadSec(e.securities),t.pagePos(t.state.news||[t.options.newsid]),t.reFontSize(),t.myScroll&&t.myScroll.refresh()}),this.myScroll=new a(this.$$(".scrollview"),{scrollbarClass:"norScroll",hScroll:!1});if(!r.isIEMobile){var n,i,o=r.isTouchDevice?"touchstart":"mousedown",u=r.isTouchDevice?"touchend":"mouseup";this.$el[0].addEventListener(o,function(e){n=r.isTouchDevice?e.targetTouches[0].pageX:e.pageX,i=r.isTouchDevice?e.targetTouches[0].pageY:e.pageY}),this.$el[0].addEventListener(u,function(s){var o=r.isTouchDevice?s.changedTouches[0].pageX:s.pageX,u=r.isTouchDevice?s.changedTouches[0].pageY:s.pageY,a=o-n,f=u-i,l=e(window).width()/5,c=e(window).width()/8,h=f<c&&f>-c;a>l&&h&&!e(".icon-prev-page").parents("p").hasClass("funcmask")?t.previous():a<-l&&h&&!e(".icon-next-page").parents("p").hasClass("funcmask")&&t.next()})}return this}});return m}),define("views/CommView",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({tagName:"ul",template:t.template("<li><p></p></li><li><%= content %></li>"),render:function(){var e=this.model.get("source"),t={"新浪财经":"sina","腾讯":"qq","和讯网":"hexun","金融界":"jrj","东方财富网":"eastmoney"};return this.$el.html(this.template(this.model.toJSON())),this.$el.find("p").first().attr("class",t[e]).attr("alt",e).attr("title",e),this}});return r}),define("text!templates/securityDetail.html",[],function(){return'  <header><div class="buttonBox buttonL1 icon-back" title="返回"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="返回" /></div><div id="detailHeader" class="title"></div><div id="loadBox" class="buttonBox buttonR1 loadbutton"><span class="icon-refresh" title="刷新"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="刷新" /></div></header>\n  <div class="detailsingle" id="detailSingle"></div>\n  <div id="sec_detail_tab" class="maintab tabmove_d col3 hide">\n        <p id="sec_total">综合</p>\n        <p id="sec_comment">短线快评</p>\n        <p id="sec_news">新闻</p>\n  </div>\n  <article class="content dtabpadd scrollview">\n        <div id="secdetail_scroller" class="c_scroller">\n            <div id="sec_total_box" class="dthpadd hide">\n              <section id="detailBox" class="detailbox">\n                      <table class="table_detail" id="sec_total_c">\n                      </table>\n              </section>\n              <section>\n                      <ul id="kLineTab" class="subtab scol5">\n                    <li class="chart" data-type="today">分时</li>\n                    <li class="chart" data-type="30min">30分K</li>\n                    <li class="chart" data-type="day">日K</li>\n                    <li class="chart" data-type="week">周K</li>\n                    <li class="chart" data-type="month">月K</li>\n                      </ul>\n              <div class="canvasbox" id="canvasBox">\n                <ul>\n                  <li><canvas id="canvasDetail-today" class="canvasdetail" width="600" height="270"></canvas></li>\n                  <li><canvas id="canvasDetail-30min" class="canvasdetail" width="600" height="270"></canvas></li>\n                  <li><canvas id="canvasDetail-day" class="canvasdetail" width="600" height="270"></canvas></li>\n                  <li><canvas id="canvasDetail-week" class="canvasdetail" width="600" height="270"></canvas></li>\n                  <li><canvas id="canvasDetail-month" class="canvasdetail" width="600" height="270"></canvas></li>\n                </ul>\n              </div>\n              </section>\n            </div>\n            <div id="sec_comment_box" class="assess dthpadd hide">\n                    <section id="sec_comment_c">\n                    <!--div class="time_sepa"><time datetime="2012-08-03T05:15">8月10日 星期五</time></div-->\n                    </section>\n            </div>\n            <div id="sec_news_box" class="schpadd list_news hide">\n                    <ul id="sec_news_c">\n                    </ul>\n            </div>\n      </div>\n  </article>\n'}),define("text!templates/securitySingle.html",[],function(){return'<li><%= sec.latest %></li>\n<% if (sec.isStoping) { %>\n<li>未开盘</li>\n<% } else { %>\n<li><%= sec.change_p %><span class="percent">%</span><%= sec.change > 0 ? \'<span class="icon-arrowup"></span>\' : (sec.change == 0 || sec.isStoping ? \'<span class="arrowflat"></span>\' : \'<span class="icon-arrowdown"></span>\' ) %></li>\n<li><%= sec.change %></li>\n<% } %>\n<!--个股顶部数据-->'}),define("text!templates/securityComplex.html",[],function(){return"<tr><td>昨　收：<span><%= close %></span></td><td>今　开：<span class=\"<%= open > close ? 'red' : (open == close || open == '-' ? 'gray' : 'green' ) %>\"><%= open %></span></td></tr>\n<tr><td>最　高：<span class=\"<%= high > close ? 'red' : (high == close || high == '-' ? 'gray' : 'green' ) %>\"><%= high %></span></td><td>最　低：<span class=\"<%= low > close ? 'red' : (low == close || low == '-' ? 'gray' : 'green' ) %>\"><%= low %></span></td></tr>\n<tr><td>成交量：<%= vol %></td><td>成交额：<%= amount %></td></tr>\n<tr class=\"<%= isIndex ? 'hide' : '' %>\"><td>换　手：<span><%= swap %></span></td><td>市　盈：<span><%= earning %></span></td></tr>\n<!--tr><td colspan=\"2\">板　块：<a>暂无数据</a>  <span class=\"red\">non</span></td></tr-->\n<!--成交的span标签在conversion()中，为了保证汉字和数字字体不同-->\n<!--个股综合数据-->"}),define("text!templates/securityHeader.html",[],function(){return'<p class="f20"><%= sec.code %></p><p class="f32"><%= sec.cn %></p><div id="addFav" class="buttonBox buttonR2 <%= selected ? \'removefav\' : \'addfav\' %>"><span class="plus"></span></div>\n<!--个股头部-->'}),define("tools/genLi",[],function(){var e=function(e){var t,n;return function(r){if(t===undefined||n===2||r.focus)t=$("<li></li>"),n=+r.focus,e.append(t);return n++,t}};return e}),define("views/SecurityDetailView",["jquery","underscore","backbone","Application","tools/tipsPop","views/NewsView","views/CommView","collections/SecurityCollection","collections/NewsList","tools/autoScale","iscroll","text!templates/securityDetail.html","text!templates/securitySingle.html","text!templates/securityComplex.html","text!templates/securityHeader.html","tools/api","tools/genLi","lib/chart"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=r.history,b=new u,w=a(),E=a(),S=function(e){var t=new Date(Date.parse(e.replace(/-/g,"/"))),n=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],r=n[t.getDay()],i=e.split("-"),s=i[1]+"月"+i[2]+"日",o=s+" "+r;return o},x=r.apiServer+"Security/",T=function(e,t,n,r){v.loadSecurity(e+"/mline?extra=fund",function(e){setTimeout(function(){g(n,t,e)},r)})},N=function(e,t,n,r,i){v.loadSecurity(e+"/kline/"+t+"?extra=fund",function(e){setTimeout(function(){g(r,n,e,!1)},i)})},C=function(e,t,n,r){var i=document.getElementById("canvasDetail-"+t),r=r||0;t==="today"?T(e,n,i,r):N(e,t,n,i,r)},k=n.View.extend({tagName:"div",className:"detailheader",template:t.template(d),events:function(){var e={};return e[r.isEventStart+" .addfav"]="addToMySecurities",e[r.isEventStart+" .removefav"]="removeToMySecurities",e},addToMySecurities:function(){r.mySecurities.unshift(this.model),this.render()},removeToMySecurities:function(){r.mySecurities.remove(this.model),i(this.model.get("cn")+"删除成功",2),this.render()},render:function(){var e=r.mySecurities.selected(this.model.get("code"));return this.$el.html(this.template({sec:this.model.getFormatted(),selected:e})),this}}),L=n.View.extend({tagName:"ul",template:t.template(h),initialize:function(){this.model.bind("change:latest",this.render(),this)},addToMySecurities:function(){r.mySecurities.unshift(this.model),this.render()},render:function(){var e=r.mySecurities.selected(this.model.get("code")),t=this.model.getFormatted();return this.el.className=t.change>0?"red":t.change==0||t.isStoping?"gray":"green",this.$el.html(this.template({sec:t,selected:e})),this}}),A=n.View.extend({tagName:"tbody",template:t.template(p),render:function(){return this.model.set("selected",r.mySecurities.selected(this.options.securityCode)),this.$el.html(this.template(this.model.getFormatted())),this}}),O=n.View.extend({tagName:"div",className:"wui-Page",template:t.template(c),events:function(){var e={"click #sec_total":"totalC","click #sec_comment":"commentC","click #sec_news":"newsC","click .chart":"showChart","mouseup #canvasBox":"bigPic","touchend #canvasBox":"bigPic"};return e[r.isEventStart+" .icon-back"]="showBack",e[r.isEventStart+" .loadbutton"]="Refresh",e},initialize:function(e){this.tabType=["today","30min","day","week","month"],this.tabNum={today:0,"30min":1,day:2,week:3,month:4},this.isIndex=/^(000\d{3}\.SH|399\d{3}\.SZ)$/.test(e.securityCode),this.isIndex&&this.$el.addClass("securityIndex")},Refresh:function(){var e=!0;this.first=1,this.singleTopC(),this.isIndex&&r.detailTabNum===1&&(r.detailTabNum=0);switch(r.detailTabNum){case 1:this.commentC();break;case 2:this.newsC();break;default:this.totalC(e)}r.manualRefresh=this.secName+"刷新完成"},showBack:function(){window.history.back()},showChart:function(t){if(iScrollMove)return;var n=document.getElementById("sec_total_box"),i=e(t.target).data("type");/current/.test(e(t.target).attr("class"))||(this.cSInitial=!1,r.isIEMobile?this.ieMobileChange(i):this.canvasS.scrollToPage(this.tabNum[i],0,0))},bigPic:function(){if(iScrollMove)return;var t=this,n=document.getElementById("sec_total_box"),i=e(".canvasdetail");n.classList.toggle("only_chart"),n.classList.contains("only_chart")?i.attr("height","470"):i.attr("height","270"),r.isIEMobile?this.ieMobileChange():this.loadCanvas(),setTimeout(function(){t.myScroll.refresh()},200)},singleTopC:function(){var n=this;this.$("#detailSingle").empty(),this.$("#detailHeader").empty(),b.url=this.secUrl,b.fetch({success:function(){t.each(b.models,function(e){var t=new L({model:e}),r=new k({model:e});this.$("#detailSingle").append(t.render().el),this.$("#detailHeader").append(r.render().el),n.secName=t.model.toJSON().cn},n),e("#sec_detail_tab").removeClass("hide")}})},totalC:function(n){if(r.detailTabNum!==0||this.first){var i=this,s;this.first=0,r.detailTabNum=0,e("#sec_total_c").html(""),this.changeTab(),b.url=this.secUrl,b.fetch({success:function(){t.each(b.models,function(t){var n=new A({model:t});e("#sec_total_c").append(n.render().el)},i),n!==!0&&i.reScroll(),i.canvasScroll()}})}},commentC:function(){if(r.detailTabNum!==1||this.first){var n=this,i="",s;this.first=0,r.detailTabNum=1,e("#sec_comment_c").html(""),this.changeTab(),E.url=x+this.options.securityCode+"/KuaiPing",E.fetch({success:function(){t.each(E.models,function(t){var n=new o({model:t}),r=n.model.toJSON().time;if(r!==i){var s=S(r),u='<div class="time_sepa"><time datetime="'+r+'">'+s+"</time></div>";e("#sec_comment_c").append(u),i=r}e("#sec_comment_c").append(n.render().el)},n),n.reScroll()}})}},newsC:function(){if(r.detailTabNum!==2||this.first){var n=this,i;this.first=0,r.detailTabNum=2,e("#sec_news_c").html(""),this.changeTab(),n.isIndex?w.url=r.apiServer+"Market/News":w.url=x+this.options.securityCode+"/News",w.fetch({success:function(){n.state.news=w.pluck("id");var r=m(self.$("#sec_news_c"));t.each(w.models,function(e){var t=new s({model:e});r(e.toJSON()).append(t.render().el)},n),e("#sec_news_c span").each(function(){f(e(this),!0)}),n.reScroll()}})}},ieMobileChange:function(t){var n=document.getElementById("sec_total_box"),i=n.classList.contains("only_chart")?"webAppBig":"webAppSmall",t=t||r.detailPicTabNum,s=this.tabNum[t],o=e("#canvasBox li").eq(s).attr("data-type"),u=this.tabType[s],a=e("#canvasBox li").width(),f=s*a;e("#kLineTab .current").removeClass("current"),e("#kLineTab li").eq(s).addClass("current"),e("#canvasBox ul").css("-webkit-transform","translate(-"+f+"px, 0px)"),u!==undefined&&o!==i&&(r.detailPicTabNum=this.tabType[s],e("#canvasBox li").eq(s).attr("data-type",i),C(this.options.securityCode,u,i),console.log(u))},canvasScroll:function(){if(!this.canvasS&&!r.isIEMobile){var t=this,n=e("#canvasBox li").width(),i=this.tabNum[r.detailPicTabNum],s=i*n;this.cSInitial=!0,this.canvasS=new l(this.$$("#canvasBox"),{x:-s,snap:"li",vScroll:!1,momentum:!1,hScrollbar:!1,onScrollStart:function(){t.cSInitial?this.currPageX=i:""},onScrollEnd:function(){r.detailPicTabNum!==t.tabType[this.currPageX]&&(r.detailPicTabNum=t.tabType[this.currPageX],t.loadCanvas(),t.cSInitial=!1)}})}r.isIEMobile?this.ieMobileChange():this.loadCanvas()},loadCanvas:function(){var t=this,n=document.getElementById("sec_total_box"),i=n.classList.contains("only_chart")?"webAppBig":"webAppSmall",s=r.detailPicTabNum,o=this.tabNum[s],u=[0,1,-1],a;e("#kLineTab .current").removeClass("current"),e("#kLineTab li").eq(o).addClass("current");for(var f=0;f<=2;f++){var l=o+u[f],c=e("#canvasBox li").eq(l).attr("data-type"),h=t.tabType[l];h!==undefined&&c!==i&&(a=f*300,e("#canvasBox li").eq(l).attr("data-type",i),C(t.options.securityCode,h,i,a),console.log(h))}},changeTab:function(){e("#sec_detail_tab > p").removeClass("current"),e("#sec_detail_tab > p").eq(r.detailTabNum).addClass("current"),e("#secdetail_scroller > div").addClass("hide"),e("#secdetail_scroller > div").eq(r.detailTabNum).removeClass("hide")},reScroll:function(){this.myScroll.refresh(),this.myScroll.scrollTo(0,0,0)},render:function(){var t=this;return this.first=1,e("#workSpace").removeClass("fullScreen"),this.$el.html(this.template()),this.$("#sec_news").text(t.isIndex?"市场新闻":"新闻"),this.myScroll=new l(this.$$(".scrollview"),{scrollbarClass:"myScroll"}),this.secUrl=r.apiServer+"securities/"+this.options.securityCode,y.insert(this.options.securityCode),this},postRender:function(){var e=this,t;this.singleTopC(),this.isIndex&&r.detailTabNum===1&&(r.detailTabNum=0);switch(r.detailTabNum){case 1:this.commentC();break;case 2:this.newsC();break;default:this.totalC()}var n=function(t){var n=Date.now(),r=(n-n%864e5)/1e3-28800,i=t.filter(function(e){return e.time>r}).length;if(i!==0){var s='<span class="tab_num">'+i+"</span>";e.$("#sec_news").append(s)}};e.isIndex?v.loadMarket("",function(e){n(e)}):v.loadSecurity(this.options.securityCode+"/News",function(e){n(e)})}});return O}),define("text!templates/searchSecurityItem.html",[],function(){return'<td class="rown name"><span><%= code %></span><span class="f32"><%= cn %></span></td>\n<td><%= latest == 0 ? close.round(2) : latest.round(2) %></td>\n<td><%= change_p.round(2) %><span class="percent">%</span><%= change_p > 0 ? \'<span class="icon-arrowup"></span>\' : (change_p == 0 ? \'<span class="arrowflat"></span>\' : \'<span class="icon-arrowdown"></span>\' ) %></p></td>\n<td class="table_add"><%= selected ? \'\' : \'<p class="add_click"><span class="plus"></span></p>\' %></td>\n<!--搜索股票结果列表-->'}),define("views/SearchSecItemView",["jquery","underscore","backbone","Application","tools/tipsPop","text!templates/searchSecurityItem.html"],function(e,t,n,r,i,s){var o=n.View.extend({tagName:"tr",template:t.template(s),events:{"click td:not(.table_add)":"showSecurity","click .add_click":"addToMySecurities"},initialize:function(){this.model.on("change:latest change:close",this.render,this)},showSecurity:function(){if(iScrollMove)return;securityRouter.navigate("security/"+this.model.get("code"),!0)},addToMySecurities:function(){if(iScrollMove)return;r.mySecurities.unshift(this.model),this.render()},render:function(){var e=this.model.get("latest")===0?0:this.model.get("latest")-this.model.get("close");return this.model.set("change_p",e/this.model.get("close")*100),this.el.className=e>0?"red":e==0?"gray":"green",this.model.set("selected",r.mySecurities.selected(this.model.get("code"))),this.$el.html(this.template(this.model.toJSON())),this}});return o}),define("text!templates/searchNewsItem.html",[],function(){return'<dt><%= fmtitle %></dt>\r\n<dd>\r\n  <p>\r\n    <%= fmsummary %>\r\n  </p>\r\n  <time datetime="<%= time %>">\r\n    <%= fmtime %>\r\n  </time>\r\n</dd>\r\n<!--搜索新闻结果列表-->'}),define("views/SearchNewsItemView",["jquery","underscore","backbone","Application","tools/formatTime","text!templates/searchNewsItem.html"],function(e,t,n,r,i,s){var o=function(e,t){var n=new RegExp(t,"g"),r="<mark>"+t+"</mark>",i=e.replace(n,r);return i},u=n.View.extend({tagName:"dl",template:t.template(s),events:{click:"showContent"},showContent:function(){if(iScrollMove)return;securityRouter.navigate("news/"+this.model.get("id")+"/",!0)},render:function(e){return this.model.set("fmtitle",o(this.model.get("title"),e)),this.model.set("fmsummary",o(this.model.get("summary"),e)),this.model.set("fmtime",i(this.model.get("time"))),this.$el.html(this.template(this.model.toJSON())),this}});return u}),define("text!templates/search.html",[],function(){return'<!--搜索-->\r\n  <header class="search_header"><div class="buttonBox icon-back" title="返回"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="返回" /></div><form id="searchForm"><input type="search" id="searchInput" class="search_input" value="" placeholder="搜索股票/资讯" x-webkit-speech="" lang="zh-CN" x-webkit-grammar="builtin:translate" /><p class="icon-subsearch"><input type="submit" value="搜索" class="search_submit" /><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="搜索" /></p></form><p class="search_close hide"><span class="cross"></span></p></header>\r\n  <article id="sHot" class="content scrollview">\r\n	<div class="schpadd c_scroller">\r\n	<section id="historySection">\r\n	  <div class="subtab subtitle">历史搜索</div>\r\n	  <ul id="search_history" class="search_hot">\r\n	  </ul>\r\n	</section>\r\n	<section>\r\n	  <div class="subtab subtitle">热门搜索</div>\r\n	  <ul id="search_hot" class="search_hot">\r\n	  </ul>\r\n	</section>\r\n	</div>\r\n  </article>\r\n  <article id="search_list" class="content hide">\r\n		<div id="search_tab" class="maintab searchtab col2">\r\n		<p id="search_sec">股票</p>\r\n		<p id="search_news">资讯</p>\r\n		</div>\r\n		<article class="content tabpadd scrollview" id="search_content_wrapper">\r\n		<div class="c_scroller">\r\n		<section id="sresult_sec">\r\n		<div class="schpadd">\r\n		<table class="table_stock">\r\n		<tbody id="search_table">\r\n		</tbody>\r\n		</table>\r\n		</div>\r\n		</section>\r\n		<section id="sresult_news">\r\n		</section>\r\n		</div>\r\n		</article>\r\n	</article>\r\n'}),define("views/SearchView",["jquery","underscore","backbone","Application","collections/SecurityCollection","views/SearchSecItemView","collections/NewsList","views/SearchNewsItemView","iscroll","text!templates/search.html","tools/api"],function(e,t,n,r,i,s,o,u,a,f,l){var c=r.historySearch,h=new i,p=new n.Collection,d=o(),v=function(e){return e.replace(/[;<>\-,\'\"\?]+/g,"")},m=n.View.extend({tagName:"div",className:"wui-Page",template:t.template(f),events:function(){var e={"click #search_sec":"searchSec","click #search_news":"searchNews","click #null_sec":"searchNews","click #null_news":"searchSec","input #searchInput":"inputVal",submit:"doSearch"};return e[r.isEventStart+" .icon-back"]="showBack",e[r.isEventStart+" .search_close"]="delInputVal",e},searchSec:function(){r.searchTabNum!==0&&(e("#search_tab .current").removeClass("current"),e("#search_sec").addClass("current"),e("#search_content_wrapper section").addClass("hide"),e("#sresult_sec").removeClass("hide"),r.searchTabNum=0,this.doSearch())},showBack:function(){/hide/.test(e("#sHot").attr("class"))?this.delInputVal():window.history.back()},searchNews:function(){r.searchTabNum!==1&&(e("#search_tab .current").removeClass("current"),e("#search_news").addClass("current"),e("#search_content_wrapper section").addClass("hide"),e("#sresult_news").removeClass("hide"),r.searchTabNum=1,this.doSearch())},inputVal:function(){this.keyval=e("#searchInput").val(),this.keyval?e(".search_close").removeClass("hide"):this.delInputVal()},delInputVal:function(){e("#searchInput").val(""),e(".search_close").addClass("hide"),e("#search_list").addClass("hide"),this.showHistory(),e("#sHot").removeClass("hide")},showHot:function(){var t=this,n="";e("#loadingDiv").addClass("searchhotloading"),l.loadHotSearch(function(r){e("#search_hot").html(""),e.each(r,function(e,t){n+="<li>"+t+"</li>"}),e("#search_hot").append(n),e("#search_hot li").click(function(){e("#searchInput").val(e(this).html()),e(".search_close").removeClass("hide"),t.doSearch()}),t.myScrollHot&&t.reScroll(t.myScrollHot),e("#loadingDiv").removeClass("searchhotloading")})},showHistory:function(){var t=this,n=localStorage.historysearch.split(","),r="";localStorage.historysearch.length===0?e("#historySection").addClass("hide"):(e("#historySection").removeClass("hide"),e("#search_history").html(""),e.each(n,function(e,t){r+="<li>"+t+"</li>"}),e("#search_history").append(r),e("#search_history li").click(function(){e("#searchInput").val(e(this).html()),e(".search_close").removeClass("hide"),t.doSearch()})),this.myScrollHot&&this.reScroll(this.myScrollHot)},doSearch:function(t){var n=e("#searchInput").val();n=v(n),t&&t.preventDefault(),e("#searchInput").val(n),this.keyval=n,this.keyval!==""&&this.keyval!==undefined&&(c.insert(this.keyval),e("#loadingDiv").addClass("searchloading"),r.searchTabNum===0?this.goSec():this.goNews())},goSec:function(){var n=this,i=r.apiServer+"Securities/",o=[],u=0,a=0;e("#sHot").addClass("hide"),e("#search_list").removeClass("hide"),e("#search_tab > p").eq(r.searchTabNum).addClass("current");if(this.keyval!==this.lastSeckey){var f=this.keyval.toUpperCase();this.lastSeckey=this.keyval;while(u<20&&a<r.securities.length)r.securities[a].toString().search(f.replace(/\s/g,""))>=0&&(o.push(r.securities[a][0]),u++),a++;o.length===0?(e("#search_table").html('<tr><td id="null_sec" class="result_null">没有匹配的股票，<br />去看看有没有匹配的资讯吧。</td></tr>'),e("#loadingDiv").removeClass("searchloading")):(e("#search_table").html(""),h.reset([]),h.add(t.values(t.pick(r.securitiesMap,o))),h.url=i+o.join(","),t.each(h.models,function(t){var n=new s({model:t});e("#search_table").append(n.render().el)},n),n.reScroll(),l.loadSecuritiesWithoutCache(o.join(","),function(n){t.each(n,function(e){var t=h.get(e.code);t.set("close",e.close),t.set("latest",e.latest)}),e("#loadingDiv").removeClass("searchloading")}))}else n.reScroll(),e("#loadingDiv").removeClass("searchloading")},goNews:function(){var n=this,i=r.apiServer+"Search?keyword=",s=[];e("#sHot").addClass("hide"),e("#search_list").removeClass("hide"),e("#search_tab > p").eq(r.searchTabNum).addClass("current"),this.keyval!==this.lastNewskey?(this.lastNewskey=this.keyval,e("#sresult_news").html(""),d.url=i+this.keyval,d.fetch({success:function(){n.state.news=d.pluck("id"),d.models.length===0?e("#sresult_news").html('<dl><dt id="null_news" class="result_null">没有匹配的资讯，<br />去看看有没有匹配的股票吧。</dt></dl>'):(t.each(d.models,function(t){var r=new u({model:t});e("#sresult_news").append(r.render(n.keyval).el),s.push(r.model.toJSON().id)},n),n.reScroll()),e("#loadingDiv").removeClass("searchloading")}})):(n.reScroll(),e("#loadingDiv").removeClass("searchloading"))},reScroll:function(e){var t=this,e=e||this.myScroll;setTimeout(function(){e.refresh(),e.scrollTo(0,0,0)},0)},render:function(){return this.$el.html(this.template()),this},postRender:function(){this.showHot(),this.showHistory();var e=this;this.myScrollHot=new a("sHot",{scrollbarClass:"norScroll"}),this.myScroll=new a("search_content_wrapper",{scrollbarClass:"myScroll"})}});return m}),define("text!templates/newsPicItem.html",[],function(){return'<figure><img src="<%= imgurl %>" /></figure>\n<figcaption><%= title %></figcaption>'}),define("views/NewsPicView",["jquery","underscore","backbone","Application","text!templates/newsPicItem.html"],function(e,t,n,r,i){var s=n.View.extend({tagName:"div",template:t.template(i),events:{click:"showContent"},showContent:function(){if(iScrollMove)return;securityRouter.navigate("news/"+this.model.get("id")+"/",!0)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}});return s}),define("text!templates/newsMore.html",[],function(){return'<!--资讯-->\r\n<header><div class="title">资讯</div><div id="loadBox" class="buttonBox buttonR1 loadbutton"><span class="icon-refresh" title="刷新"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="刷新" /></div></header>\r\n<div class="maintab" id="news_rolling">\r\n<!--span class="toleft hide">&lt;</span-->\r\n  <div id="news_tab_wrapper" class="scrollview">\r\n  <div id="news_more_tab" class="tabbox colscroll">\r\n<% _.each(catalogs, function(catalog) { %>\r\n    <p class="newslist" data-type="<%= catalog.id %>"><%= catalog.cn %></p>\r\n<% }); %>\r\n    <p id="news_my" class="newslist" data-type="mystock">自选股资讯</p>\r\n  </div>\r\n  </div>\r\n<!--span class="toright">&gt;</span-->\r\n</div>  \r\n<article id="news_more_cont" class="content tabpaddP">\r\n<div id="newslist_content_wrapper" class="scrollview">\r\n<div class="c_scroller">\r\n<div class="mystock_add hide">\r\n  <div class="add"><span class="plus"></span></div>\r\n  <p>您的自选股暂无相关资讯，<br />可点击添加更多自选股。</p>\r\n</div>\r\n<section class="news_focus" id="news_pic">\r\n</section>\r\n<section id="news_box" class="news_box">\r\n  <ul id="news_list" class="list_news">\r\n  </ul>\r\n</section>\r\n</div>\r\n</div>\r\n</article>\r\n'}),define("views/NewsListView",["jquery","underscore","backbone","Application","views/NewsView","views/NewsPicView","tools/autoScale","iscroll","text!templates/newsMore.html","tools/api","tools/genLi","tools/tipsPop"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h,p=n.Model.extend({}),d=n.Collection.extend({model:p}),v=n.View.extend({tagName:"div",className:"wui-Page",template:t.template(a),events:function(){var e={"click .newslist:not(.current)":"show","click .add":"showSearch"};return e[r.isEventStart+" .loadbutton"]="reload",e},initialized:!1,initialize:function(){var e=this;h===undefined?f.loadNews("",function(t){h=t,e.initialized=!0,e.trigger("initialized")}):e.initialized=!0},showSearch:function(){if(iScrollMove)return;securityRouter.navigate("search",!0)},show:function(t){if(iScrollMove)return;var n=this.$$(".current");n.classList.remove("current"),n=t.target,n.classList.add("current");var r=e(n).data("type");this.refresh(r),securityRouter.navigate("news/"+r,{trigger:!1,replace:!1}),this.delegateEvents()},focusPic:function(){var e=this;f.loadFocusImageNews(function(t){e.state.news.unshift(t.id),e.$("#news_pic").empty();var r=new s({model:new n.Model(t)});e.$("#news_pic").append(r.render().el),e.myScroll&&e.myScroll.refresh()})},renderNews:function(n,r){var s=this;s.state.news=n.pluck("id"),r==="mystock"&&n.models.length===0&&(s.$("#news_box").addClass("hide"),s.$(".mystock_add").removeClass("hide"));var u=l(s.$("#news_list"));t.each(n.models,function(e,t){var n=new i({model:e});u(e.toJSON()).append(n.render().el)},s),r=="important"?(s.$(".news_focus").css("display","block"),s.$("#news_box").addClass("news_box"),s.focusPic()):(s.$(".news_focus").css("display","none"),s.$("#news_box").removeClass("news_box")),s.$("#news_list span").each(function(){o(e(this),!0)}),setTimeout(function(){s.myScroll&&s.myScroll.refresh(),s.myScroll&&s.myScroll.scrollTo(0,0,0)},1)},reload:function(){var e=this.$(".current").html()||"";r.manualRefresh=e+"刷新完成",this.refresh(this.$(".current").data("type"))},refresh:function(e){var t=this,n;this.$("#news_list").empty(),this.$(".mystock_add").addClass("hide"),this.$("#news_box").removeClass("hide");if(e==="mystock"){var i=r.mySecurities.length>0?"Securities/"+r.mySecurities.pluck("code").join(",")+"/News":"Security/000001.SH/News";n=new d,n.url=r.apiServer+i,n.fetch({success:function(){t.renderNews(n,e)}})}else n=new d(h[e].news),t.renderNews(n,e),r.manualRefresh!==""?c(r.manualRefresh,2):"",r.manualRefresh=""},render:function(){return this},postRender:function(){var e=this;if(e.initialized===!1){e.on("initialized",function(){e.postRender()});return}var n=t.map(t.values(h),function(e){return t.pick(e,"id","cn")});this.$el.html(this.template({catalogs:n})),setTimeout(function(){e.myScroll=new u(e.$$("#news_more_cont .scrollview"),{scrollbarClass:"myScroll"}),e.myScrollx=new u(e.$$("#news_rolling .scrollview"),{snap:"p",vScroll:!1,hideScrollbar:!0,scrollbarClass:"myScroll",bounce:!1}),e.myScrollx.scrollToElement(i.get(0),0),e.myScrollx.refresh(),e.refresh(r)},0);var r=this.options.type||"important",i=this.$('#news_more_tab p[data-type="'+r+'"]');i.addClass("current")}});return v}),define("text!templates/securityPicItem.html",[],function(){return'<td class="newstd"><div class="news"><p class="picnewslink"><span class="disc"></span><span class="newstitle"><%= news.title %></span><time datetime="<%= news.time %>"><%= fmtime %></time></p><p class="piclistadd"><%= selected ? \'\' : \'<span class="table_add add_box"><span class="plus"></span></span>\' %></p></div></td>\n<td class="rown name"><span><%= code %></span><span class="f32"><%= cn %></span><span><%= latest == 0 ? close.round(2) : latest.round(2) %></span></td>\n<td class="rown change"><span><%= change.round(2) %></span><span><%= change_p.round(2) %><span class="percent">%</span><%= change > 0 ? \'<span class="icon-arrowup"></span>\' : (change == 0 ? \'<span class="arrowflat"></span>\' : \'<span class="icon-arrowdown"></span>\' ) %></span></td>\n<td><canvas class="canvaslist" width="216" height="100"></canvas></td>\n<!--股票有图列表-->'}),define("views/SecurityPicView",["jquery","underscore","backbone","Application","tools/formatTime","tools/tipsPop","text!templates/securityPicItem.html","tools/api","lib/chart"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({tagName:"tr",template:t.template(o),events:{"click td:not(.newstd)":"showSecurity","click .picnewslink":"showNews","click .piclistadd":"addToMySecurities"},initialize:function(){var e=this.model.get("latest")-this.model.get("close");this.newid=this.model.toJSON().news.id,this.newid!==0?this.model.set("fmtime",i(this.model.toJSON().news.time)):this.model.set("fmtime",""),this.model.on("change:latest",this.render,this)},showSecurity:function(){if(iScrollMove)return;securityRouter.navigate("security/"+this.model.get("code"),!0)},showNews:function(){if(iScrollMove)return;this.newid!==0&&securityRouter.navigate("news/"+this.model.toJSON().news.id+"/stock/"+this.model.get("code"),!0)},addToMySecurities:function(){if(iScrollMove)return;r.mySecurities.unshift(this.model),this.render()},loadCanvas:function(){var e=this,t=this.model.get("code");u.loadSecurity(t+"/trend",function(t){a(e.$$("canvas"),"webAppTrend",t)})},render:function(){var e=this.model.get("latest")===0?0:this.model.get("latest")-this.model.get("close");this.el.className=e>0?"red":this.model.get("change")==0?"gray":"green",this.model.set("change",e),this.model.set("change_p",e/this.model.get("close")*100);var t=this.model.toJSON();return t.selected=r.mySecurities.selected(this.model.get("code")),this.$el.html(this.template(t)),this.loadCanvas(),this}});return f}),define("text!templates/mySecurities.html",[],function(){return'<!--自选无图-->\r\n<header><div id="switch" class="buttonBox buttonL1 icon-list" title="样式"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="样式" /></div><div class="buttonBox buttonL2 icon-settings" data-target="managemy" title="管理"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="管理" /></div><div class="title">自选</div><div id="addFav" class="buttonBox buttonR2 addfav"><span class="plus"></span></div><div id="loadBox" class="buttonBox buttonR1 loadbutton"><span class="icon-refresh" title="刷新"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="刷新" /></div></header>\r\n  <div id="my_tab" class="maintab col2">\r\n	<p id="my_sec" data-target="MyFavorSecurities">我的自选</p>\r\n	<p id="my_history" data-target="MyHistorySecurities">最近浏览</p>\r\n  </div>\r\n  <article class="content tabpadd scrollview">\r\n	<section class="c_scroller thpadd" id="localnone">\r\n		<div class="mystock_add hide" data-target="MyFavorSecurities">\r\n			<div class="add"><span class="plus"></span></div>\r\n			<p>暂无自选，点击添加。</p>\r\n		</div>\r\n		<div class="mystock_add hide" data-target="MyHistorySecurities">\r\n			<p>暂无浏览记录</p>\r\n		</div>\r\n	  <table class="table_stock hide" id="localtable">\r\n	  <thead>\r\n	  <tr id="my_thead"></tr>\r\n	  </thead>\r\n	  <tbody id="my_table">\r\n	  </tbody>\r\n	  </table>\r\n	</section>\r\n  </article>\r\n'}),define("text!templates/securityList.html",[],function(){return'	<header><div id="switch" class="buttonBox buttonL1 icon-list" title="样式"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="样式" /></div><div class="title">行情</div><div id="loadBox" class="buttonBox buttonR1 loadbutton"><span class="icon-refresh" title="刷新"></span><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="刷新" /></div></header>\r\n	<div id="sec_tab" class="maintab col2">\r\n		<p id="sec_index" data-target="IndexSecurities">指数</p>\r\n		<p id="sec_hs" data-target="TopSecurities">沪深排行</p>\r\n		<!--p id="sec_plate">板块排行</p-->\r\n	</div>\r\n  <article class="content tabpadd scrollview">\r\n	<section class="c_scroller thpadd">\r\n			<table class="table_stock">\r\n				<thead>\r\n					<tr id="sec_thead"></tr>\r\n				</thead>\r\n				<tbody id="list_table">\r\n				</tbody>\r\n			</table>\r\n	</section>\r\n	</article>'}),define("views/SecuritiesView",["jquery","underscore","backbone","Application","collections/SecurityCollection","views/SecurityView","views/SecurityPicView","iscroll","tools/tipsPop","text!templates/mySecurities.html","text!templates/securityList.html"],function(e,t,n,r,i,s,o,u,a,f,l){var c,h=function(e,t){return e/t-1},p=n.View.extend({tagName:"div",className:"wui-Page",template:t.template(f),templateTableHeaderWithoutTrend:'<th><p>代码/名称</p></th><th><p>价格</p></th><th id="rankTitle" title="0"><p>涨跌幅</p></th>',templateTableHeaderWithTrend:'<th colspan="2"><p>代码/名称/价格</p></th><th id="rankTitle" title="0"><p>涨跌幅</p></th><th><p>走势</p></th>',events:function(){var e={"click .ranktitle":"doSort","click .add":"showSearch"};return e[r.isEventStart+" #switch"]="showTrendOrNot",e[r.isEventStart+" .icon-settings,.maintab p:not(.current)"]="goTarget",e[r.isEventStart+" #addFav"]="showSearch",e[r.isEventStart+" .loadbutton"]="RefreshCont",e},needCheck:!0,sortAble:!1,showButton:!0,initialize:function(e){this.securities=new i,c=r.picList?o:s,r.picList&&this.el.classList.add("trend")},goTarget:function(t){securityRouter.navigate(e(t.currentTarget).data("target"),!0)},showTrendOrNot:function(){var t=e("#rankTitle").html(),n=e("#rankTitle").attr("title");r.picList=!r.picList,c=r.picList?o:s,this.el.classList.toggle("trend"),this.$$(".table_stock thead tr").innerHTML=r.picList?this.templateTableHeaderWithTrend:this.templateTableHeaderWithoutTrend,e("#rankTitle").html(t),e("#rankTitle").attr("title",n),this.Refresh()},showSearch:function(){if(iScrollMove)return;securityRouter.navigate("search",!0)},doSort:function(){},RefreshCont:function(){var e=this.$(".current").html()||"";this.Refresh(!0),r.manualRefresh=e+"刷新完成"},Refresh:function(n){this.sortAble&&e("#rankTitle").addClass("ranktitle"),this.$("#rankTitle").attr("colspan",r.picList?1:this.showButton?2:1);var i=this,s=this.getStocksString();this.delegateEvents(),!this.needCheck||s.length>0?(e(".table_stock tbody").empty(),this.reload(function(){t.each(i.securities.models,function(t){var n=new c({model:t,showButton:i.showButton});e(".table_stock tbody").append(n.render().el)},i),e("#localnone > .mystock_add").addClass("hide"),e("#localtable").removeClass("hide"),n!==!0&&i.reScroll()})):(setTimeout(function(){e("#localnone > .mystock_add").addClass("hide"),e("#localnone > .mystock_add[data-target="+e(".maintab > .current").data("target")+"]").removeClass("hide"),e("#localtable").addClass("hide")},1),r.manualRefresh!==""?a(r.manualRefresh,2):"",r.manualRefresh="")},reload:function(e){this.securities.fetch({success:e})},reScroll:function(){var e=this;this.myScroll&&setTimeout(function(){e.myScroll.refresh(),e.myScroll.scrollTo(0,0,0)},0)},render:function(){return this.$el.html(this.template({showTrend:r.picList})),this.$$(".table_stock thead tr").innerHTML=r.picList?this.templateTableHeaderWithTrend:this.templateTableHeaderWithoutTrend,this.myScroll=new u(this.$$(".scrollview"),{scrollbarClass:"myScroll"}),this}}),d=p.extend({className:"wui-Page no_icon",showButton:!1,sortAble:!0,getStocksString:function(){return r.mySecurities.pluck("code").join(",")},postRender:function(){this.securities.reset(r.mySecurities.models),this.originOrder=this.securities.pluck("code"),e("#rankTitle").addClass("ranktitle"),e("#my_sec").addClass("current"),this.Refresh()},reload:function(e){e(),r.manualRefresh!==""?a(r.manualRefresh,2):"",r.manualRefresh=""},doSort:function(){if(iScrollMove)return;var n=this;e("#rankTitle").addClass("ranktitle");var r=e("#rankTitle").attr("title");r==="0"?(e("#rankTitle").html('<p>涨跌幅<span class="rankarr">↓</span></p>').attr("title","1"),this.securities.comparator=function(e){return-h(e.get("latest"),e.get("close"))}):r==="1"?(e("#rankTitle").html('<p>涨跌幅<span class="rankarr">↑</span></p>').attr("title","2"),this.securities.comparator=function(e){return h(e.get("latest"),e.get("close"))}):(e("#rankTitle").html("<p>涨跌幅</p>").attr("title","0"),this.securities.comparator=function(e){return t.indexOf(n.originOrder,e.get("code"))}),this.securities.sort(),this.Refresh()}}),v=p.extend({getStocksString:function(){return localStorage.history.replace(/;/g,",")},postRender:function(){this.securities.url=r.apiServer+"Securities/"+this.getStocksString(),e("#my_history").addClass("current"),e("#my_thead .rankarr").empty(),this.Refresh()}}),m=p.extend({template:t.template(l),needCheck:!1,getStocksString:function(){return"000001.SH,399001.SZ,000010.SH,000016.SH,000300.SH,399006.SZ,399005.SZ"},postRender:function(){this.securities.url=r.apiServer+"Securities/"+this.getStocksString(),e("#sec_index").addClass("current"),e("#rankTitle").removeClass("ranktitle"),e("#rankTitle").html("<p>涨跌幅</p>"),this.Refresh()}}),g=p.extend({template:t.template(l),needCheck:!1,sortAble:!0,getStocksString:function(){return"000001.SH,399001.SZ,000010.SH,000016.SH,000300.SH,399006.SZ,399005.SZ"},postRender:function(){e("#sec_hs").addClass("current"),this.securities.url=r.apiServer+"rank/9?order=1",e("#rankTitle").addClass("ranktitle"),e("#rankTitle").html('<p>涨跌幅<span class="rankarr">↓</span></p>'),this.Refresh()},doSort:function(){if(iScrollMove)return;e("#rankTitle").addClass("ranktitle");var t=e("#rankTitle").attr("title");t==="1"?(e("#rankTitle").html('<p>涨跌幅<span class="rankarr">↓</span></p>').attr("title","0"),this.securities.url=r.apiServer+"rank/9?order=1",this.Refresh()):(e("#rankTitle").html('<p>涨跌幅<span class="rankarr">↑</span></p>').attr("title","1"),this.securities.url=r.apiServer+"rank/9?order=0",this.Refresh())}});return{MyFavorSecuritiesView:d,MyHistorySecuritiesView:v,IndexSecuritiesView:m,TopSecuritiesView:g}}),define("text!templates/manageMySecurities.html",[],function(){return'<!--管理自选-->\r\n	<header><div class="buttonBox buttonL1 icon-back" title="返回"><img src="res/images/webapp/no_img.png" class="no_imgbutton" alt="返回" /></div><div class="title">管理自选</div><div id="addFav" class="buttonBox buttonR1 manageadd addfav"><span class="plus"></span></div></header>\r\n  <article class="content scrollview" id="managemy_content_wrapper">\r\n	<section class="c_scroller">\r\n 		<div class="mystock_add hide" id="manageadd">\r\n			<div class="add"><span class="plus"></span></div>\r\n			<p>暂无自选，点击添加。</p>\r\n		</div>\r\n	<table class="table_manage">\r\n	<tbody id="manage_table">\r\n	</tbody>\r\n	</table>\r\n	</section>\r\n	</article>\r\n'}),define("views/manageMyView",["jquery","underscore","backbone","Application","tools/tipsPop","iscroll","text!templates/manageMySecurities.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({tagName:"tr",template:t.template('<td class="name"><%= cn %></td><td><div class="button_op button_up">置顶</div></td><td><div class="button_op red button_del">删除</div></td>'),events:{"click .button_up":"moveTop","click .button_del":"unFavor","click .name":"showSecurity"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},moveTop:function(){if(iScrollMove)return;this.$el.remove(),this.$el.prependTo("#manage_table"),this.delegateEvents(),r.mySecurities.remove(this.model),r.mySecurities.unshift(this.model,!1),i(this.model.get("cn")+"置顶成功",2)},unFavor:function(){if(iScrollMove)return;this.remove(),r.mySecurities.remove(this.model),i(this.model.get("cn")+"删除成功",2)},showSecurity:function(){if(iScrollMove)return;securityRouter.navigate("security/"+this.model.get("code"),!0)}}),a=n.View.extend({tagName:"div",className:"wui-Page",template:t.template(o),events:function(){var e={"click .add":"showSearch","click .button_del":"unFavor"};return e[r.isEventStart+" .icon-back"]="showBack",e[r.isEventStart+" #addFav"]="showSearch",e},unFavor:function(e){this.myScroll.refresh()},showBack:function(){window.history.back()},showSearch:function(){securityRouter.navigate("search",!0)},render:function(){var e=this;this.$el.html(this.template()),t.each(r.mySecurities.models,function(e){var t=new u({model:e});this.$("#manage_table").append(t.render().el)},this),setTimeout(function(){e.myScroll=new s(e.$$(".scrollview"),{scrollbarClass:"norScroll"})},0)}});return a}),define("text!templates/AbFunc.html",[],function(){return'<!--底部导航-->\r\n<ul class="mainav">\r\n  <li id="ab-Index" data-target=""><p><span class="icon-home"></span>首页</p></li>\r\n  <li id="ab-News" data-target="news"><p><span class="icon-newspaper"></span>资讯</p></li>\r\n  <li id="ab-Mysec" data-target="MyFavorSecurities"><p><span class="icon-user"></span>自选</p></li>\r\n  <li id="ab-Price" data-target="IndexSecurities"><p><span class="icon-stats-up"></span>行情</p></li>\r\n  <li id="ab-Search" data-target="search"><p><span class="icon-search"></span>搜索</p></li>\r\n</ul>'}),define("views/AbFunc",["jquery","underscore","backbone","Application","text!templates/AbFunc.html"],function(e,t,n,r,i){var s=n.View.extend({el:"#abFuncBox",template:t.template(i),initialize:function(){this.render()},events:function(){var e={};return e[r.isEventStart+" li"]="nav",e},nav:function(t){this.activeTab(t.currentTarget),securityRouter.navigate(e(t.currentTarget).data("target"),!0)},activeTab:function(e){typeof e=="string"&&(e=this.$$(e)),this.$$(".current")&&this.$$(".current").classList.remove("current"),e.classList.add("current")},render:function(){return this.$el.html(this.template()),this}});return new s}),define("routers/SecurityRouter",["jquery","underscore","backbone","views/HomeView","views/NewsContentView","views/SecurityDetailView","views/SearchView","views/NewsListView","views/SecuritiesView","views/manageMyView","views/AbFunc"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.Router.extend({routes:{news:"newsMore","news/:channel":"newsMore","news/:id/*other":"newsContent",MyFavorSecurities:"MyFavorSecurities",MyHistorySecurities:"MyHistorySecurities",managemy:"manageMy",IndexSecurities:"IndexSecurities",TopSecurities:"TopSecurities","security/:code":"security",search:"search","*other":"defaultRoute"},initialize:function(e){this.appView=e.appView},newsMore:function(e){var t=new u({type:e});this.appView.showView(t),l.activeTab("#ab-News")},newsContent:function(e){var t=new i({newsid:e});this.appView.showView(t)},security:function(e){var t=new s({securityCode:e});this.appView.showView(t),l.activeTab("#ab-Price")},MyFavorSecurities:function(){var e=new a.MyFavorSecuritiesView;this.appView.showView(e),l.activeTab("#ab-Mysec")},MyHistorySecurities:function(){var e=new a.MyHistorySecuritiesView;this.appView.showView(e),l.activeTab("#ab-Mysec")},search:function(){var e=new o;this.appView.showView(e),l.activeTab("#ab-Search")},IndexSecurities:function(){var e=new a.IndexSecuritiesView;this.appView.showView(e),l.activeTab("#ab-Price")},TopSecurities:function(){var e=new a.TopSecuritiesView;this.appView.showView(e),l.activeTab("#ab-Price")},manageMy:function(){var e=new f;this.appView.showView(e),l.activeTab("#ab-Mysec")},defaultRoute:function(e){var t=new r;this.appView.showView(t),l.activeTab("#ab-Index")}});return c}),define("tools/webSocket",["Application"],function(e){var t=function(){var t=[],n,r,i=function(){if(navigator.onLine===!1){setTimeout(i,3e3),e.trigger("info","offine, try connect to websocket server later");return}try{n=new WebSocket("ws://api.netgen.com.cn:8081/path"),n.onopen=s}catch(t){e.trigger("error",t),setTimeout(i,3e3)}},s=function(){e.trigger("info","WebSocket Connected!");while(t.length>0&&n.readyState===1)n.send(t.shift());n.onclose=function(){e.trigger("info","WebSocket Closed!"),i()},n.onerror=function(t){e.trigger("error",t)},n.onmessage=function(t){try{var n=JSON.parse(t.data);typeof n.type=="string"&&e.trigger(n.type,n.data)}catch(r){e.trigger("error",t)}}};return i(),{send:function(r){try{n&&n.readyState===1?n.send(r):(t.push(r),e.trigger("info",["sending to websocket server",r]),n&&n.readyState===3&&i())}catch(s){alert(s)}},onmessage:function(e){r=e}}},n=function(){return{send:function(){},onmessage:function(){}}};return window.WebSocket!==undefined?t():n()}),define("collections/MySecurityCollection",["jquery","underscore","backbone","models/Security","Application","tools/api","tools/webSocket","tools/tipsPop"],function(e,t,n,r,i,s,o,u){var a=function(){var e=[];return localStorage.mySecurities&&localStorage.mySecurities.length>=9?localStorage.mySecurities.split(","):(localStorage.stocks?(localStorage.stocks.length>=9&&(-1===localStorage.stocks.indexOf(";")?e=localStorage.stocks.split(","):e=localStorage.stocks.split(";").map(function(e){return e.split(",")[0]}).filter(function(e){return e.length>0})),localStorage.removeItem("stocks")):e=["000001.SH","399001.SZ"],localStorage.mySecurities=e.join(","),e)},f=n.Collection.extend({model:r,initialize:function(){var e=this,n=a();console.log(n);var r=n.join(",");n.length>0&&(this.url=i.apiServer+"Securities/"+r,i.securitiesMap?this.add(t.values(t.pick(i.securitiesMap,n))):n.forEach(function(t){e.add({code:t,cn:"-"})}),s.loadSecurities(r,function(t){t.forEach(function(t){var n=e.get(t.code);n!==undefined&&n.set(t)}),o.send(r)})),i.on("security:changed",function(t){var n=e.get(t.code);n!==undefined&&n.set("latest",t.latest)}),e.on("add",function(){var t=e.pluck("code").join(",");localStorage.mySecurities=t,e.url=i.apiServer+"Securities/"+t,o.send(t)}),e.on("remove",function(){var t=e.pluck("code").join(",");localStorage.mySecurities=t,e.url=i.apiServer+"Securities/"+t,o.send(t)})},unshift:function(e,t){20>this.length?(n.Collection.prototype.unshift.call(this,e),t===!1?"":u(e.get("cn")+"已加入自选",2)):u("自选股太多，请删除部分继续添加",2)},selected:function(e){var t=this.get(e);return t!==undefined},reload:function(e){this.length>0?(this.url=i.apiServer+"Securities/"+this.pluck("code").join(","),this.fetch({success:function(){e()}})):e()}});return f}),define("views/AppView",["jquery","underscore","backbone","Application","tools/webSocket","tools/api","collections/MySecurityCollection"],function(e,t,n,r,i,s,o){var u=n.View.extend({el:e("#iStockApp"),initialize:function(){var e=this,t=navigator.userAgent.toLowerCase();this.browser=!/mac/.test(t)&&!/msie/.test(t),window.onresize=function(){e.currentView&&e.currentView.myScroll&&e.currentView.myScroll.refresh(),scrollTo(0,1)},r.mySecurities=new o,setTimeout(scrollTo,0,0,1)},showView:function(t){var n=this,r=e('<div class="wui-float"></div>'),i=e('<div class="wui-insert"></div>'),s=e('<div class="wui-mask"></div>'),o=350,u=e(".wui-Page").not(t.el);this.currentView&&t.pushState(this.currentView.popState());var a=function(){t.render(),t.$el.appendTo(n.$el),t.postRender&&t.postRender(),n.currentView=t},f=function(t,r){e("#iStockApp").css("background","#000"),s.appendTo(n.$el),u.addClass(r),t.appendTo(n.$el),setTimeout(function(){t.addClass("anim")},0),setTimeout(function(){u.remove(),s.remove(),t.remove(),n.currentView.close(),a(),e("#iStockApp").css("background","#fff")},o)},l=function(){u.css("position","absolute"),u.hasClass("nextPage")?(t.$el.addClass("toEnterR"),setTimeout(function(){t.$el.removeClass("toEnterR"),u.addClass("toOutL")},1)):(t.$el.addClass("toEnterL"),setTimeout(function(){t.$el.removeClass("toEnterL"),u.addClass("toOutR")},1)),n.currentView.close(),a(),setTimeout(function(){u.remove()},500)};e(".wui-Page").length?this.browser||!t.options.newsid&&!u.hasClass("article")?(u.remove(),n.currentView.close(),a()):t.options.newsid&&u.hasClass("article")?l():t.options.newsid?f(i,"sink"):f(r,"withdrawal"):a()}});return u}),define("domReady/domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;i&&e.length&&(o=[],u(e))}function f(){i||(i=!0,n&&clearInterval(n),a())}function c(e){return i?e(s):o.push(e),c}var e,t,n,r=typeof window!="undefined"&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),t=document.createElement("div");try{e=window.frameElement===null}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),f()}catch(e){}},30))}document.readyState==="complete"&&f()}return c.version="2.0.1",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),define("domReady",["domReady/domReady"],function(e){return e}),define("views/iosmark",["jquery"],function(e){var t=function(e){this.lasth=0,this.opa=1,this.t1=.5,this.t2=24,this.c_name=e,this.dis_t=2e4,this.mark=this.tag("div")};t.prototype={tag:function(e){return document.createElement(e)},creatDiv:function(){var e=this;a=this.tag("div"),b=this.tag("div"),c=this.tag("span"),d=this.tag("span"),this.mark.id="ios_Mark",this.mark.className="ios_mark_tips",a.className="limg",a.innerHTML='<img src="res/images/webapp/logo114.png" width="114" />',b.className="rtext",b.innerHTML='请先点击<span class="mark_icon">&#x2192;</span>，<br />然后选择<strong>“添加至主屏幕”</strong>',c.className="close",c.innerHTML='<span class="close_button"></span>',d.className="triangle";var t=function(){(function(){e.mark.style.display="none",e.set(e.t2),document.body.removeEventListener("click",t,!1)})()};document.body.addEventListener("click",t,!1),this.mark.appendChild(a),this.mark.appendChild(b),this.mark.appendChild(c),this.mark.appendChild(d),document.body.appendChild(this.mark)},dismark:function(){var e=this;this.opa=this.opa-.1,this.mark.style.opacity=this.opa,this.opa>0?setTimeout(function(){e.dismark()},100):this.mark.style.display="none"},winLoc:function(){var e=window.scrollY+window.innerHeight-(this.mark.offsetHeight+3);this.mark.style.webkitTransform="translate3d(0,"+(e-parseInt(this.lasth))+"px,0)"},winit:function(){var e=this;this.mark.style.top=this.lasth=window.innerHeight+window.scrollY-(this.mark.offsetHeight+3)+"px",window.addEventListener("scroll",function(){e.winLoc()},!1),window.addEventListener("resize",function(){e.winLoc()},!1)},set:function(e){var t=new Date;milliseconds=t.getTime()+e*36e5,window.localStorage.setItem(this.c_name,milliseconds)},check:function(){var e=this,t="",n=window.localStorage.getItem(this.c_name),r=new Date;if(!n||n<r.getTime())this.set(this.t1),this.creatDiv(),this.winit(),setTimeout(function(){e.dismark()},e.dis_t)}};var n=function(e){if(navigator.standalone!==!0&&(/iphone/.test(e)||/ipod/.test(e))&&/safari/.test(e)&&!/mqqbrowser/.test(e)&&!/crios/.test(e)){var n=new t("webappmark");n.check()}};return n}),typeof document!="undefined"&&!("classList"in document.createElement("a"))&&function(e){var t="classList",n="prototype",r=(e.HTMLElement||e.Element)[n],i=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(t in this&&this[t]===e)return t;return-1},u=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(t==="")throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},f=function(e){var t=s.call(e.className),n=t?t.split(/\s+/):[],r=0,i=n.length;for(;r<i;r++)this.push(n[r]);this._updateClassName=function(){e.className=this.toString()}},l=f[n]=[],c=function(){return new f(this)};u[n]=Error[n],l.item=function(e){return this[e]||null},l.contains=function(e){return e+="",a(this,e)!==-1},l.add=function(e){e+="",a(this,e)===-1&&(this.push(e),this._updateClassName())},l.remove=function(e){e+="";var t=a(this,e);t!==-1&&(this.splice(t,1),this._updateClassName())},l.toggle=function(e){e+="",a(this,e)===-1?this.add(e):this.remove(e)},l.toString=function(){return this.join(" ")};if(i.defineProperty){var h={get:c,enumerable:!0,configurable:!0};try{i.defineProperty(r,t,h)}catch(p){p.number===-2146823252&&(h.enumerable=!1,i.defineProperty(r,t,h))}}else i[n].__defineGetter__&&r.__defineGetter__(t,c)}(self),define("shim/classList",function(){}),require(["jquery","underscore","backbone","Application","routers/SecurityRouter","views/AppView","domReady","tools/api","views/iosmark","tools/tipsPop","shim/classList"],function(e,t,n,r,i,s,o,u,a,f){iScrollMove=!1;var l=0,c="0.9.0.120201",h=function(){for(var e=0,t=localStorage.length;e<t;e++){var n=localStorage.key(e);if(/^Cached\./.test(n)&&n!=="Cached.securities")try{var r=JSON.parse(localStorage.getItem(n));Date.now()-r.updated>18e5&&(localStorage.removeItem(n),console.log("remove cache "+n))}catch(i){localStorage.removeItem(n)}}};setTimeout(h,1e4),(typeof localStorage.uuid=="undefined"||localStorage.uuid===null||localStorage.uuid.length!=36)&&e.post(r.apiServer+"uuid",function(t){localStorage.uuid=t,e.ajaxSettings.headers={"X-TF-UUID":localStorage.uuid||"-"}}),e.ajaxSettings.headers={"X-TF-VERSION":c,"X-TF-UUID":localStorage.uuid||"-"},e.ajaxSettings.beforeSend=function(){l++===0&&(r.trigger("ajax:started",l),e("#loadBox").removeClass("loadbutton"),e("#loadBox").addClass("loading")),console.log("ajaxCounter",l)},e.ajaxSettings.complete=function(){--l==0&&(r.trigger("ajax:finished",l),e("#loadBox").removeClass("loading"),e("#loadBox").addClass("loadbutton"),r.manualRefresh!==""?f(r.manualRefresh,2):"",r.manualRefresh=""),console.log("ajaxCounter",l)},o(function(){u.loadSecurities2(function(e){r.securities=t.map(t.values(e),function(e){return[e.code,e.cn]}),r.securitiesMap=e}),n.View.prototype.close=function(){this.myScroll&&(this.myScroll.destroy(),this.myScroll=null),this.unbind(),this.undelegateEvents(),this.remove(),this.onClose&&this.onClose()},n.View.prototype.state={},n.View.prototype.popState=function(){return this.state},n.View.prototype.pushState=function(e){this.state=e},n.View.prototype.$$=function(e){return this.el.querySelector(e)},n.View.prototype.$id=function(e){return document.getElementById(e)},Number.prototype.round=function(e){var t=Math.pow(10,e);return(Math.round(this*t)/t).toFixed(e)},window.securityRouter=new i({appView:new s}),window.onhashchange=function(){r.userData.cover(1,window.location.hash)},document.getElementById("workSpace").ontouchstart=function(){},n.history.start();var o=navigator.userAgent.toLowerCase();a(o);var f=function(){var e,t,n=document.head||document.getElementsByTagName("head")[0]||docElement,r=document.createElement("style"),i=document.implementation||{hasFeature:function(){return!1}};r.type="text/css",n.insertBefore(r,n.firstChild),e=r.sheet||r.styleSheet;var s=i.hasFeature("CSS2","")?function(t){if(!e||!t)return!1;var n=!1;try{e.insertRule(t,0),n=/src/i.test(e.cssRules[0].cssText),e.deleteRule(e.cssRules.length-1)}catch(r){}return n}:function(t){return!e||!t?!1:(e.cssText=t,e.cssText.length!==0&&/src/i.test(e.cssText)&&e.cssText.replace(/\r+|\n+/g,"").indexOf(t.split(" ")[0])===0)};return t=s('@font-face { font-family: "font";src: url(data:,); }'),n.removeChild(r),t}();(!f||/\buc\b/.test(o))&&e("#workSpace").addClass("no_fontface")})}),define("app",function(){});